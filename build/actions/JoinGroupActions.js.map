{"version":3,"sources":["../../src/actions/JoinGroupActions.js"],"names":[],"mappings":";;;;AAIA;;AACA;;AACA;;;;AACA;;;;AACA;;;;;;AAGA,IAAM,kBAAkB,oBAAxB,C;;;;AAEA,SAAS,WAAT,CAAqB,IAArB,EAA2B;AACzB,oCAAS,+BAAY,2BAArB;AACA,aAAW;AAAA,WAAM,kBAAQ,OAAR,UAAuB,KAAK,GAA5B,CAAN;AAAA,GAAX,EAAqD,IAArD;AACD;;AAED,SAAS,UAAT,CAAoB,KAApB,EAA2B;AACzB,oCAAS,+BAAY,yBAArB,EAAgD,EAAE,YAAF,EAAhD;AACD;;kBAEc;AACb,gBADa,4BACI;AAAA,gCACG,yBAAe,QAAf,EADH;;AAAA,QACP,KADO,yBACP,KADO;;AAEf,QAAI,KAAJ,EAAW;AACT,wBAAQ,IAAR,YAAsB,KAAtB;AACD;AACF,GANY;AAOb,kBAPa,4BAOI,KAPJ,EAOW;AACtB,sCAAS,+BAAY,mBAArB,EAA0C,EAAE,YAAF,EAA1C;;AAEA,QAAM,MAAM,kBAAkB,QAAlB,GAA6B,KAAzC;AACA,0BAAY,gBAAZ,CAA6B,GAA7B,EAAkC,IAAlC,CAAuC,WAAvC,EAAoD,UAApD;AACD;AAZY,C","file":"JoinGroupActions.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport { dispatch } from '../dispatcher/ActorAppDispatcher';\nimport { ActionTypes } from '../constants/ActorAppConstants';\nimport ActorClient from '../utils/ActorClient';\nimport history from '../utils/history';\nimport JoinGroupStore from '../stores/JoinGroupStore';\n\n\nconst INVITE_URL_BASE = 'https://quit.email';\n\nfunction joinSuccess(peer) {\n  dispatch(ActionTypes.GROUP_JOIN_VIA_LINK_SUCCESS);\n  setTimeout(() => history.replace(`/im/${peer.key}`), 1000);\n}\n\nfunction joinFailed(error) {\n  dispatch(ActionTypes.GROUP_JOIN_VIA_LINK_ERROR, { error });\n}\n\nexport default {\n  joinAfterLogin() {\n    const { token } = JoinGroupStore.getState();\n    if (token) {\n      history.push(`/join/${token}`);\n    }\n  },\n  joinGroupViaLink(token) {\n    dispatch(ActionTypes.GROUP_JOIN_VIA_LINK, { token });\n\n    const url = INVITE_URL_BASE + '/join/' + token;\n    ActorClient.joinGroupViaLink(url).then(joinSuccess, joinFailed);\n  }\n};\n"]}