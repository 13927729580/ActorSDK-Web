{"version":3,"sources":["../../src/actions/SearchActionCreators.js"],"names":[],"mappings":";;;;AAAA;;;;AACA;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;;;;;AAEA,IAAM,QAAQ,SAAR,KAAQ,CAAC,KAAD,EAAQ,KAAR;AAAA,SAAkB,qBAAW,KAAX,CAAiB,KAAjB,EAAwB,KAAxB,IAAiC,CAAnD;AAAA,CAAd;;IAEM,oB;;;;;iCACJ,K,oBAAQ;AACN,oCAAsB,eAAtB,CAAsC,KAAtC;AACA,sCAAS,+BAAY,YAArB;AACD,G;;iCAED,I,mBAAO;AACL,oCAAsB,eAAtB,CAAsC,IAAtC;AACA,sCAAS,+BAAY,WAArB;AACD,G;;iCAED,K,oBAAQ;AACN,sCAAS,+BAAY,YAArB;AACA,oCAAsB,eAAtB,CAAsC,IAAtC;AACD,G;;iCAED,kB,+BAAmB,K,EAAO;AACxB,2CAA6B,IAA7B;AACA,2CAA6B,QAA7B,CAAsC,KAAtC;AACA,sCAAS,+BAAY,YAArB;AACD,G;;iCAED,W,wBAAY,O,EAAS;AACnB,sCAAS,+BAAY,YAArB;AACA,sBAAQ,IAAR,UAAoB,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,GAA1C;AACD,G;;iCAED,Y,yBAAa,K,EAAO;AAClB,sCAAS,+BAAY,gBAArB,EAAuC,EAAE,YAAF,EAAvC;AACA,SAAK,aAAL,CAAmB,KAAnB;AACD,G;;iCAED,a,0BAAc,K,EAAO;AACnB,QAAM,WAAW,2BAAiB,QAAjB,EAAjB;AACA,QAAM,UAAU,EAAE,UAAU,EAAZ,EAAgB,QAAQ,EAAxB,EAAhB;;AAEA,aAAS,MAAT,CAAgB,UAAC,OAAD,EAAa;AAC3B,aAAO,MAAM,QAAQ,QAAR,CAAiB,KAAvB,EAA8B,KAA9B,KACA,MAAM,QAAQ,QAAR,CAAiB,QAAvB,EAAiC,KAAjC,CADP;AAED,KAHD,EAGG,OAHH,CAGW,UAAC,OAAD,EAAa;AACtB,UAAI,2BAAW,QAAQ,QAAR,CAAiB,IAA5B,CAAJ,EAAuC;AACrC,gBAAQ,QAAR,CAAiB,IAAjB,CAAsB,OAAtB;AACD,OAFD,MAEO,IAAI,4BAAY,QAAQ,QAAR,CAAiB,IAA7B,CAAJ,EAAwC;AAC7C,gBAAQ,MAAR,CAAe,IAAf,CAAoB,OAApB;AACD,OAFM,MAEA;AACL,gBAAQ,KAAR,CAAc,kCAAd,EAAkD,OAAlD;AACD;AACF,KAXD;;AAaA,sCAAS,+BAAY,kBAArB,EAAyC,EAAE,gBAAF,EAAzC;AACD,G;;;;;kBAGY,IAAI,oBAAJ,E","file":"SearchActionCreators.js","sourcesContent":["import fuzzaldrin from 'fuzzaldrin';\nimport { dispatch } from '../dispatcher/ActorAppDispatcher';\nimport history from '../utils/history';\nimport { isPeerUser, isPeerGroup } from '../utils/PeerUtils';\nimport { ActionTypes } from '../constants/ActorAppConstants';\nimport QuickSearchStore from '../stores/QuickSearchStore';\nimport ComposeActionCreators from './ComposeActionCreators';\nimport SearchMessagesActionCreators from './SearchMessagesActionCreators';\n\nconst match = (value, query) => fuzzaldrin.score(value, query) > 0;\n\nclass SearchActionCreators {\n  focus() {\n    ComposeActionCreators.toggleAutoFocus(false);\n    dispatch(ActionTypes.SEARCH_FOCUS);\n  }\n\n  blur() {\n    ComposeActionCreators.toggleAutoFocus(true);\n    dispatch(ActionTypes.SEARCH_BLUR);\n  }\n\n  clear() {\n    dispatch(ActionTypes.SEARCH_CLEAR);\n    ComposeActionCreators.toggleAutoFocus(true);\n  }\n\n  goToMessagesSearch(query) {\n    SearchMessagesActionCreators.open();\n    SearchMessagesActionCreators.setQuery(query);\n    dispatch(ActionTypes.SEARCH_CLEAR);\n  }\n\n  goToContact(contact) {\n    dispatch(ActionTypes.SEARCH_CLEAR);\n    history.push(`/im/${contact.peerInfo.peer.key}`);\n  }\n\n  handleSearch(query) {\n    dispatch(ActionTypes.SEARCH_SET_QUERY, { query });\n    this.updateResults(query);\n  }\n\n  updateResults(query) {\n    const elements = QuickSearchStore.getState();\n    const results = { contacts: [], groups: [] };\n\n    elements.filter((element) => {\n      return match(element.peerInfo.title, query) ||\n             match(element.peerInfo.userName, query);\n    }).forEach((element) => {\n      if (isPeerUser(element.peerInfo.peer)) {\n        results.contacts.push(element);\n      } else if (isPeerGroup(element.peerInfo.peer)) {\n        results.groups.push(element);\n      } else {\n        console.error('Unexpected quick search element:', element);\n      }\n    });\n\n    dispatch(ActionTypes.SEARCH_SET_RESULTS, { results });\n  }\n}\n\nexport default new SearchActionCreators();\n"]}