{"version":3,"sources":["../../src/stores/ArchiveStore.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAIA;;AACA;;;;AACA;;;;IAEM;;;AACJ,WADI,YACJ,CAAY,UAAZ,EAAwB;wCADpB,cACoB;;+DACtB,kBAAM,UAAN,GADsB;;AAGtB,UAAK,SAAL,GAAiB,IAAjB,CAHsB;AAItB,UAAK,OAAL,GAAe,EAAf,CAJsB;AAKtB,UAAK,gBAAL,GAAwB,EAAxB,CALsB;AAMtB,UAAK,YAAL,GAAoB,KAApB,CANsB;AAOtB,UAAK,yBAAL,GAAiC,KAAjC,CAPsB;;GAAxB;;AADI,yBAWJ,+CAAmB;AACjB,WAAO,KAAK,SAAL,CADU;;;AAXf,yBAeJ,qCAAc;AACZ,WAAO,KAAK,YAAL,CADK;;;AAfV,yBAmBJ,+DAA2B;AACzB,WAAO,KAAK,yBAAL,CADkB;;;AAnBvB,yBAuBJ,mCAAa;AACX,WAAO,KAAK,OAAL,CADI;;;AAvBT,yBA2BJ,qDAAsB;AACpB,WAAO,KAAK,gBAAL,CADa;;;AA3BlB,yBAgCJ,qCAAa,QAAQ;AACnB,YAAO,OAAO,IAAP;AACL,WAAK,+BAAY,WAAZ;AACH,aAAK,gBAAL,CAAsB,OAAO,IAAP,CAAY,GAAZ,CAAtB,GAAyC,qCAAkB,UAAlB,CAD3C;AAEE,aAAK,YAAL,GAFF;AAGE,cAHF;AADF,WAKO,+BAAY,mBAAZ;AACH,eAAO,KAAK,gBAAL,CAAsB,OAAO,IAAP,CAAY,GAAZ,CAA7B,CADF;AAEE,aAAK,YAAL,GAFF;AAGE,cAHF;AALF,WASO,+BAAY,iBAAZ;AACH,aAAK,gBAAL,CAAsB,OAAO,IAAP,CAAY,GAAZ,CAAtB,GAAyC,qCAAkB,OAAlB,CAD3C;AAEE,aAAK,YAAL,GAFF;AAGE,cAHF;;AATF,WAcO,+BAAY,YAAZ;AACH,aAAK,SAAL,GAAiB,IAAjB,CADF;AAEE,aAAK,YAAL,GAAoB,KAApB,CAFF;AAGE,aAAK,yBAAL,GAAiC,KAAjC,CAHF;AAIE,aAAK,YAAL,GAJF;AAKE,cALF;;AAdF,WAqBO,+BAAY,oBAAZ;AACH,aAAK,SAAL,GAAiB,KAAjB,CADF;AAEE,aAAK,yBAAL,GAAiC,IAAjC,CAFF;AAGE,aAAK,OAAL,GAAe,OAAO,QAAP,CAHjB;AAIE,aAAK,YAAL,GAJF;AAKE,cALF;;AArBF,WA4BO,+BAAY,iBAAZ;AACH,aAAK,SAAL,GAAiB,IAAjB,CADF;AAEE,aAAK,YAAL,GAFF;AAGE,cAHF;;AA5BF,WAiCO,+BAAY,yBAAZ;AACH,aAAK,SAAL,GAAiB,KAAjB,CADF;AAEE,aAAK,YAAL,GAAoB,OAAO,QAAP,CAAgB,MAAhB,KAA2B,CAA3B,CAFtB;AAGE,aAAK,OAAL,CAAa,IAAb,CAAkB,KAAlB,CAAwB,KAAK,OAAL,EAAc,OAAO,QAAP,CAAtC,CAHF;AAIE,aAAK,YAAL,GAJF;AAKE,cALF;;AAjCF;KADmB;;;SAhCjB;;;;;kBA8ES,IAAI,YAAJ","file":"ArchiveStore.js","sourcesContent":["/*\n * Copyright (C) 2016 Actor LLC. <https://actor.im>\n */\n\nimport { Store } from 'flux/utils';\nimport Dispatcher from '../dispatcher/ActorAppDispatcher';\nimport { ActionTypes, AsyncActionStates } from '../constants/ActorAppConstants';\n\nclass ArchiveStore extends Store {\n  constructor(dispatcher) {\n    super(dispatcher);\n\n    this.isLoading = true;\n    this.dialogs = [];\n    this.archiveChatState = {};\n    this._isAllLoaded = false;\n    this._isInitialLoadingComplete = false;\n  }\n\n  isArchiveLoading() {\n    return this.isLoading;\n  }\n\n  isAllLoaded() {\n    return this._isAllLoaded;\n  }\n\n  isInitialLoadingComplete() {\n    return this._isInitialLoadingComplete;\n  }\n\n  getDialogs() {\n    return this.dialogs;\n  }\n\n  getArchiveChatState() {\n    return this.archiveChatState;\n  }\n\n\n  __onDispatch(action) {\n    switch(action.type) {\n      case ActionTypes.ARCHIVE_ADD:\n        this.archiveChatState[action.peer.key] = AsyncActionStates.PROCESSING;\n        this.__emitChange();\n        break;\n      case ActionTypes.ARCHIVE_ADD_SUCCESS:\n        delete this.archiveChatState[action.peer.key];\n        this.__emitChange();\n        break;\n      case ActionTypes.ARCHIVE_ADD_ERROR:\n        this.archiveChatState[action.peer.key] = AsyncActionStates.FAILURE;\n        this.__emitChange();\n        break;\n\n      case ActionTypes.ARCHIVE_LOAD:\n        this.isLoading = true;\n        this._isAllLoaded = false;\n        this._isInitialLoadingComplete = false;\n        this.__emitChange();\n        break;\n\n      case ActionTypes.ARCHIVE_LOAD_SUCCESS:\n        this.isLoading = false;\n        this._isInitialLoadingComplete = true;\n        this.dialogs = action.response;\n        this.__emitChange();\n        break;\n\n      case ActionTypes.ARCHIVE_LOAD_MORE:\n        this.isLoading = true;\n        this.__emitChange();\n        break;\n\n      case ActionTypes.ARCHIVE_LOAD_MORE_SUCCESS:\n        this.isLoading = false;\n        this._isAllLoaded = action.response.length === 0;\n        this.dialogs.push.apply(this.dialogs, action.response);\n        this.__emitChange();\n        break;\n\n      default:\n    }\n  }\n}\n\nexport default new ArchiveStore(Dispatcher);\n"]}