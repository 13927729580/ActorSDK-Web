{"version":3,"sources":["../../src/utils/confirm.js"],"names":[],"mappings":"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","file":"confirm.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes, createElement } from 'react';\nimport { render, findDOMNode, unmountComponentAtNode } from 'react-dom';\nimport { KeyCodes } from '../constants/ActorAppConstants'\nimport ComposeActionCreators from '../actions/ComposeActionCreators';\n\nclass Confirm extends Component {\n  static propTypes = {\n    message: PropTypes.oneOfType([\n      PropTypes.arrayOf(PropTypes.node),\n      PropTypes.node\n    ]).isRequired,\n    description: PropTypes.string,\n    abortLabel: PropTypes.string,\n    confirmLabel: PropTypes.string\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.promise = new Promise((resolve, reject) => {\n      this.reject = reject;\n      this.resolve = resolve;\n    });\n  }\n\n  componentDidMount() {\n    ComposeActionCreators.toggleAutoFocus(false);\n    findDOMNode(this.refs.confirm).focus();\n    document.addEventListener('keydown', this.onKeyDown, false);\n  }\n\n  componentWillUnmount() {\n    ComposeActionCreators.toggleAutoFocus(true);\n    document.removeEventListener('keydown', this.onKeyDown, false);\n  }\n\n  render() {\n    const { message, description, abortLabel, confirmLabel } = this.props;\n\n    return (\n      <div className=\"modal modal--confirm\">\n        <header className=\"modal__header\">\n          <h4 className=\"modal__header__title\">{message}</h4>\n        </header>\n        {\n          description\n            ? <div className=\"modal__body\">{description}</div>\n            : null\n        }\n        <footer className=\"modal__footer text-right\">\n          <button className=\"button\" onClick={this.reject}>\n            {abortLabel || 'Cancel'}\n          </button>\n          <button className=\"button button--lightblue\" onClick={this.resolve} ref=\"confirm\">\n            {confirmLabel || 'Ok'}\n          </button>\n        </footer>\n      </div>\n    );\n  }\n\n  onKeyDown = (event) => {\n    if (event.keyCode === KeyCodes.ESC) {\n      event.preventDefault();\n      this.reject();\n    }\n  };\n}\n\nexport default function confirm(message, options = {})  {\n  let element = document.createElement('div');\n  element.className = 'modal-backdrop';\n  const wrapper = document.body.appendChild(element);\n  const component = render(createElement(Confirm, {message, ...options}), wrapper);\n\n  function cleanup() {\n    unmountComponentAtNode(wrapper);\n    setTimeout(() => wrapper.remove(), 0);\n  }\n\n  // Unmount component and remove it from DOM\n  component.promise.then(\n    () => cleanup(),\n    () => cleanup()\n  );\n\n  return component.promise;\n}\n"]}