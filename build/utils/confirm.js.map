{"version":3,"sources":["../../src/utils/confirm.js"],"names":[],"mappings":"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","file":"confirm.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes, createElement } from 'react';\nimport { render, findDOMNode, unmountComponentAtNode } from 'react-dom';\nimport { KeyCodes } from '../constants/ActorAppConstants';\nimport ComposeActionCreators from '../actions/ComposeActionCreators';\nimport { IntlProvider, FormattedMessage } from 'react-intl';\nimport { getIntlData } from '../l18n';\nimport SharedContainer from '../utils/SharedContainer';\n\nclass Confirm extends Component {\n  static propTypes = {\n    message: PropTypes.oneOfType([\n      PropTypes.arrayOf(PropTypes.node),\n      PropTypes.node\n    ]).isRequired,\n    description: PropTypes.string,\n    abortLabel: PropTypes.string,\n    confirmLabel: PropTypes.string\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.promise = new Promise((resolve, reject) => {\n      this.reject = reject;\n      this.resolve = resolve;\n    });\n\n    const SharedActor = SharedContainer.get();\n    this.intlData = getIntlData(SharedActor.forceLocale);\n  }\n\n  componentDidMount() {\n    ComposeActionCreators.toggleAutoFocus(false);\n    findDOMNode(this.refs.confirm).focus();\n    document.addEventListener('keydown', this.onKeyDown, false);\n  }\n\n  componentWillUnmount() {\n    ComposeActionCreators.toggleAutoFocus(true);\n    document.removeEventListener('keydown', this.onKeyDown, false);\n  }\n\n  render() {\n    const { message, description, abortLabel, confirmLabel } = this.props;\n\n    return (\n      <IntlProvider {...this.intlData}>\n        <div className=\"modal modal--confirm\">\n          <header className=\"modal__header\">\n            <h4 className=\"modal__header__title\">{message}</h4>\n          </header>\n          {\n            description\n              ? <div className=\"modal__body\">{description}</div>\n              : null\n          }\n          <footer className=\"modal__footer text-right\">\n            <button className=\"button\" onClick={this.reject}>\n              {abortLabel || <FormattedMessage id=\"button.cancel\"/>}\n            </button>\n            <button className=\"button button--lightblue\" onClick={this.resolve} ref=\"confirm\">\n              {confirmLabel ||<FormattedMessage id=\"button.ok\"/>}\n            </button>\n          </footer>\n        </div>\n      </IntlProvider>\n    );\n  }\n\n  onKeyDown = (event) => {\n    if (event.keyCode === KeyCodes.ESC) {\n      event.preventDefault();\n      this.reject();\n    }\n  };\n}\n\nexport default function confirm(message, options = {})  {\n  let element = document.createElement('div');\n  element.className = 'modal-backdrop';\n  const wrapper = document.body.appendChild(element);\n\n  const component = render(createElement(Confirm, {message, ...options}), wrapper);\n\n  function cleanup() {\n    unmountComponentAtNode(wrapper);\n    setTimeout(() => wrapper.remove(), 0);\n  }\n\n  // Unmount component and remove it from DOM\n  component.promise.then(\n    () => cleanup(),\n    () => cleanup()\n  );\n\n  return component.promise;\n}\n"]}