{"version":3,"sources":["../../src/utils/confirm.js"],"names":[],"mappings":"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","file":"confirm.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes, createElement } from 'react';\nimport { render, findDOMNode, unmountComponentAtNode } from 'react-dom';\nimport { KeyCodes } from '../constants/ActorAppConstants';\nimport ComposeActionCreators from '../actions/ComposeActionCreators';\nimport { IntlProvider, FormattedMessage } from 'react-intl';\nimport { getIntlData } from '../l18n';\nimport SharedContainer from '../utils/SharedContainer';\n\nclass Confirm extends Component {\n  static propTypes = {\n    message: PropTypes.oneOfType([\n      PropTypes.arrayOf(PropTypes.node),\n      PropTypes.node\n    ]).isRequired,\n    description: PropTypes.string,\n    abortLabel: PropTypes.string,\n    confirmLabel: PropTypes.string\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.promise = new Promise((resolve, reject) => {\n      this.reject = reject;\n      this.resolve = resolve;\n    });\n\n    const SharedActor = SharedContainer.get();\n    this.intlData = getIntlData(SharedActor.forceLocale);\n  }\n\n  componentDidMount() {\n    ComposeActionCreators.toggleAutoFocus(false);\n    findDOMNode(this.refs.confirm).focus();\n    document.addEventListener('keydown', this.onKeyDown, false);\n  }\n\n  componentWillUnmount() {\n    ComposeActionCreators.toggleAutoFocus(true);\n    document.removeEventListener('keydown', this.onKeyDown, false);\n  }\n\n  render() {\n    const { message, description, abortLabel, confirmLabel } = this.props;\n\n    return (\n      <IntlProvider {...this.intlData}>\n        <div className=\"modal modal--confirm\">\n          <header className=\"modal__header\">\n            <h4 className=\"modal__header__title\">{message}</h4>\n          </header>\n          {\n            description\n              ? <div className=\"modal__body\">{description}</div>\n              : null\n          }\n          <footer className=\"modal__footer text-right\">\n            <button className=\"button\" onClick={this.reject}>\n              {abortLabel || <FormattedMessage id=\"button.cancel\"/>}\n            </button>\n            <button className=\"button button--lightblue\" onClick={this.resolve} ref=\"confirm\">\n              {confirmLabel ||<FormattedMessage id=\"button.ok\"/>}\n            </button>\n          </footer>\n        </div>\n      </IntlProvider>\n    );\n  }\n\n  onKeyDown = (event) => {\n    if (event.keyCode === KeyCodes.ESC) {\n      event.preventDefault();\n      this.reject();\n    }\n  };\n}\n\nexport default function confirm(message, options = {})  {\n  let element = document.createElement('div');\n  element.className = 'modal-backdrop';\n  const wrapper = document.body.appendChild(element);\n\n  const component = render(createElement(Confirm, { message, ...options }), wrapper);\n\n  function cleanup() {\n    unmountComponentAtNode(wrapper);\n    setImmediate(() => wrapper.remove());\n  }\n\n  // Unmount component and remove it from DOM\n  component.promise.then(\n    () => cleanup(),\n    () => cleanup()\n  );\n\n  return component.promise;\n}\n"]}