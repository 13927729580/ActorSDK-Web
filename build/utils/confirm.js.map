{"version":3,"sources":["../../src/utils/confirm.js"],"names":[],"mappings":"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","file":"confirm.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes, createElement } from 'react';\nimport { render, findDOMNode, unmountComponentAtNode } from 'react-dom';\nimport { KeyCodes } from '../constants/ActorAppConstants';\nimport ComposeActionCreators from '../actions/ComposeActionCreators';\nimport { IntlProvider, FormattedMessage } from 'react-intl';\nimport { getIntlData } from '../l18n';\nimport SharedContainer from '../utils/SharedContainer';\n\nclass Confirm extends Component {\n  static propTypes = {\n    message: PropTypes.node.isRequired,\n    description: PropTypes.string,\n    abortLabel: PropTypes.string,\n    confirmLabel: PropTypes.string\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.promise = new Promise((resolve, reject) => {\n      this.reject = reject;\n      this.resolve = resolve;\n    });\n\n    const SharedActor = SharedContainer.get();\n    this.intlData = getIntlData(SharedActor.forceLocale);\n  }\n\n  componentDidMount() {\n    ComposeActionCreators.toggleAutoFocus(false);\n    findDOMNode(this.refs.confirm).focus();\n    document.addEventListener('keydown', this.onKeyDown, false);\n  }\n\n  componentWillUnmount() {\n    ComposeActionCreators.toggleAutoFocus(true);\n    document.removeEventListener('keydown', this.onKeyDown, false);\n  }\n\n  renderDescription() {\n    const { description } = this.props;\n    if (!description) return null;\n\n    return (\n      <div className=\"modal__body\">{description}</div>\n    );\n  }\n\n  render() {\n    const { message, abortLabel, confirmLabel } = this.props;\n\n    return (\n      <IntlProvider {...this.intlData}>\n        <div className=\"modal\">\n\n          <div className=\"confirm\">\n            <div className=\"modal__content\">\n\n              <header className=\"modal__header\">\n                <h1>{message}</h1>\n              </header>\n\n              {this.renderDescription()}\n\n              <footer className=\"modal__footer text-right\">\n                <button className=\"button\" onClick={this.reject}>\n                  {abortLabel || <FormattedMessage id=\"button.cancel\"/>}\n                </button>\n                <button className=\"button button--lightblue\" onClick={this.resolve} ref=\"confirm\">\n                  {confirmLabel ||<FormattedMessage id=\"button.ok\"/>}\n                </button>\n              </footer>\n\n            </div>\n          </div>\n\n        </div>\n      </IntlProvider>\n    );\n  }\n\n  onKeyDown = (event) => {\n    if (event.keyCode === KeyCodes.ESC) {\n      event.preventDefault();\n      this.reject();\n    }\n  };\n}\n\nexport default function confirm(message, options = {})  {\n  const element = document.createElement('div');\n  element.className = 'modal-overlay';\n\n\n  const wrapper = document.body.appendChild(element);\n\n  const component = render(createElement(Confirm, { message, ...options }), wrapper);\n\n  function cleanup() {\n    unmountComponentAtNode(wrapper);\n    setImmediate(() => wrapper.remove());\n  }\n\n  // Unmount component and remove it from DOM\n  component.promise.then(\n    () => cleanup(),\n    () => cleanup()\n  );\n\n  return component.promise;\n}\n"]}