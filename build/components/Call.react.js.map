{"version":3,"sources":["../../src/components/Call.react.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAIA;;;;AACA;;;;AACA;;AAEA;;AACA;;;;AAEA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;;;IAEM;;;OACG,iCAAY;AACjB,WAAO,4CAAP,CADiB;;;AADf,OAKG,+CAAkB,MAAM;AAC7B,QAAI,IAAJ,EAAU;AACR,UAAI,KAAK,IAAL,KAAc,6BAAU,IAAV,EAAgB;AAChC,eAAO,oBAAU,OAAV,CAAkB,KAAK,EAAL,CAAzB,CADgC;OAAlC;;AAIA,UAAI,KAAK,IAAL,KAAc,6BAAU,KAAV,EAAiB;AACjC,eAAO,qBAAW,QAAX,CAAoB,KAAK,EAAL,CAA3B,CADiC;OAAnC;KALF;;AAUA,WAAO,IAAP,CAX6B;;;AAL3B,OAmBG,2CAAiB;AACtB,QAAM,OAAO,oBAAU,QAAV,EAAP,CADgB;AAEtB,QAAM,aAAa,sBAAY,cAAZ,EAAb,CAFgB;;AAItB,WAAO;AACL,gBADK;AAEL,gBAAU,KAAK,iBAAL,CAAuB,KAAK,IAAL,CAAjC;AACA,oBAAc,oBAAU,MAAV,CAAiB,UAAjB,EAA6B,KAAK,IAAL,CAA3C;KAHF,CAJsB;;;AAWxB,WA9BI,IA8BJ,CAAY,KAAZ,EAAmB;wCA9Bf,MA8Be;;+DACjB,sBAAM,KAAN,GADiB;;AAGjB,UAAK,QAAL,GAAgB,MAAK,QAAL,CAAc,IAAd,OAAhB,CAHiB;AAIjB,UAAK,KAAL,GAAa,MAAK,KAAL,CAAW,IAAX,OAAb,CAJiB;AAKjB,UAAK,YAAL,GAAoB,MAAK,YAAL,CAAkB,IAAlB,OAApB,CALiB;AAMjB,UAAK,OAAL,GAAe,MAAK,OAAL,CAAa,IAAb,OAAf,CANiB;AAOjB,UAAK,YAAL,GAAoB,MAAK,YAAL,CAAkB,IAAlB,OAApB,CAPiB;AAQjB,UAAK,SAAL,GAAiB,MAAK,SAAL,CAAe,IAAf,OAAjB,CARiB;AASjB,UAAK,OAAL,GAAe,MAAK,OAAL,CAAa,IAAb,OAAf,CATiB;;GAAnB;;AA9BI,iBA0CJ,uDAAsB,WAAW,WAAW;AAC1C,WAAO,yCAAe,IAAf,EAAqB,SAArB,EAAgC,SAAhC,CAAP,CAD0C;;;AA1CxC,iBA8CJ,+BAAW;AACT,iCAAmB,UAAnB,CAA8B,KAAK,KAAL,CAAW,IAAX,CAAgB,EAAhB,CAA9B,CADS;;;AA9CP,iBAkDJ,yBAAQ;AACN,iCAAmB,OAAnB,CAA2B,KAAK,KAAL,CAAW,IAAX,CAAgB,EAAhB,CAA3B,CADM;;;AAlDJ,iBAsDJ,uCAAe;AACb,iCAAmB,cAAnB,CAAkC,KAAK,KAAL,CAAW,IAAX,CAAgB,EAAhB,CAAlC,CADa;;;AAtDX,iBA0DJ,6BAAU;AACR,iCAAmB,IAAnB,GADQ;;;AA1DN,iBA8DJ,uCAAe;AACb,YAAQ,KAAR,CAAc,cAAd,EADa;;;AA9DX,iBAkEJ,iCAAY;AACV,YAAQ,KAAR,CAAc,WAAd,EADU;;;AAlER,iBAsEJ,6BAAU;AACR,YAAQ,KAAR,CAAc,SAAd,EADQ;;;AAtEN,iBA0EJ,iDAAoB;iBACS,KAAK,KAAL,CADT;QACV,mBADU;QACJ,2BADI;;AAElB,QAAI,CAAC,QAAD,IAAa,KAAK,IAAL,CAAU,IAAV,KAAmB,6BAAU,KAAV,EAAiB,OAAO,IAAP,CAArD;;AAEA,WACE;;QAAS,WAAU,YAAV,EAAT;MACE,0DAAgB,UAAU,QAAV,EAAhB,CADF;KADF,CAJkB;;;AA1EhB,iBAqFJ,2BAAS;kBACgC,KAAK,KAAL,CADhC;QACA,oBADA;QACM,4BADN;QACgB,oCADhB;;AAEP,QAAI,CAAC,KAAK,MAAL,EAAa;AAChB,aAAO,2CAAS,WAAU,UAAV,EAAT,CAAP,CADgB;KAAlB;;AAIA,QAAI,CAAC,YAAD,IAAiB,KAAK,UAAL,EAAiB;AACpC,aACE;AACE,kBAAU,QAAV;AACA,mBAAW,KAAK,KAAL;AACX,oBAAY,KAAK,UAAL;AACZ,iBAAS,KAAK,OAAL;AACT,eAAO,KAAK,KAAL;AACP,kBAAU,KAAK,QAAL;AACV,sBAAc,KAAK,YAAL;AACd,sBAAc,KAAK,YAAL;AACd,mBAAW,KAAK,SAAL;AACX,iBAAS,KAAK,OAAL;AACT,iBAAS,KAAK,OAAL;OAXX,CADF,CADoC;KAAtC;;AAkBA,WACE;;QAAS,WAAU,0BAAV,EAAT;MACE;;UAAK,WAAU,qBAAV,EAAL;QACE;;YAAS,WAAU,iBAAV,EAAT;UACE,oDAAU,UAAU,QAAV,EAAoB,WAAW,KAAK,KAAL,EAAzC,CADF;UAEE;AACE,uBAAW,KAAK,KAAL;AACX,wBAAY,KAAK,UAAL;AACZ,qBAAS,KAAK,OAAL;AACT,mBAAO,KAAK,KAAL;AACP,sBAAU,KAAK,QAAL;AACV,0BAAc,KAAK,YAAL;AACd,0BAAc,KAAK,YAAL;AACd,uBAAW,KAAK,SAAL;AACX,qBAAS,KAAK,OAAL;AACT,qBAAS,KAAK,OAAL;WAVX,CAFF;SADF;QAgBG,KAAK,iBAAL,EAhBH;OADF;KADF,CAxBO;;;SArFL;;;kBAsIS,iBAAU,MAAV,CAAiB,IAAjB","file":"Call.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component } from 'react';\nimport shallowCompare from 'react-addons-shallow-compare';\nimport { Container } from 'flux/utils';\n\nimport { PeerTypes } from '../constants/ActorAppConstants';\nimport PeerUtils from '../utils/PeerUtils';\n\nimport CallActionCreators from '../actions/CallActionCreators';\n\nimport CallStore from '../stores/CallStore';\nimport DialogStore from '../stores/DialogStore';\nimport UserStore from '../stores/UserStore';\nimport GroupStore from '../stores/GroupStore';\n\nimport CallDraggable from './call/CallDraggable.react';\nimport CallBody from './call/CallBody.react';\nimport CallControls from './call/CallControls.react';\nimport ContactDetails from './common/ContactDetails.react';\n\nclass Call extends Component {\n  static getStores() {\n    return [CallStore, DialogStore];\n  }\n\n  static calculatePeerInfo(peer) {\n    if (peer) {\n      if (peer.type === PeerTypes.USER) {\n        return UserStore.getUser(peer.id);\n      }\n\n      if (peer.type === PeerTypes.GROUP) {\n        return GroupStore.getGroup(peer.id);\n      }\n    }\n\n    return null;\n  }\n\n  static calculateState() {\n    const call = CallStore.getState();\n    const dialogPeer = DialogStore.getCurrentPeer();\n\n    return {\n      call,\n      peerInfo: Call.calculatePeerInfo(call.peer),\n      isSameDialog: PeerUtils.equals(dialogPeer, call.peer)\n    };\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.onAnswer = this.onAnswer.bind(this);\n    this.onEnd = this.onEnd.bind(this);\n    this.onMuteToggle = this.onMuteToggle.bind(this);\n    this.onClose = this.onClose.bind(this);\n    this.onFullscreen = this.onFullscreen.bind(this);\n    this.onUserAdd = this.onUserAdd.bind(this);\n    this.onVideo = this.onVideo.bind(this);\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    return shallowCompare(this, nextProps, nextState);\n  }\n\n  onAnswer() {\n    CallActionCreators.answerCall(this.state.call.id);\n  }\n\n  onEnd() {\n    CallActionCreators.endCall(this.state.call.id);\n  }\n\n  onMuteToggle() {\n    CallActionCreators.toggleCallMute(this.state.call.id);\n  }\n\n  onClose() {\n    CallActionCreators.hide();\n  }\n\n  onFullscreen() {\n    console.debug('onFullscreen');\n  }\n\n  onUserAdd() {\n    console.debug('onUserAdd');\n  }\n\n  onVideo() {\n    console.debug('onVideo');\n  }\n\n  renderContactInfo() {\n    const { call, peerInfo } = this.state;\n    if (!peerInfo || call.peer.type === PeerTypes.GROUP) return null;\n\n    return (\n      <section className=\"call__info\">\n        <ContactDetails peerInfo={peerInfo}/>\n      </section>\n    )\n  }\n\n  render() {\n    const {call, peerInfo, isSameDialog} = this.state;\n    if (!call.isOpen) {\n      return <section className=\"activity\" />;\n    }\n\n    if (!isSameDialog || call.isFloating) {\n      return (\n        <CallDraggable\n          peerInfo={peerInfo}\n          callState={call.state}\n          isOutgoing={call.isOutgoing}\n          isMuted={call.isMuted}\n          onEnd={this.onEnd}\n          onAnswer={this.onAnswer}\n          onMuteToggle={this.onMuteToggle}\n          onFullscreen={this.onFullscreen}\n          onUserAdd={this.onUserAdd}\n          onVideo={this.onVideo}\n          onClose={this.onClose}\n        />\n      );\n    }\n\n    return (\n      <section className=\"activity activity--shown\">\n        <div className=\"activity__body call\">\n          <section className=\"call__container\">\n            <CallBody peerInfo={peerInfo} callState={call.state}/>\n            <CallControls\n              callState={call.state}\n              isOutgoing={call.isOutgoing}\n              isMuted={call.isMuted}\n              onEnd={this.onEnd}\n              onAnswer={this.onAnswer}\n              onMuteToggle={this.onMuteToggle}\n              onFullscreen={this.onFullscreen}\n              onUserAdd={this.onUserAdd}\n              onVideo={this.onVideo}\n              onClose={this.onClose}\n            />\n          </section>\n          {this.renderContactInfo()}\n        </div>\n      </section>\n    );\n  }\n}\n\nexport default Container.create(Call);\n"]}