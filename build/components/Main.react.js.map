{"version":3,"sources":["../../src/components/Main.react.js"],"names":[],"mappings":";;;;AAGA;;AACA;;;;AACA;;;;AAEA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;;;;;;;;;;;;IAEM,I;;;AASJ,gBAAY,KAAZ,EAAmB;AAAA;;AAAA,iDACjB,sBAAM,KAAN,CADiB;;AAAA,UA+BnB,kBA/BmB,GA+BE,YAAM;AACzB,UAAI,SAAS,MAAb,EAAqB;AACnB,2CAAyB,eAAzB;AACD,OAFD,MAEO;AACL,2CAAyB,gBAAzB;AACD;AACF,KArCkB;;AAGjB,UAAK,UAAL,GAAkB,MAAK,aAAL,EAAlB;AAHiB;AAIlB;;iBAED,a,4BAAgB;AAAA,gCACS,4BAAkB,GAAlB,EADT;;AAAA,QACN,UADM,yBACN,UADM;;;AAGd,QAAI,UAAJ,EAAgB;AACd,aAAO;AACL,iBAAS,wBAAW,WAAW,OAAtB,IAAiC,WAAW,OAA5C,oBADJ;AAEL,iBAAS,wBAAW,WAAW,OAAtB,IAAiC,WAAW,OAA5C;AAFJ,OAAP;AAID;;AAED,WAAO;AACL,gCADK;AAEL;AAFK,KAAP;AAID,G;;iBAED,iB,gCAAoB;AAClB,SAAK,kBAAL;AACA,aAAS,gBAAT,CAA0B,kBAA1B,EAA8C,KAAK,kBAAnD;AACD,G;;iBAED,oB,mCAAuB;AACrB,aAAS,mBAAT,CAA6B,kBAA7B,EAAiD,KAAK,kBAAtD;AACD,G;;iBAUD,U,yBAAa;AAAA,iCACU,4BAAkB,GAAlB,EADV;;AAAA,QACH,QADG,0BACH,QADG;;;AAGX,QAAI,CAAC,SAAS,KAAd,EAAqB;AACnB,aAAO,IAAP;AACD;;AAED,WAAO,wDAAP;AACD,G;;iBAED,M,qBAAS;AAAA,sBACsB,KAAK,UAD3B;AAAA,QACC,OADD,eACC,OADD;AAAA,QACU,OADV,eACU,OADV;;;AAGP,WACE;AAAA;MAAA,EAAK,WAAU,KAAf;MACE,8DADF;MAEE,sDAFF;MAIE,8BAAC,OAAD,OAJF;MAKE;AAAA;QAAA,EAAS,WAAU,SAAnB;QACE,8BAAC,OAAD,OADF;QAEG,KAAK,KAAL,CAAW;AAFd,OALF;MAWE,4DAXF;MAYE,0DAZF;MAcG,KAAK,UAAL;AAdH,KADF;AAkBD,G;;;;;AA/EG,I,CACG,S,GAAY;AACjB,UAAQ,iBAAU,MADD;AAEjB,YAAU,iBAAU,SAAV,CAAoB,CAC5B,iBAAU,OAAV,CAAkB,iBAAU,IAA5B,CAD4B,EAE5B,iBAAU,IAFkB,CAApB;AAFO,C;kBAiFN,I","file":"Main.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\nimport { isFunction } from 'lodash';\nimport React, { Component, PropTypes } from 'react';\nimport DelegateContainer from '../utils/DelegateContainer';\n\nimport VisibilityActionCreators from '../actions/VisibilityActionCreators';\n\nimport DefaultSidebar from './Sidebar.react';\nimport DefaultToolbar from './Toolbar.react';\nimport ConnectionState from './common/ConnectionState.react';\nimport Favicon from './common/Favicon.react';\n\nimport ModalsWrapper from './modals/ModalsWrapper.react';\nimport MenuOverlay from './common/MenuOverlay.react';\nimport SmallCall from './SmallCall.react';\n\nclass Main extends Component {\n  static propTypes = {\n    params: PropTypes.object,\n    children: PropTypes.oneOfType([\n      PropTypes.arrayOf(PropTypes.node),\n      PropTypes.node\n    ])\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.components = this.getComponents();\n  }\n\n  getComponents() {\n    const { components } = DelegateContainer.get();\n\n    if (components) {\n      return {\n        Sidebar: isFunction(components.sidebar) ? components.sidebar : DefaultSidebar,\n        Toolbar: isFunction(components.toolbar) ? components.toolbar : DefaultToolbar\n      };\n    }\n\n    return {\n      Sidebar: DefaultSidebar,\n      Toolbar: DefaultToolbar\n    };\n  }\n\n  componentDidMount() {\n    this.onVisibilityChange();\n    document.addEventListener('visibilitychange', this.onVisibilityChange);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('visibilitychange', this.onVisibilityChange);\n  }\n\n  onVisibilityChange = () => {\n    if (document.hidden) {\n      VisibilityActionCreators.createAppHidden();\n    } else {\n      VisibilityActionCreators.createAppVisible();\n    }\n  };\n\n  renderCall() {\n    const { features } = DelegateContainer.get();\n\n    if (!features.calls) {\n      return null;\n    }\n\n    return <SmallCall />;\n  }\n\n  render() {\n    const { Sidebar, Toolbar } = this.components;\n\n    return (\n      <div className=\"app\">\n        <ConnectionState/>\n        <Favicon/>\n\n        <Toolbar/>\n        <section className=\"wrapper\">\n          <Sidebar/>\n          {this.props.children}\n        </section>\n\n\n        <ModalsWrapper/>\n        <MenuOverlay/>\n\n        {this.renderCall()}\n      </div>\n    );\n  }\n}\n\nexport default Main;\n"]}