{"version":3,"sources":["../../../src/components/modals/EditGroup.react.js"],"names":[],"mappings":"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","file":"EditGroup.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport { Container } from 'flux/utils';\nimport Modal from 'react-modal';\n\nimport { KeyCodes } from '../../constants/ActorAppConstants';\n\nimport EditGroupStore from '../../stores/EditGroupStore';\nimport CropAvatarStore from '../../stores/CropAvatarStore';\n\nimport EditGroupActionCreators from '../../actions/EditGroupActionCreators';\nimport CropAvatarActionCreators from '../../actions/CropAvatarActionCreators';\n\nimport TextField from '../common/TextField.react';\nimport AvatarItem from '../common/AvatarItem.react';\nimport CropAvatarModal from './CropAvatar.react';\n\nclass EditGroup extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  static getStores = () => [EditGroupStore, CropAvatarStore];\n\n  static calculateState() {\n    return {\n      isOpen: EditGroupStore.isOpen(),\n      group: EditGroupStore.getGroup(),\n      isAdmin: EditGroupStore.isAdmin(),\n      title: EditGroupStore.getTitle(),\n      about: EditGroupStore.getAbout(),\n      isCropModalOpen: CropAvatarStore.isOpen()\n    }\n  }\n\n  componentWillUnmount() {\n    this.removeListeners();\n  }\n\n  componentWillUpdate(nextProps, nextState) {\n    if (nextState.isOpen) {\n      nextState.isCropModalOpen ? this.removeListeners() : this.setListeners();\n    } else {\n      nextState.isCropModalOpen ? this.setListeners() : this.removeListeners();\n    }\n  }\n\n  setListeners = () => document.addEventListener('keydown', this.onKeyDown, false);\n  removeListeners = () => document.removeEventListener('keydown', this.onKeyDown, false);\n\n  onClose = () => EditGroupActionCreators.hide();\n  onTitleChange = event => this.setState({title: event.target.value});\n  onAboutChange = event => this.setState({about: event.target.value});\n\n  onKeyDown = event => {\n    if (event.keyCode === KeyCodes.ESC) {\n      event.preventDefault();\n      this.onClose();\n    }\n  };\n\n  onSave = () => {\n    const { group, title, about, isAdmin } = this.state;\n    EditGroupActionCreators.editGroupTitle(group.id, title);\n    if (isAdmin) {\n      EditGroupActionCreators.editGroupAbout(group.id, about);\n    }\n    this.onClose();\n  };\n\n  onProfilePictureInputChange = () => {\n    const imageInput = findDOMNode(this.refs.imageInput);\n    const imageForm = findDOMNode(this.refs.imageForm);\n    const file = imageInput.files[0];\n\n    let reader = new FileReader();\n    reader.onload = (event) => {\n      CropAvatarActionCreators.show(event.target.result);\n      imageForm.reset();\n    };\n    reader.readAsDataURL(file);\n  };\n\n  onChangeAvatarClick = () => {\n    const imageInput = findDOMNode(this.refs.imageInput);\n    imageInput.click()\n  };\n\n  changeGroupAvatar = (croppedImage) => {\n    const { group } = this.state;\n    EditGroupActionCreators.changeGroupAvatar(group.id, croppedImage);\n  };\n\n  onProfilePictureRemove = () =>  {\n    const { group } = this.state;\n    EditGroupActionCreators.removeGroupAvatar(group.id);\n  };\n\n  render() {\n    const { isOpen, group, isCropModalOpen, title, about, isAdmin } = this.state;\n    const { intl } = this.context;\n\n    const cropAvatar = isCropModalOpen ? <CropAvatarModal onCropFinish={this.changeGroupAvatar}/> : null;\n    const modalStyle = {\n      content : {\n        position: null,\n        top: null,\n        left: null,\n        right: null,\n        bottom: null,\n        border: null,\n        background: null,\n        overflow: null,\n        outline: null,\n        padding: null,\n        borderRadius: null,\n        width: 440\n      }\n    };\n\n    if (isOpen) {\n      return (\n        <Modal className=\"modal-new modal-new--edit-group\"\n               closeTimeoutMS={150}\n               isOpen={isOpen}\n               style={modalStyle}>\n\n          <header className=\"modal-new__header\">\n            <a className=\"modal-new__header__icon material-icons\">edit</a>\n            <h3 className=\"modal-new__header__title\">{intl.messages['modal.group.title']}</h3>\n            <div className=\"pull-right\">\n              <button className=\"button button--lightblue\" onClick={this.onSave}>{intl.messages['button.done']}</button>\n            </div>\n          </header>\n\n          <div className=\"modal-new__body row\">\n            <div className=\"col-xs\">\n              <TextField className=\"input__material--wide\"\n                         floatingLabel={intl.messages['modal.group.name']}\n                         onChange={this.onTitleChange}\n                         ref=\"name\"\n                         value={title}/>\n\n              {\n                isAdmin\n                  ? <div className=\"about\">\n                      <label htmlFor=\"about\">{intl.messages['modal.group.about']}</label>\n                      <textarea className=\"textarea\" value={about} onChange={this.onAboutChange} id=\"about\"/>\n                    </div>\n                  : null\n              }\n            </div>\n            <div className=\"profile-picture text-center\">\n              <div className=\"profile-picture__changer\">\n                <AvatarItem image={group.bigAvatar}\n                            placeholder={group.placeholder}\n                            size=\"big\"\n                            title={group.name}/>\n                <a onClick={this.onChangeAvatarClick}>\n                  <span>{intl.messages['modal.group.avatarChange']}</span>\n                </a>\n              </div>\n              <div className=\"profile-picture__controls\">\n                <a onClick={this.onProfilePictureRemove}>{intl.messages['modal.group.avatarRemove']}</a>\n              </div>\n              <form className=\"hide\" ref=\"imageForm\">\n                <input onChange={this.onProfilePictureInputChange} ref=\"imageInput\" type=\"file\"/>\n              </form>\n            </div>\n          </div>\n\n          {cropAvatar}\n        </Modal>\n      );\n    } else {\n      return null;\n    }\n  }\n}\n\nexport default Container.create(EditGroup, {pure: false});\n"]}