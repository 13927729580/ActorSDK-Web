{"version":3,"sources":["../../../src/components/modals/AddContact.react.js"],"names":[],"mappings":"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","file":"AddContact.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport { map, debounce } from 'lodash';\nimport React, { Component, PropTypes } from 'react';\nimport { Container } from 'flux/utils';\nimport Modal from 'react-modal';\nimport { KeyCodes } from '../../constants/ActorAppConstants';\n\nimport AddContactActionCreators from '../../actions/AddContactActionCreators';\n\nimport AddContactStore from '../../stores/AddContactStore';\n\nimport TextField from '../common/TextField.react';\nimport ContactItem from './AddContact/ContactItem.react';\n\nclass AddContact extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  static getStores() {\n    return [AddContactStore];\n  }\n\n  static calculateState() {\n    return {\n      isOpen: AddContactStore.isOpen(),\n      results: AddContactStore.getResults(),\n      isSearching: AddContactStore.isSearching()\n    };\n  }\n\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  componentWillMount() {\n    document.addEventListener('keydown', this.handleKeyDown, false);\n  }\n\n  componentDidMount() {\n    this.refs.query.focus();\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeyDown, false);\n  }\n\n  handleClose = () => AddContactActionCreators.close();\n\n  handleQueryChange = (event) => {\n    const query = event.target.value;\n    this.setState({ query });\n    this.findUsers(query);\n  };\n\n  findUsers = debounce((query) => {\n    AddContactActionCreators.findUsers(query);\n  }, 300, { trailing: true });\n\n  addContact = () => AddContactActionCreators.findUsers(this.state.query);\n\n  handleKeyDown = (event) => {\n    if (event.keyCode === KeyCodes.ESC) {\n      event.preventDefault();\n      this.handleClose();\n    } else if (event.keyCode === KeyCodes.ENTER) {\n      event.preventDefault();\n      this.addContact()\n    }\n  };\n\n  handleSelect = (uid, isContact) => {\n    AddContactActionCreators.addToContacts(uid, isContact);\n    this.handleClose();\n  };\n\n  render() {\n    const { isOpen, query, results } = this.state;\n    const { intl } = this.context;\n    const isQueryEmpty = !query || query.length === '';\n\n    const resultContacts = map(results, (result, index) => <ContactItem key={index} {...result} onSelect={this.handleSelect}/>);\n\n    if (resultContacts.length === 0 && !isQueryEmpty) {\n      resultContacts.push(\n        <li className=\"add-contact__results__item add-contact__results__item--not-found\" key=\"not-found\">\n          {intl.messages['modal.addContact.notFound']}\n        </li>\n      );\n    }\n\n    const modalStyle = {\n      content : {\n        position: null,\n        top: null,\n        left: null,\n        right: null,\n        bottom: null,\n        border: null,\n        background: null,\n        overflow: null,\n        outline: null,\n        padding: null,\n        borderRadius: null,\n        width: 360\n      }\n    };\n\n    return (\n      <Modal className=\"modal-new modal-new--add-contact add-contact\"\n             closeTimeoutMS={150}\n             isOpen={isOpen}\n             style={modalStyle}>\n\n        <header className=\"modal-new__header\">\n          <h3 className=\"modal-new__header__title\">{intl.messages['modal.addContact.title']}</h3>\n          <a className=\"modal-new__header__close modal-new__header__icon material-icons pull-right\"\n             onClick={this.handleClose}>clear</a>\n        </header>\n\n        <div className=\"modal-new__body\">\n          <TextField className=\"input__material--wide\"\n                     floatingLabel={intl.messages['modal.addContact.query']}\n                     onChange={this.handleQueryChange}\n                     ref=\"query\"\n                     value={query}/>\n        </div>\n\n        <footer className=\"modal-new__footer\">\n          <ul className=\"add-contact__results\">\n          {\n            isQueryEmpty\n              ? <li className=\"add-contact__results__item add-contact__results__item--searching\">\n                  {intl.messages['modal.addContact.empty']}\n                </li>\n              : resultContacts\n\n              // Search is too fast for showing searching status.\n              //: isSearching\n              //  ? <li className=\"add-contact__results__item add-contact__results__item--searching\">\n              //      <FormattedMessage id=\"modal.addContact.searching\" values={{query}}/>\n              //    </li>\n              //  : resultContacts\n          }\n          </ul>\n        </footer>\n\n      </Modal>\n    );\n  }\n}\n\nexport default Container.create(AddContact);\n"]}