{"version":3,"sources":["../../../src/components/modals/CallModal.react.js"],"names":[],"mappings":"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","file":"CallModal.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component } from 'react';\nimport { Container } from 'flux/utils';\nimport Modal from 'react-modal';\n import { FormattedMessage } from 'react-intl';\nimport AvatarItem from '../common/AvatarItem.react';\n\nimport { KeyCodes, CallStates } from '../../constants/ActorAppConstants';\n\nimport CallActionCreators from '../../actions/CallActionCreators';\n\nimport CallStore from '../../stores/CallStore';\nimport UserStore from '../../stores/UserStore';\n\nclass CallModal extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  static getStores = () => [CallStore];\n\n  static calculateState() {\n    return {\n      isOpen: CallStore.isOpen(),\n      isOutgoing: CallStore.isOutgoing(),\n      callId: CallStore.getId(),\n      callMembers: CallStore.getMembers(),\n      callPeer: CallStore.getPeer(),\n      callState: CallStore.getState()\n    };\n  }\n\n  handleClose = () => CallActionCreators.hide();\n\n  onKeyDown = (event) => {\n    if (event.keyCode === KeyCodes.ESC) {\n      event.preventDefault();\n      this.handleClose();\n    }\n  };\n\n  handleAnswer = () => {\n    const { callId } = this.state;\n    CallActionCreators.answerCall(callId);\n  };\n\n  handleEnd = () => {\n    const { callId } = this.state;\n    CallActionCreators.endCall(callId);\n    //this.handleClose();\n  };\n\n  handleMute = () => {\n    console.debug('handleMute');\n  };\n\n  render() {\n    const { isOpen, isOutgoing, callPeer, callMembers, callState } = this.state;\n    const peerInfo = callPeer ? ( callPeer.type == 'user' ? UserStore.getUser(callPeer.id) : null) : null;\n\n    const modalStyles = {\n      content : {\n        position: null,\n        top: null,\n        left: null,\n        right: null,\n        bottom: null,\n        border: null,\n        background: null,\n        overflow: null,\n        outline: null,\n        padding: null,\n        borderRadius: null,\n        width: 240,\n        minWidth: 240\n      }\n    };\n\n    const modalBody = peerInfo ? (\n      <div>\n        <AvatarItem image={peerInfo.avatar} placeholder={peerInfo.placeholder}\n                    size=\"big\" title={peerInfo.name}/>\n        <h4 className=\"caller-name\">{peerInfo.name}</h4>\n      </div>\n    ) : null;\n\n    let modalFooter;\n    switch (callState) {\n      case CallStates.CALLING:\n        modalFooter = (\n          <div>\n            {\n              isOutgoing\n                ? null\n                : <button className=\"button button--rised button--wide\" onClick={this.handleAnswer}>\n                    <FormattedMessage id=\"call.answer\"/>\n                  </button>\n            }\n            <button className=\"button button--rised button--wide\" onClick={this.handleEnd}>\n              {\n                isOutgoing\n                  ? <FormattedMessage id=\"button.cancel\"/>\n                  : <FormattedMessage id=\"call.decline\"/>\n              }\n            </button>\n          </div>\n        );\n        break;\n      case CallStates.IN_PROGRESS:\n      case CallStates.CONNECTING:\n        modalFooter = (\n          <div>\n            <button className=\"button button--rised button--wide\" onClick={this.handleMute}>\n              <FormattedMessage id=\"call.mute\"/>\n            </button>\n            <button className=\"button button--rised button--wide\" onClick={this.handleEnd}>\n              <FormattedMessage id=\"call.end\"/>\n            </button>\n          </div>\n        );\n        break;\n      case CallStates.ENDED:\n        modalFooter = (\n          <div>\n            <button className=\"button button--rised button--wide\" onClick={this.handleClose}>\n              <FormattedMessage id=\"button.close\"/>\n            </button>\n          </div>\n        );\n        break;\n      default:\n    }\n\n    if (isOpen) {\n      return (\n        <Modal className=\"modal-new modal-new--call\"\n               closeTimeoutMS={150}\n               style={modalStyles}\n               isOpen={isOpen}>\n\n          <div className=\"modal-new__header\">\n            <h3 className=\"modal-new__header__title\">\n              {\n                isOutgoing\n                  ? <FormattedMessage id=\"call.outgoing\"/>\n                  : <FormattedMessage id=\"call.incoming\"/>\n              }\n            </h3>\n          </div>\n\n          <div className=\"modal-new__body\">\n            {/* <small>STATE: {callState}</small> */}\n            {modalBody}\n          </div>\n\n          <div className=\"modal-new__footer\">\n            {modalFooter}\n          </div>\n        </Modal>\n      );\n    } else {\n      return null;\n    }\n  }\n}\n\nexport default Container.create(CallModal, {pure: false});\n"]}