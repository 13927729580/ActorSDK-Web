{"version":3,"sources":["../../../src/components/modals/InviteUser.react.js"],"names":[],"mappings":"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","file":"InviteUser.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport Modal from 'react-modal';\nimport { Container } from 'flux/utils';\nimport fuzzaldrin from 'fuzzaldrin';\nimport classNames from 'classnames';\n\nimport { KeyCodes, AsyncActionStates } from '../../constants/ActorAppConstants';\nimport { hasMember } from '../../utils/GroupUtils';\n\nimport InviteUserActions from '../../actions/InviteUserActions';\nimport InviteUserByLinkActions from '../../actions/InviteUserByLinkActions';\n\nimport ContactsStore from '../../stores/ContactsStore';\nimport InviteUserStore from '../../stores/InviteUserStore';\n\nimport ContactItem from '../common/ContactItem.react';\nimport Stateful from '../common/Stateful.react';\n\nclass InviteUser extends Component {\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  static getStores() {\n    return [InviteUserStore, ContactsStore];\n  }\n\n  static calculateState() {\n    const contacts = ContactsStore.getState();\n    const { isOpen, group, users, query } = InviteUserStore.getState();\n\n    return {\n      contacts,\n      isOpen,\n      group,\n      users,\n      query\n    };\n  }\n\n  constructor(props, context) {\n    super(props, context);\n\n    this.onClose = this.onClose.bind(this);\n    this.onSearchChange = this.onSearchChange.bind(this);\n    this.onContactSelect = this.onContactSelect.bind(this);\n    this.onInviteUrlByClick = this.onInviteUrlByClick.bind(this);\n    this.onKeyDown = this.onKeyDown.bind(this);\n  }\n\n  componentWillUpdate(nextProps, nextState) {\n    if (nextState.isOpen && !this.state.isOpen) {\n      document.addEventListener('keydown', this.onKeyDown, false);\n    } else if (!nextState.isOpen && this.state.isOpen) {\n      document.removeEventListener('keydown', this.onKeyDown, false);\n    }\n  }\n\n  onClose() {\n    InviteUserActions.hide();\n  }\n\n  onSearchChange(event) {\n    InviteUserActions.setQuery(event.target.value);\n  }\n\n  onContactSelect(uid) {\n    InviteUserActions.inviteUser(this.state.group.id, uid);\n  }\n\n  onInviteUrlByClick() {\n    const { group } = this.state;\n\n    InviteUserByLinkActions.show(group);\n    InviteUserActions.hide();\n  }\n\n  onKeyDown(event) {\n    if (event.keyCode === KeyCodes.ESC) {\n      event.preventDefault();\n      this.onClose();\n    }\n  }\n\n  getContacts() {\n    const { contacts, query } = this.state;\n\n    if (!query) {\n      return contacts;\n    }\n\n    return contacts.filter((contact) => {\n      const score = fuzzaldrin.score(contact.name, query);\n      return score > 0;\n    });\n  }\n\n  renderContacts() {\n    const { intl } = this.context;\n    const { group, users } = this.state;\n    const contacts = this.getContacts();\n\n    if (!contacts.length) {\n      return (\n        <li className=\"contacts__list__item contacts__list__item--empty text-center\">\n          {intl.messages['inviteModalNotFound']}\n        </li>\n      );\n    }\n\n    return contacts.map((contact) => {\n      const isMember = hasMember(group.id, contact.uid);\n      const currentState = isMember ? AsyncActionStates.SUCCESS : (users[contact.uid] || AsyncActionStates.PENDING);\n\n      const onClick = () => {\n        console.log(`%c Trying to invite \"${contact.name}\"(uid=${contact.uid}) to group ${group.id}`, 'color: #fd5c52');\n        this.onContactSelect(contact.uid)\n      };\n\n      const contactClassName = classNames({\n        'contact--disabled': currentState === AsyncActionStates.SUCCESS\n      });\n\n      return (\n        <ContactItem {...contact} className={contactClassName} key={contact.uid}>\n          <Stateful\n            currentState={currentState}\n            pending={<a className=\"material-icons\" onClick={onClick}>person_add</a>}\n            processing={<i className=\"material-icons spin\">autorenew</i>}\n            success={<i className=\"material-icons\">check</i>}\n            failure={<i className=\"material-icons\">warning</i>}\n          />\n        </ContactItem>\n      );\n    });\n  }\n\n  render() {\n    const { isOpen, search } = this.state;\n    const { intl } = this.context;\n\n    if (!isOpen) {\n      return null;\n    }\n\n    const modalStyle = {\n      content : {\n        position: null,\n        top: null,\n        left: null,\n        right: null,\n        bottom: null,\n        border: null,\n        background: null,\n        overflow: null,\n        outline: null,\n        padding: null,\n        borderRadius: null,\n        width: 440\n      }\n    };\n\n    return (\n      <Modal className=\"modal-new modal-new--invite contacts\"\n             closeTimeoutMS={150}\n             isOpen={isOpen}\n             style={modalStyle}>\n\n        <header className=\"modal-new__header\">\n          <a className=\"modal-new__header__icon material-icons\">person_add</a>\n          <h3 className=\"modal-new__header__title\">{intl.messages['inviteModalTitle']}</h3>\n\n          <div className=\"pull-right\">\n            <button className=\"button button--lightblue\" onClick={this.onClose}>{intl.messages['button.done']}</button>\n          </div>\n        </header>\n\n        <div className=\"modal-new__body\">\n          <div className=\"modal-new__search\">\n            <i className=\"material-icons\">search</i>\n            <input className=\"input input--search\"\n                   onChange={this.onSearchChange}\n                   placeholder={intl.messages['inviteModalSearch']}\n                   type=\"search\"\n                   value={search}/>\n          </div>\n\n          <a className=\"link link--blue\" onClick={this.onInviteUrlByClick}>\n            <i className=\"material-icons\">link</i>\n            {intl.messages['inviteByLink']}\n          </a>\n        </div>\n\n        <div className=\"contacts__body\">\n          <ul className=\"contacts__list\">\n            {this.renderContacts()}\n          </ul>\n        </div>\n\n      </Modal>\n    );\n  }\n}\n\nexport default Container.create(InviteUser);\n"]}