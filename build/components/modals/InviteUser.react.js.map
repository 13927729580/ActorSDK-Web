{"version":3,"sources":["../../../src/components/modals/InviteUser.react.js"],"names":[],"mappings":"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","file":"InviteUser.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport { find, assign, forEach } from 'lodash';\n\nimport React, { Component, PropTypes } from 'react';\nimport Modal from 'react-modal';\n\nimport { KeyCodes } from '../../constants/ActorAppConstants';\n\nimport InviteUserActions from '../../actions/InviteUserActions';\nimport InviteUserByLinkActions from '../../actions/InviteUserByLinkActions';\n\nimport ContactStore from '../../stores/PeopleStore';\nimport InviteUserStore from '../../stores/InviteUserStore';\n\nimport ContactItem from './invite-user/ContactItem.react';\n\nconst getStateFromStores = () => {\n  return ({\n    isOpen: InviteUserStore.isModalOpen(),\n    contacts: ContactStore.getList(),\n    group: InviteUserStore.getGroup()\n  });\n};\n\nconst hasMember = (group, userId) =>\n  undefined !== find(group.members, (c) => c.peerInfo.peer.id === userId);\n\nclass InviteUser extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = assign({\n      search: ''\n    }, getStateFromStores());\n\n    InviteUserStore.addChangeListener(this.onChange);\n    ContactStore.addListener(this.onChange);\n  }\n\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  componentWillUnmount() {\n    InviteUserStore.removeChangeListener(this.onChange);\n  }\n\n  componentWillUpdate(nextProps, nextState) {\n    if (nextState.isOpen && !this.state.isOpen) {\n      document.addEventListener('keydown', this.onKeyDown, false);\n    } else if (!nextState.isOpen && this.state.isOpen) {\n      document.removeEventListener('keydown', this.onKeyDown, false);\n    }\n  }\n\n  onChange = () => this.setState(getStateFromStores());\n  onClose = () => InviteUserActions.hide();\n  onContactSelect = (contact) => InviteUserActions.inviteUser(this.state.group.id, contact.uid);\n  onSearchChange = (event) => this.setState({search: event.target.value});\n\n  onInviteUrlByClick = () => {\n    const { group } = this.state;\n\n    InviteUserByLinkActions.show(group);\n    InviteUserActions.hide();\n  };\n\n  onKeyDown = (event) => {\n    if (event.keyCode === KeyCodes.ESC) {\n      event.preventDefault();\n      this.onClose();\n    }\n  };\n\n  render() {\n    const { contacts, group, search, isOpen } = this.state;\n    const { intl } = this.context;\n\n    let contactList = [];\n\n    if (isOpen) {\n\n      forEach(contacts, (contact, i) => {\n        const name = contact.name.toLowerCase();\n        if (name.includes(search.toLowerCase())) {\n          if (!hasMember(group, contact.uid)) {\n            contactList.push(\n              <ContactItem contact={contact} key={i} onSelect={this.onContactSelect}/>\n            );\n          } else {\n            contactList.push(\n              <ContactItem contact={contact} key={i} isMember/>\n            );\n          }\n        }\n      }, this);\n\n      if (contactList.length === 0) {\n        contactList.push(\n          <li className=\"contacts__list__item contacts__list__item--empty text-center\">\n            {intl.messages['inviteModalNotFound']}\n          </li>\n        );\n      }\n      const modalStyle = {\n        content : {\n          position: null,\n          top: null,\n          left: null,\n          right: null,\n          bottom: null,\n          border: null,\n          background: null,\n          overflow: null,\n          outline: null,\n          padding: null,\n          borderRadius: null,\n          width: 440\n        }\n      };\n\n      return (\n        <Modal className=\"modal-new modal-new--invite contacts\"\n               closeTimeoutMS={150}\n               isOpen={isOpen}\n               style={modalStyle}>\n\n          <header className=\"modal-new__header\">\n            <a className=\"modal-new__header__icon material-icons\">person_add</a>\n            <h3 className=\"modal-new__header__title\">{intl.messages['inviteModalTitle']}</h3>\n\n            <div className=\"pull-right\">\n              <button className=\"button button--lightblue\" onClick={this.onClose}>{intl.messages['button.done']}</button>\n            </div>\n          </header>\n\n          <div className=\"modal-new__body\">\n            <div className=\"modal-new__search\">\n              <i className=\"material-icons\">search</i>\n              <input className=\"input input--search\"\n                     onChange={this.onSearchChange}\n                     placeholder={intl.messages['inviteModalSearch']}\n                     type=\"search\"\n                     value={search}/>\n            </div>\n\n            <a className=\"link link--blue\" onClick={this.onInviteUrlByClick}>\n              <i className=\"material-icons\">link</i>\n              {intl.messages['inviteByLink']}\n            </a>\n          </div>\n\n          <div className=\"contacts__body\">\n            <ul className=\"contacts__list\">\n              {contactList}\n            </ul>\n          </div>\n\n        </Modal>\n      );\n    } else {\n      return null;\n    }\n  }\n}\n\nexport default InviteUser;\n"]}