{"version":3,"sources":["../../../src/components/modals/InviteUser.react.js"],"names":[],"mappings":"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","file":"InviteUser.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport Modal from 'react-modal';\nimport { Container } from 'flux/utils';\nimport fuzzaldrin from 'fuzzaldrin';\n\nimport { KeyCodes, AsyncActionStates } from '../../constants/ActorAppConstants';\nimport { hasMember } from '../../utils/GroupUtils';\n\nimport InviteUserActions from '../../actions/InviteUserActions';\nimport InviteUserByLinkActions from '../../actions/InviteUserByLinkActions';\n\nimport PeopleStore from '../../stores/PeopleStore';\nimport InviteUserStore from '../../stores/InviteUserStore';\n\nimport ContactItem from '../common/ContactItem.react';\nimport Stateful from '../common/Stateful.react';\n\nclass InviteUser extends Component {\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  static getStores() {\n    return [InviteUserStore, PeopleStore];\n  }\n\n  static calculateState() {\n    return {\n      isOpen: InviteUserStore.isModalOpen(),\n      contacts: PeopleStore.getList(),\n      group: InviteUserStore.getGroup(),\n      inviteUserState: InviteUserStore.getInviteUserState()\n    };\n  }\n\n  componentWillUpdate(nextProps, nextState) {\n    if (nextState.isOpen && !this.state.isOpen) {\n      document.addEventListener('keydown', this.onKeyDown, false);\n    } else if (!nextState.isOpen && this.state.isOpen) {\n      document.removeEventListener('keydown', this.onKeyDown, false);\n    }\n  }\n\n  onClose = () => InviteUserActions.hide();\n  onContactSelect = (uid) => InviteUserActions.inviteUser(this.state.group.id, uid);\n  onSearchChange = (event) => this.setState({search: event.target.value});\n\n  onInviteUrlByClick = () => {\n    const { group } = this.state;\n\n    InviteUserByLinkActions.show(group);\n    InviteUserActions.hide();\n  };\n\n  onKeyDown = (event) => {\n    if (event.keyCode === KeyCodes.ESC) {\n      event.preventDefault();\n      this.onClose();\n    }\n  };\n\n  getContacts() {\n    const { contacts, search } = this.state;\n\n    return fuzzaldrin.filter(contacts, search, {\n      key: 'name'\n    });\n  }\n\n  renderContacts() {\n    const { intl } = this.context;\n    const { group, inviteUserState } = this.state;\n    const contacts = this.getContacts();\n\n    if (!contacts.length) {\n      return (\n        <li className=\"contacts__list__item contacts__list__item--empty text-center\">\n          {intl.messages['inviteModalNotFound']}\n        </li>\n      );\n    }\n\n    return contacts.map((contact, i) => {\n      let controls, contactClassName;\n      if (hasMember(group.id, contact.uid)) {\n        controls = <i className=\"material-icons\">check</i>;\n        contactClassName = 'contact--disabled'\n      } else {\n        const currentState = inviteUserState[contact.uid] || AsyncActionStates.PENDING;\n        controls = (\n          <Stateful\n            currentState={currentState}\n            pending={<a className=\"material-icons\" onClick={() => this.onContactSelect(contact.uid)}>person_add</a>}\n            processing={<i className=\"material-icons spin\">autorenew</i>}\n            success={<i className=\"material-icons\">check</i>}\n            failure={<i className=\"material-icons\">warning</i>}\n          />\n        );\n        contactClassName = currentState === AsyncActionStates.SUCCESS ? 'contact--disabled' : '';\n      }\n\n      return (\n        <ContactItem {...contact} className={contactClassName} key={i}>\n          {controls}\n        </ContactItem>\n      );\n    });\n  }\n\n  render() {\n    const { isOpen, search } = this.state;\n    const { intl } = this.context;\n\n    if (!isOpen) {\n      return null;\n    }\n\n    const modalStyle = {\n      content : {\n        position: null,\n        top: null,\n        left: null,\n        right: null,\n        bottom: null,\n        border: null,\n        background: null,\n        overflow: null,\n        outline: null,\n        padding: null,\n        borderRadius: null,\n        width: 440\n      }\n    };\n\n    return (\n      <Modal className=\"modal-new modal-new--invite contacts\"\n             closeTimeoutMS={150}\n             isOpen={isOpen}\n             style={modalStyle}>\n\n        <header className=\"modal-new__header\">\n          <a className=\"modal-new__header__icon material-icons\">person_add</a>\n          <h3 className=\"modal-new__header__title\">{intl.messages['inviteModalTitle']}</h3>\n\n          <div className=\"pull-right\">\n            <button className=\"button button--lightblue\" onClick={this.onClose}>{intl.messages['button.done']}</button>\n          </div>\n        </header>\n\n        <div className=\"modal-new__body\">\n          <div className=\"modal-new__search\">\n            <i className=\"material-icons\">search</i>\n            <input className=\"input input--search\"\n                   onChange={this.onSearchChange}\n                   placeholder={intl.messages['inviteModalSearch']}\n                   type=\"search\"\n                   value={search}/>\n          </div>\n\n          <a className=\"link link--blue\" onClick={this.onInviteUrlByClick}>\n            <i className=\"material-icons\">link</i>\n            {intl.messages['inviteByLink']}\n          </a>\n        </div>\n\n        <div className=\"contacts__body\">\n          <ul className=\"contacts__list\">\n            {this.renderContacts()}\n          </ul>\n        </div>\n\n      </Modal>\n    );\n  }\n}\n\nexport default Container.create(InviteUser, {pure: false});\n"]}