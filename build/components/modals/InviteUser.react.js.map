{"version":3,"sources":["../../../src/components/modals/InviteUser.react.js"],"names":[],"mappings":"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","file":"InviteUser.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport { find, assign, forEach } from 'lodash';\n\nimport React, { Component, PropTypes } from 'react';\nimport Modal from 'react-modal';\n\nimport { KeyCodes } from '../../constants/ActorAppConstants';\n\nimport InviteUserActions from '../../actions/InviteUserActions';\nimport InviteUserByLinkActions from '../../actions/InviteUserByLinkActions';\n\nimport ContactStore from '../../stores/PeopleStore';\nimport InviteUserStore from '../../stores/InviteUserStore';\n\nimport ContactItem from './invite-user/ContactItem.react';\n\nconst getStateFromStores = () => {\n  return ({\n    isOpen: InviteUserStore.isModalOpen(),\n    contacts: ContactStore.getList(),\n    group: InviteUserStore.getGroup()\n  });\n};\n\nconst hasMember = (group, userId) =>\n  undefined !== find(group.members, (c) => c.peerInfo.peer.id === userId);\n\nclass InviteUser extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = assign({\n      search: ''\n    }, getStateFromStores());\n\n    InviteUserStore.addChangeListener(this.onChange);\n    ContactStore.addListener(this.onChange);\n  }\n\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  componentWillUnmount() {\n    InviteUserStore.removeChangeListener(this.onChange);\n  }\n\n  componentWillUpdate(nextProps, nextState) {\n    if (nextState.isOpen && !this.state.isOpen) {\n      document.addEventListener('keydown', this.onKeyDown, false);\n    } else if (!nextState.isOpen && this.state.isOpen) {\n      document.removeEventListener('keydown', this.onKeyDown, false);\n    }\n  }\n\n  onChange = () => this.setState(getStateFromStores());\n  onClose = () => InviteUserActions.hide();\n  onContactSelect = (contact) => InviteUserActions.inviteUser(this.state.group.id, contact.uid);\n  onSearchChange = (event) => this.setState({search: event.target.value});\n\n  onInviteUrlByClick = () => {\n    const { group } = this.state;\n\n    InviteUserByLinkActions.show(group);\n    InviteUserActions.hide();\n  };\n\n  onKeyDown = (event) => {\n    if (event.keyCode === KeyCodes.ESC) {\n      event.preventDefault();\n      this.onClose();\n    }\n  };\n\n  render() {\n    const { contacts, group, search, isOpen } = this.state;\n    const { intl } = this.context;\n\n    let contactList = [];\n\n    if (isOpen) {\n\n      forEach(contacts, (contact, i) => {\n        const name = contact.name.toLowerCase();\n        if (name.includes(search.toLowerCase())) {\n          if (!hasMember(group, contact.uid)) {\n            contactList.push(\n              <ContactItem contact={contact} key={i} onSelect={this.onContactSelect}/>\n            );\n          } else {\n            contactList.push(\n              <ContactItem contact={contact} key={i} isMember/>\n            );\n          }\n        }\n      }, this);\n\n      if (contactList.length === 0) {\n        contactList.push(\n          <li className=\"contacts__list__item contacts__list__item--empty text-center\">\n            {intl.messages['inviteModalNotFound']}\n          </li>\n        );\n      }\n      const modalStyle = {\n        content : {\n          position: null,\n          top: null,\n          left: null,\n          right: null,\n          bottom: null,\n          border: null,\n          background: null,\n          overflow: null,\n          outline: null,\n          padding: null,\n          borderRadius: null,\n          width: 440\n        }\n      };\n\n      return (\n        <Modal className=\"modal-new modal-new--invite contacts\"\n               closeTimeoutMS={150}\n               isOpen={isOpen}\n               style={modalStyle}>\n\n          <header className=\"modal-new__header\">\n            <a className=\"modal-new__header__icon material-icons\">person_add</a>\n            <h3 className=\"modal-new__header__title\">{intl.messages['inviteModalTitle']}</h3>\n\n            <div className=\"pull-right\">\n              <button className=\"button button--lightblue\" onClick={this.onClose}>{intl.messages['button.done']}</button>\n            </div>\n          </header>\n\n          <div className=\"modal-new__body\">\n            <div className=\"modal-new__search\">\n              <i className=\"material-icons\">search</i>\n              <input className=\"input input--search\"\n                     onChange={this.onSearchChange}\n                     placeholder={intl.messages['inviteModalSearch']}\n                     type=\"search\"\n                     value={search}/>\n            </div>\n\n            <a className=\"link link--blue\" onClick={this.onInviteUrlByClick}>\n              <i className=\"material-icons\">link</i>\n              {intl.messages['inviteByLink']}\n            </a>\n          </div>\n\n          <div className=\"contacts__body\">\n            <ul className=\"contacts__list\">\n              {contactList}\n            </ul>\n          </div>\n\n        </Modal>\n      );\n    } else {\n      return null;\n    }\n  }\n}\n\nexport default InviteUser;\n"]}