{"version":3,"sources":["../../../src/components/modals/CropAvatar.react.js"],"names":[],"mappings":"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","file":"CropAvatar.react.js","sourcesContent":["/*\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component } from 'react';\nimport { Container } from 'flux/utils';\nimport classnames from 'classnames';\nimport ReactMixin from 'react-mixin';\nimport { IntlMixin } from 'react-intl';\nimport { dataURItoBlob } from '../../utils/ImageUtils';\n\nimport Modal from 'react-modal';\n\nimport { KeyCodes } from '../../constants/ActorAppConstants';\n\nimport CropAvatarActionCreators from '../../actions/CropAvatarActionCreators';\n\nimport CropAvatarStore from '../../stores/CropAvatarStore'\n\nconst minCropSize = 100;\n\nclass CropAvatarModal extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  static propTypes = {\n    onCropFinish: React.PropTypes.func.isRequired\n  };\n\n  static getStores = () => [CropAvatarStore];\n\n  static calculateState() {\n    return {\n      isOpen: CropAvatarStore.isOpen(),\n      pictureSource: CropAvatarStore.getPictureSource(),\n      cropPosition: {\n        x: 0,\n        y: 0\n      },\n      cropSize: 200,\n      scaledWidth: 0,\n      scaledHeight: 0,\n      naturalWidth: 0,\n      naturalHeight: 0,\n      maxImageHeight: (document.body.clientHeight * .9) - 64 // 64 is modal header height.\n    };\n  }\n\n  componentDidMount() {\n    const originalImage = React.findDOMNode(this.refs.originalImage);\n    document.addEventListener('keydown', this.onKeyDown, false);\n    window.addEventListener('resize', this.storeScaledSizes, false);\n    originalImage.addEventListener('load', this.storeScaledSizes, false);\n  }\n\n  componentWillUnmount() {\n    const originalImage = React.findDOMNode(this.refs.originalImage);\n    document.removeEventListener('keydown', this.onKeyDown, false);\n    window.removeEventListener('resize', this.storeScaledSizes, false);\n  }\n\n  onClose = () => CropAvatarActionCreators.hide();\n\n  onKeyDown = (event) => {\n    if (event.keyCode === KeyCodes.ESC) {\n      event.preventDefault();\n      this.onClose();\n    }\n  };\n\n  onStartMoving = (event) => {\n    const { cropPosition } = this.state;\n\n    event.preventDefault();\n\n    const wrapper = React.findDOMNode(this.refs.wrapper);\n    const wrapperRect = wrapper.getBoundingClientRect();\n\n    const dragOffset = {\n      x: (event.pageX - wrapperRect.left) - cropPosition.x,\n      y: (event.pageY - wrapperRect.top) - cropPosition.y\n    };\n    this.setState({dragOffset});\n\n    wrapper.addEventListener('mousemove', this.onMoving);\n    wrapper.addEventListener('touchmove', this.onMoving);\n  };\n  onMoving = (event) => {\n    const { dragOffset, cropSize } = this.state;\n    const wrapper = React.findDOMNode(this.refs.wrapper);\n    const wrapperRect = wrapper.getBoundingClientRect();\n\n    let cropPosition = {\n      x: (event.pageX - wrapperRect.left) - dragOffset.x,\n      y: (event.pageY - wrapperRect.top) - dragOffset.y\n    };\n\n    if (cropPosition.x < 0) {\n      cropPosition.x = 0;\n    } else if (cropPosition.x > wrapperRect.width - cropSize) {\n      cropPosition.x = wrapperRect.width - cropSize;\n    }\n\n    if (cropPosition.y < 0) {\n      cropPosition.y = 0;\n    } else if (cropPosition.y > wrapperRect.height - cropSize) {\n      cropPosition.y = wrapperRect.height - cropSize;\n    }\n\n    this.setState({cropPosition})\n  };\n\n  onStartResizeTop = (event) => {\n    const wrapper = React.findDOMNode(this.refs.wrapper);\n    const resizeLastCoord = event.pageY;\n    event.preventDefault();\n    this.setState({resizeLastCoord});\n    wrapper.addEventListener('mousemove', this.onResizeTop);\n    wrapper.addEventListener('touchmove', this.onResizeTop);\n  };\n\n  onStartResizeRight = (event) => {\n    const wrapper = React.findDOMNode(this.refs.wrapper);\n    const resizeLastCoord = event.pageX;\n    event.preventDefault();\n    this.setState({resizeLastCoord});\n    wrapper.addEventListener('mousemove', this.onResizeRight);\n    wrapper.addEventListener('touchmove', this.onResizeRight);\n  };\n\n  onStartResizeBottom = (event) => {\n    const wrapper = React.findDOMNode(this.refs.wrapper);\n    const resizeLastCoord = event.pageY;\n    event.preventDefault();\n    this.setState({resizeLastCoord});\n    wrapper.addEventListener('mousemove', this.onResizeBottom);\n    wrapper.addEventListener('touchmove', this.onResizeBottom);\n  };\n\n  onStartResizeLeft = (event) => {\n    const wrapper = React.findDOMNode(this.refs.wrapper);\n    const resizeLastCoord = event.pageX;\n    event.preventDefault();\n    this.setState({resizeLastCoord});\n    wrapper.addEventListener('mousemove', this.onResizeLeft);\n    wrapper.addEventListener('touchmove', this.onResizeLeft);\n  };\n\n  onResizeTop = (event) => this.onCropResize(event, 'TOP');\n  onResizeRight = (event) => this.onCropResize(event, 'RIGHT');\n  onResizeBottom = (event) => this.onCropResize(event, 'BOTTOM');\n  onResizeLeft = (event) => this.onCropResize(event, 'LEFT');\n\n  onCropResize = (event, direction) => {\n    const { cropPosition, resizeLastCoord, cropSize, scaledWidth, scaledHeight } = this.state;\n    const axisCoord = (direction === 'RIGHT' || direction === 'LEFT') ? event.pageX : event.pageY;\n    const resizeValue = resizeLastCoord - axisCoord;\n\n    let resizeCropPosition, resizedCropSize;\n    switch (direction) {\n      case 'TOP':\n        resizedCropSize = cropSize + resizeValue;\n        resizeCropPosition = {\n          x: cropPosition.x - (resizeValue / 2),\n          y: cropPosition.y - resizeValue\n        };\n        break;\n      case 'RIGHT':\n        resizedCropSize = cropSize - resizeValue;\n        resizeCropPosition = {\n          x: cropPosition.x,\n          y: cropPosition.y + (resizeValue / 2)\n        };\n        break;\n      case 'BOTTOM':\n        resizedCropSize = cropSize - resizeValue;\n        resizeCropPosition = {\n          x: cropPosition.x + (resizeValue / 2),\n          y: cropPosition.y\n        };\n        break;\n      case 'LEFT':\n        resizedCropSize = cropSize + resizeValue;\n        resizeCropPosition = {\n          x: cropPosition.x - resizeValue,\n          y: cropPosition.y - (resizeValue / 2)\n        };\n        break;\n      default:\n    }\n\n    if (resizedCropSize < minCropSize || resizedCropSize > scaledWidth || resizedCropSize > scaledHeight) {\n      resizedCropSize = cropSize;\n      resizeCropPosition = cropPosition;\n    }\n\n    this.setState({resizeLastCoord: axisCoord});\n    this.updateCropSize(resizedCropSize, resizeCropPosition);\n  };\n\n  removeListeners = () => {\n    const wrapper = React.findDOMNode(this.refs.wrapper);\n\n    wrapper.removeEventListener('mousemove', this.onMoving);\n    wrapper.removeEventListener('touchmove', this.onMoving);\n    wrapper.removeEventListener('mousemove', this.onResizeTop);\n    wrapper.removeEventListener('touchmove', this.onResizeTop);\n    wrapper.removeEventListener('mousemove', this.onResizeRight);\n    wrapper.removeEventListener('touchmove', this.onResizeRight);\n    wrapper.removeEventListener('mousemove', this.onResizeBottom);\n    wrapper.removeEventListener('touchmove', this.onResizeBottom);\n    wrapper.removeEventListener('mousemove', this.onResizeLeft);\n    wrapper.removeEventListener('touchmove', this.onResizeLeft);\n  };\n\n  updateCropSize = (cropSize, cropPosition) => this.setState({cropSize, cropPosition});\n\n  onCrop = () => {\n    const { cropPosition, cropSize, scaleRatio } = this.state;\n    const { onCropFinish } = this.props;\n    const cropImage = React.findDOMNode(this.refs.cropImage);\n    let canvas = document.createElement('canvas');\n    let context = canvas.getContext('2d');\n\n    canvas.width = canvas.height = cropSize;\n\n    context.drawImage(cropImage, cropPosition.x / scaleRatio, cropPosition.y / scaleRatio, cropSize / scaleRatio, cropSize / scaleRatio, 0, 0, cropSize, cropSize);\n\n    const croppedImage = dataURItoBlob(canvas.toDataURL());\n\n    onCropFinish(croppedImage);\n    this.onClose();\n  };\n\n  storeScaledSizes = (event) => {\n    const { cropSize } = this.state;\n    const originalImage = React.findDOMNode(this.refs.originalImage);\n    const scaledWidth = originalImage.width;\n    const scaledHeight = originalImage.height;\n    const naturalWidth = originalImage.naturalWidth;\n    const naturalHeight = originalImage.naturalHeight;\n    const scaleRatio = scaledWidth/naturalWidth;\n    const cropPosition = {\n      x: ((naturalWidth / 2) - (cropSize / 2)) * scaleRatio,\n      y: ((naturalHeight / 2) - (cropSize / 2)) * scaleRatio\n    };\n\n    this.setState({cropPosition, scaledWidth, scaledHeight, naturalWidth, naturalHeight, scaleRatio});\n  };\n\n  render() {\n    const { isOpen, pictureSource, cropPosition, cropSize, scaledWidth, scaledHeight, maxImageHeight } = this.state;\n\n    if (isOpen) {\n      return (\n        <Modal className=\"modal-new modal-new--profile-picture\"\n               closeTimeoutMS={150}\n               isOpen={isOpen}>\n\n          <div className=\"modal-new__header\">\n            <i className=\"modal-new__header__icon material-icons\">crop</i>\n            <h3 className=\"modal-new__header__title\">{this.getIntlMessage('modal.crop.title')}</h3>\n            <div className=\"pull-right\">\n              <button className=\"button button--lightblue\" onClick={this.onCrop}>{this.getIntlMessage('button.done')}</button>\n            </div>\n          </div>\n\n          <div className=\"modal-new__body\">\n            <div className=\"crop-wrapper\"\n                 ref=\"wrapper\"\n                 onTouchEnd={this.removeListeners}\n                 onMouseUp={this.removeListeners}>\n              <div className=\"crop-wrapper__scale\"\n                   style={{width: cropSize, height: cropSize, left: cropPosition.x, top: cropPosition.y}}>\n                <div className=\"crop-wrapper__scale__handler crop-wrapper__scale__handler--top\"\n                     onMouseDown={this.onStartResizeTop}\n                     onTouchStart={this.onStartResizeTop}/>\n                <div className=\"crop-wrapper__scale__handler crop-wrapper__scale__handler--right\"\n                     onMouseDown={this.onStartResizeRight}\n                     onTouchStart={this.onStartResizeRight}/>\n                <div className=\"crop-wrapper__scale__handler crop-wrapper__scale__handler--bottom\"\n                     onMouseDown={this.onStartResizeBottom}\n                     onTouchStart={this.onStartResizeBottom}/>\n                <div className=\"crop-wrapper__scale__handler crop-wrapper__scale__handler--left\"\n                     onMouseDown={this.onStartResizeLeft}\n                     onTouchStart={this.onStartResizeLeft}/>\n              </div>\n              <div className=\"crop-wrapper__overlay\"\n                   onMouseDown={this.onStartMoving}\n                   onTouchStart={this.onStartMoving}\n                   style={{ width: cropSize, height: cropSize, left: cropPosition.x, top: cropPosition.y}}>\n                <img className=\"crop-wrapper__image-crop\"\n                     draggable=\"false\"\n                     ref=\"cropImage\"\n                     src={pictureSource}\n                     style={{left: -cropPosition.x, top: -cropPosition.y, width: scaledWidth, height: scaledHeight}}/>\n              </div>\n              <img className=\"crop-wrapper__image-original\"\n                   draggable=\"false\"\n                   ref=\"originalImage\"\n                   src={pictureSource}\n                   style={{maxHeight: maxImageHeight}}/>\n            </div>\n          </div>\n        </Modal>\n      );\n    } else {\n      return null;\n    }\n  }\n}\n\nReactMixin.onClass(CropAvatarModal, IntlMixin);\n\nexport default Container.create(CropAvatarModal);\n"]}