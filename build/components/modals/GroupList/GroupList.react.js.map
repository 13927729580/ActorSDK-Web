{"version":3,"sources":["../../../../src/components/modals/GroupList/GroupList.react.js"],"names":[],"mappings":"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","file":"GroupList.react.js","sourcesContent":["/*\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\n */\n\nimport { map, debounce } from 'lodash';\n\nimport React, { Component } from 'react';\nimport { Container } from 'flux/utils';\nimport ReactMixin from 'react-mixin';\nimport { IntlMixin, FormattedHTMLMessage } from 'react-intl';\n\nimport { KeyCodes } from '../../../constants/ActorAppConstants';\n\nimport GroupListActionCreators from '../../../actions/GroupListActionCreators'\nimport DialogActionCreators from '../../../actions/DialogActionCreators'\n\nimport GroupListStore from '../../../stores/GroupListStore';\n\nimport Group from './Group.react';\n\nclass GroupList extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  static getStores = () => [GroupListStore];\n\n  static calculateState() {\n    return {\n      list: GroupListStore.getList(),\n      results: GroupListStore.getResults(),\n      selectedIndex: 0\n    };\n  }\n\n  componentDidMount() {\n    this.setFocus();\n    document.addEventListener('keydown', this.handleKeyDown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeyDown, false);\n  }\n\n  render() {\n    const { query, results, selectedIndex, list } = this.state;\n\n    let groupList = map(results, (result, index) => <Group group={result} key={index}\n                                                           isSelected={selectedIndex === index}\n                                                           ref={selectedIndex === index ? 'selected' : null}\n                                                           onClick={this.handleGroupSelect}\n                                                           onMouseOver={() => this.setState({selectedIndex: index})}/>);\n\n    return (\n      <div className=\"newmodal newmodal__groups\">\n        <header className=\"newmodal__header\">\n          <h2>{this.getIntlMessage('modal.groups.title')}</h2>\n        </header>\n\n        <section className=\"newmodal__search\">\n          <input className=\"newmodal__search__input\"\n                 onChange={this.handleSearchChange}\n                 placeholder={this.getIntlMessage('modal.groups.search')}\n                 type=\"search\"\n                 ref=\"search\"\n                 value={query}/>\n        </section>\n\n        <ul className=\"newmodal__result group__list\" ref=\"results\">\n          {\n            list.length === 0\n              ? <div>{this.getIntlMessage('modal.groups.loading')}</div>\n              : results.length === 0\n                ? <li className=\"group__list__item group__list__item--empty text-center\">\n                    <FormattedHTMLMessage message={this.getIntlMessage('modal.groups.notFound')}\n                                          query={query} />\n                  </li>\n                : groupList\n          }\n        </ul>\n      </div>\n    )\n  }\n\n  setFocus = () => React.findDOMNode(this.refs.search).focus();\n  handleClose = () => GroupListActionCreators.close();\n\n  handleSearchChange = (event) => {\n    const query = event.target.value;\n    this.setState({query});\n    this.searchGroups(query)\n  };\n\n  searchGroups = debounce((query) => GroupListActionCreators.search(query), 300, {trailing: true});\n\n  handleGroupSelect = (peer) => {\n    DialogActionCreators.selectDialogPeer(peer);\n    this.handleClose()\n  };\n\n  handleKeyDown = (event) => {\n    const { results, selectedIndex } = this.state;\n    let index = selectedIndex;\n\n    const selectNext = () => {\n      if (index < results.length - 1) {\n        index += 1;\n      } else if (index === results.length - 1) {\n        index = 0;\n      }\n\n      this.setState({selectedIndex: index});\n\n      const scrollContainerNode = React.findDOMNode(this.refs.results);\n      const selectedNode = React.findDOMNode(this.refs.selected);\n      const scrollContainerNodeRect = scrollContainerNode.getBoundingClientRect();\n      const selectedNodeRect = selectedNode.getBoundingClientRect();\n\n      if ((scrollContainerNodeRect.top + scrollContainerNodeRect.height) < (selectedNodeRect.top + selectedNodeRect.height)) {\n        this.handleScroll(scrollContainerNode.scrollTop + (selectedNodeRect.top + selectedNodeRect.height) - (scrollContainerNodeRect.top + scrollContainerNodeRect.height));\n      } else if (scrollContainerNodeRect.top > selectedNodeRect.top) {\n        this.handleScroll(0);\n      }\n    };\n    const selectPrev = () => {\n      if (index > 0) {\n        index -= 1;\n      } else if (index === 0) {\n        index = results.length - 1;\n      }\n\n      this.setState({selectedIndex: index});\n\n      const scrollContainerNode = React.findDOMNode(this.refs.results);\n      const selectedNode = React.findDOMNode(this.refs.selected);\n      const scrollContainerNodeRect = scrollContainerNode.getBoundingClientRect();\n      const selectedNodeRect = selectedNode.getBoundingClientRect();\n\n      if (scrollContainerNodeRect.top > selectedNodeRect.top) {\n        this.handleScroll(scrollContainerNode.scrollTop + selectedNodeRect.top - scrollContainerNodeRect.top);\n      } else if (selectedNodeRect.top > (scrollContainerNodeRect.top + scrollContainerNodeRect.height)) {\n       this.handleScroll(scrollContainerNode.scrollHeight);\n      }\n    };\n\n    switch (event.keyCode) {\n      case KeyCodes.ENTER:\n        event.stopPropagation();\n        event.preventDefault();\n        this.handleGroupSelect(results[selectedIndex].peerInfo.peer);\n        break;\n\n      case KeyCodes.ARROW_UP:\n        event.stopPropagation();\n        event.preventDefault();\n        selectPrev();\n        break;\n      case KeyCodes.ARROW_DOWN:\n        event.stopPropagation();\n        event.preventDefault();\n        selectNext();\n        break;\n      case KeyCodes.TAB:\n        event.stopPropagation();\n        event.preventDefault();\n        if (event.shiftKey) {\n          selectPrev();\n        } else {\n          selectNext();\n        }\n        break;\n      default:\n    }\n  };\n\n  handleScroll = (top) => {\n    const resultsNode = React.findDOMNode(this.refs.results);\n    resultsNode.scrollTop = top;\n  };\n}\n\nReactMixin.onClass(GroupList, IntlMixin);\n\nexport default Container.create(GroupList, {pure: false});\n"]}