{"version":3,"sources":["../../../src/components/modals/Attachments.react.js"],"names":[],"mappings":"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","file":"Attachments.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component } from 'react';\nimport { Container } from 'flux/utils';\nimport { findDOMNode } from 'react-dom';\nimport { FormattedMessage } from 'react-intl';\nimport Modal from 'react-modal';\n\nimport { KeyCodes } from '../../constants/ActorAppConstants';\n\nimport AttachmentsActionCreators from '../../actions/AttachmentsActionCreators';\n\nimport AttachmentsStore from '../../stores/AttachmentsStore';\n\nimport Attachment from './attachments/Attachment.react';\nimport Pagination from './attachments/Pagination.react';\n\nclass Attachments extends Component {\n  static getStores() {\n    return [AttachmentsStore];\n  }\n\n  static calculateState() {\n    return {\n      attachments: AttachmentsStore.getAllAttachments(),\n      selectedIndex: AttachmentsStore.getSelectedIndex()\n    }\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.handleClose = this.handleClose.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.handleSelect = this.handleSelect.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n    this.handleSend = this.handleSend.bind(this);\n    this.handleSendAll = this.handleSendAll.bind(this);\n  }\n\n  componentWillMount() {\n    document.addEventListener('keydown', this.handleKeyDown, false);\n  }\n\n  componentDidMount() {\n    findDOMNode(this.refs.send).focus()\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeyDown, false);\n  }\n\n  handleClose() {\n    AttachmentsActionCreators.hide();\n  }\n\n  handleKeyDown(event) {\n    if (event.keyCode === KeyCodes.ENTER) {\n      event.preventDefault();\n      if (event.shiftKey) {\n        this.handleSendAll();\n      } else {\n        this.handleSend();\n      }\n    }\n  }\n\n  handleSelect(index) {\n    AttachmentsActionCreators.selectAttachment(index);\n  }\n\n  handleCancel() {\n    AttachmentsActionCreators.deleteAttachment();\n  }\n\n  handleSend() {\n    AttachmentsActionCreators.sendAttachment();\n  }\n\n  handleSendAll() {\n    AttachmentsActionCreators.sendAll(this.state.attachments);\n  }\n\n  renderHeaderButton() {\n    const { attachments } = this.state;\n    if (attachments.length <= 1) return null;\n\n    return (\n      <button className=\"button button--lightblue\" onClick={this.handleSendAll}>\n        <FormattedMessage id=\"button.sendAll\"/>\n      </button>\n    );\n  }\n\n  renderAttachment() {\n    const { attachments, selectedIndex } = this.state;\n    if (attachments.length === 0) return null;\n\n    return (\n      <Attachment attachment={attachments[selectedIndex]}/>\n    );\n  }\n\n  renderPagination() {\n    const { attachments, selectedIndex } = this.state;\n    if (attachments.length <= 1) return null;\n\n    return (\n      <div className=\"col-xs\">\n        <Pagination\n          current={selectedIndex}\n          total={attachments.length - 1}\n          onChange={this.handleSelect}\n        />\n      </div>\n    );\n  }\n\n  renderControls() {\n    return (\n      <div className=\"col-xs text-right\">\n        <button className=\"button\" onClick={this.handleCancel}>\n          <FormattedMessage id=\"button.cancel\"/>\n        </button>\n        <button className=\"button button--rised\" ref=\"send\" onClick={this.handleSend}>\n          <FormattedMessage id=\"button.send\"/>\n        </button>\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <Modal\n        overlayClassName=\"modal-overlay\"\n        className=\"modal\"\n        onRequestClose={this.handleClose}\n        isOpen>\n\n        <div className=\"attachments\">\n          <div className=\"modal__content\">\n\n            <header className=\"modal__header\">\n              <FormattedMessage id=\"modal.attachments.title\" tagName=\"h1\"/>\n              {this.renderHeaderButton()}\n            </header>\n\n            <div className=\"modal__body\">\n              {this.renderAttachment()}\n            </div>\n\n            <footer className=\"modal__footer row\">\n              {this.renderPagination()}\n              {this.renderControls()}\n            </footer>\n\n          </div>\n        </div>\n\n      </Modal>\n    );\n  }\n}\n\nexport default Container.create(Attachments);\n"]}