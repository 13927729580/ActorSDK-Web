{"version":3,"sources":["../../../src/components/common/UserMenu.react.js"],"names":[],"mappings":"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","file":"UserMenu.react.js","sourcesContent":["/*\n* Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n*/\n\nimport React, { Component, PropTypes } from 'react';\nimport { Container } from 'flux/utils';\nimport classnames from 'classnames';\nimport ActorClient from '../../utils/ActorClient';\nimport { escapeWithEmoji } from '../../utils/EmojiUtils'\nimport confirm from '../../utils/confirm'\nimport SharedContainer from '../../utils/SharedContainer';\nimport { FormattedMessage } from 'react-intl';\n\nimport ProfileActionCreators from '../../actions/ProfileActionCreators';\nimport CreateGroupActionCreators from '../../actions/CreateGroupActionCreators';\nimport LoginActionCreators from '../../actions/LoginActionCreators';\nimport HelpActionCreators from '../../actions/HelpActionCreators';\nimport AddContactActionCreators from '../../actions/AddContactActionCreators';\nimport PreferencesActionCreators from '../../actions/PreferencesActionCreators';\n\nimport ProfileStore from '../../stores/ProfileStore';\n\nimport SvgIcon from '../common/SvgIcon.react';\nimport AvatarItem from '../common/AvatarItem.react';\n\nclass UserMenu extends Component {\n  static propTypes = {\n    className: PropTypes.string\n  }\n\n  static getStores() {\n    return [ProfileStore];\n  }\n\n  static calculateState() {\n    return {\n      profile: ProfileStore.getProfile()\n    }\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isOpened: false\n    }\n\n    this.openHelp = this.openHelp.bind(this);\n    this.openTwitter = this.openTwitter.bind(this);\n    this.openFacebook = this.openFacebook.bind(this);\n    this.openHomePage = this.openHomePage.bind(this);\n    this.setLogout = this.setLogout.bind(this);\n    this.toggleHeaderMenu = this.toggleHeaderMenu.bind(this);\n    this.closeHeaderMenu = this.closeHeaderMenu.bind(this);\n    this.openMyProfile = this.openMyProfile.bind(this);\n    this.openCreateGroup = this.openCreateGroup.bind(this);\n    this.openAddContactModal = this.openAddContactModal.bind(this);\n    this.onSettingsOpen = this.onSettingsOpen.bind(this);\n  }\n\n  toggleHeaderMenu() {\n    const { isOpened } = this.state;\n\n    if (!isOpened) {\n      this.setState({ isOpened: true });\n      document.addEventListener('click', this.closeHeaderMenu, false);\n    } else {\n      this.closeHeaderMenu();\n    }\n  }\n\n  closeHeaderMenu() {\n    this.setState({ isOpened: false });\n    document.removeEventListener('click', this.closeHeaderMenu, false);\n  }\n\n  openMyProfile() {\n    ProfileActionCreators.show();\n  }\n\n  openCreateGroup() {\n    CreateGroupActionCreators.open();\n  }\n\n  openAddContactModal() {\n    AddContactActionCreators.open();\n  }\n\n  onSettingsOpen() {\n    PreferencesActionCreators.show();\n  }\n\n  openHelp() {\n    HelpActionCreators.open()\n  }\n\n  openTwitter(event) {\n    const { twitter } = SharedContainer.get();\n\n    event.preventDefault();\n    if (ActorClient.isElectron()) {\n      ActorClient.handleLinkClick(event);\n    } else {\n      window.open(`https://twitter.com/${twitter}`, '_blank');\n    }\n  }\n\n  openFacebook(event) {\n    const { facebook } = SharedContainer.get();\n\n    event.preventDefault();\n    if (ActorClient.isElectron()) {\n      ActorClient.handleLinkClick(event);\n    } else {\n      window.open(`https://facebook.com/${facebook}`, '_blank');\n    }\n  }\n\n  openHomePage(event) {\n    const { homePage } = SharedContainer.get();\n\n    event.preventDefault();\n    if (ActorClient.isElectron()) {\n      ActorClient.handleLinkClick(event);\n    } else {\n      window.open(homePage, '_blank');\n    }\n  }\n\n  setLogout() {\n    confirm(<FormattedMessage id=\"modal.confirm.logout\"/>).then(\n      () => LoginActionCreators.setLoggedOut(),\n      () => {}\n    );\n  }\n\n  renderTwitterLink() {\n    const { twitter } = SharedContainer.get();\n    if (!twitter) return null;\n\n    return (\n      <li className=\"dropdown__menu__item\">\n        <a href={`https://twitter.com/${twitter}`} onClick={this.openTwitter}>\n          <SvgIcon className=\"icon icon--dropdown sidebar__header__twitter\" glyph=\"twitter\" />\n          <FormattedMessage id=\"menu.twitter\"/>\n        </a>\n      </li>\n    );\n  }\n\n  renderFacebookLink() {\n    const { facebook } = SharedContainer.get();\n    if (!facebook) return null;\n\n    return (\n      <li className=\"dropdown__menu__item\">\n        <a href={`https://facebook.com/${facebook}`} onClick={this.openFacebook}>\n          <SvgIcon className=\"icon icon--dropdown sidebar__header__facebook\" glyph=\"facebook\" />\n          <FormattedMessage id=\"menu.facebook\"/>\n        </a>\n      </li>\n    );\n  }\n\n  renderHomeLink() {\n    const { homePage } = SharedContainer.get();\n    if (!homePage) return null;\n\n    return (\n      <li className=\"dropdown__menu__item\">\n        <a href={homePage} onClick={this.openHomePage}>\n          <i className=\"material-icons\">public</i>\n          <FormattedMessage id=\"menu.homePage\"/>\n        </a>\n      </li>\n    );\n  }\n\n  renderHelpLink() {\n    const { helpPhone } = SharedContainer.get();\n    if (!helpPhone) return null;\n\n    if (/@/.test(helpPhone)) {\n      return (\n        <li className=\"dropdown__menu__item\">\n          <a href={`mailto:${helpPhone}`}>\n            <i className=\"material-icons\">help</i>\n            <FormattedMessage id=\"menu.helpAndFeedback\"/>\n          </a>\n        </li>\n      );\n    } else {\n      return (\n        <li className=\"dropdown__menu__item\" onClick={this.openHelp}>\n          <i className=\"material-icons\">help</i>\n          <FormattedMessage id=\"menu.helpAndFeedback\"/>\n        </li>\n      );\n    }\n  }\n\n  renderMenu() {\n    const { isOpened } = this.state;\n\n    const menuClass = classnames('dropdown user-menu__dropdown', {\n      'dropdown--opened': isOpened\n    });\n\n    return (\n      <div className={menuClass}>\n        <ul className=\"dropdown__menu dropdown__menu--right\">\n          <li className=\"dropdown__menu__item\" onClick={this.openMyProfile}>\n            <i className=\"material-icons\">edit</i>\n            <FormattedMessage id=\"menu.editProfile\"/>\n          </li>\n          <li className=\"dropdown__menu__item\" onClick={this.openAddContactModal}>\n            <i className=\"material-icons\">person_add</i>\n            <FormattedMessage id=\"menu.addToContacts\"/>\n          </li>\n          <li className=\"dropdown__menu__item\" onClick={this.openCreateGroup}>\n            <i className=\"material-icons\">group_add</i>\n            <FormattedMessage id=\"menu.createGroup\"/>\n          </li>\n\n          <li className=\"dropdown__menu__separator\"/>\n\n          <li className=\"dropdown__menu__item\" onClick={this.onSettingsOpen}>\n            <i className=\"material-icons\">settings</i>\n            <FormattedMessage id=\"menu.preferences\"/>\n          </li>\n          {this.renderHelpLink()}\n          {this.renderTwitterLink()}\n          {this.renderFacebookLink()}\n          {this.renderHomeLink()}\n\n          <li className=\"dropdown__menu__separator\"/>\n\n          <li className=\"dropdown__menu__item\" onClick={this.setLogout}>\n            <FormattedMessage id=\"menu.signOut\"/>\n          </li>\n        </ul>\n      </div>\n\n    );\n  }\n\n  render() {\n    const { className } = this.props;\n    const { profile, isOpened } = this.state;\n\n    if (!profile) return null;\n\n    const usermenuClassName = classnames('user-menu', className, {\n      'user-menu--opened': isOpened\n    });\n\n    return (\n      <div className={usermenuClassName} onClick={this.toggleHeaderMenu}>\n        <AvatarItem\n          className=\"user-menu__avatar\"\n          image={profile.avatar}\n          placeholder={profile.placeholder}\n          size=\"tiny\"\n          title={profile.name}\n        />\n\n        <div\n          className=\"user-menu__name\"\n          dangerouslySetInnerHTML={{ __html: escapeWithEmoji(profile.name) }}\n        />\n\n        <i className=\"user-menu__icon material-icons\">arrow_drop_down</i>\n\n        {this.renderMenu()}\n      </div>\n    );\n  }\n}\n\nexport default Container.create(UserMenu);\n"]}