{"version":3,"sources":["../../../src/components/common/VoiceRecorder.react.js"],"names":[],"mappings":";;;;AAIA;;;;AACA;;;;AACA;;;;;;;;;;;;;;AAEA,IAAI,uBAAuB,uBAAS,oBAAT,KAAkC,IAAlC,GAAyC,KAApE;AACA,QAAQ,KAAR,CAAc,sBAAd,EAAsC,oBAAtC;;IAEM,a;;;AAKJ,yBAAY,KAAZ,EAAmB;AAAA;;AAAA,iDACjB,sBAAM,KAAN,CADiB;;AAAA,UAenB,iBAfmB,GAeC,YAAM;AACxB,YAAK,QAAL,CAAc,UAAd;AACD,KAjBkB;;AAAA,UAmBnB,gBAnBmB,GAmBA,YAAM;AACvB,YAAK,QAAL,CAAc,IAAd;AACA,YAAK,QAAL,CAAc,EAAE,aAAa,KAAf,EAAd;AACD,KAtBkB;;AAAA,UAwBnB,gBAxBmB,GAwBA,UAAC,KAAD,EAAW;AAAA,UACpB,QADoB,GACP,MAAK,KADE,CACpB,QADoB;AAAA,UAEpB,QAFoB,GAEP,MAAK,KAFE,CAEpB,QAFoB;;;AAI5B,kBAAY,SAAS,WAAW,IAApB,EAA0B,MAAM,MAAhC,CAAZ,C;AACD,KA7BkB;;AAAA,UA+BnB,iBA/BmB,GA+BC,YAAM;AACxB,YAAK,QAAL,CAAc,KAAd;AACA,YAAK,QAAL,CAAc,EAAE,aAAa,IAAf,EAAd;AACD,KAlCkB;;AAAA,UAoCnB,oBApCmB,GAoCI,UAAC,KAAD;AAAA,aAAW,MAAK,QAAL,CAAc,EAAE,UAAU,MAAM,MAAN,CAAa,OAAb,CAAqB,CAArB,CAAZ,EAAd,CAAX;AAAA,KApCJ;;AAGjB,UAAK,KAAL,GAAa;AACX,mBAAa;AADF,KAAb;;AAIA,QAAI,oBAAJ,EAA0B;AACxB,YAAK,QAAL,GAAgB,4BAAhB;AACA,YAAK,QAAL,CAAc,gBAAd,CAA+B,UAA/B,EAA2C,MAAK,oBAAhD;AACA,YAAK,QAAL,CAAc,gBAAd,CAA+B,aAA/B,EAA8C,MAAK,iBAAnD;AACA,YAAK,QAAL,CAAc,gBAAd,CAA+B,eAA/B,EAAgD,MAAK,gBAArD;AACD;AAZgB;AAalB;;0BAyBD,M,qBAAS;AACP,QAAI,oBAAJ,EAA0B;AAAA,mBACU,KAAK,KADf;AAAA,UAChB,WADgB,UAChB,WADgB;AAAA,UACH,QADG,UACH,QADG;;;AAGxB,UAAM,yBAAyB,0BAAW,gBAAX,EAA6B;AAC1D,qCAA6B;AAD6B,OAA7B,CAA/B;;AAIA,aACE;AAAA;QAAA,EAAK,WAAW,sBAAhB;QACE;AAAA;UAAA,EAAG,WAAU,qBAAb;AACG,yBAAa,KAAK,iBADrB;AAEG,uBAAW,KAAK,gBAFnB;UAAA;AAAA,SADF;QAIE;AAAA;UAAA,EAAK,WAAU,UAAf;UACE;AAAA;YAAA,EAAK,WAAU,8BAAf;YAAA;YACiC;AADjC;AADF;AAJF,OADF;AAYD,KAnBD,MAmBO;AACL,aAAO,IAAP;AACD;AACF,G;;;;;AAlEG,a,CACG,S,GAAY;AACjB,YAAU,iBAAU,IAAV,CAAe;AADR,C;kBAoEN,a","file":"VoiceRecorder.react.js","sourcesContent":["/*\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport classnames from 'classnames';\nimport Recorder from 'opus-recorder';\n\nlet isRecordingSupported = Recorder.isRecordingSupported() ? true : false;\nconsole.debug('isRecordingSupported', isRecordingSupported);\n\nclass VoiceRecorder extends Component {\n  static propTypes = {\n    onFinish: PropTypes.func.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isRecording: false\n    };\n\n    if (isRecordingSupported) {\n      this.recorder = new Recorder();\n      this.recorder.addEventListener('duration', this.handleChangeDuration);\n      this.recorder.addEventListener('streamReady', this.handleStreamReady);\n      this.recorder.addEventListener('dataAvailable', this.handleSendRecord);\n    }\n  }\n\n  handleStartRecord = () => {\n    this.recorder.initStream();\n  };\n\n  handleStopRecord = () => {\n    this.recorder.stop();\n    this.setState({ isRecording: false });\n  };\n\n  handleSendRecord = (event) => {\n    const { onFinish } = this.props;\n    const { duration } = this.state;\n\n    onFinish && onFinish(duration * 1000, event.detail); //Duration must be in ms\n  };\n\n  handleStreamReady = () => {\n    this.recorder.start();\n    this.setState({ isRecording: true });\n  };\n\n  handleChangeDuration = (event) => this.setState({ duration: event.detail.toFixed(2) });\n\n  render() {\n    if (isRecordingSupported) {\n      const { isRecording, duration } = this.state;\n\n      const voiceRecorderClassName = classnames('voice-recorder', {\n        'voice-recorder--recording': isRecording\n      });\n\n      return (\n        <div className={voiceRecorderClassName}>\n          <i className=\"material-icons icon\"\n             onMouseDown={this.handleStartRecord}\n             onMouseUp={this.handleStopRecord}>mic</i>\n          <div className=\"duration\">\n            <div className=\"fill row middle-xs center-xs\">\n              Voice message duration:&nbsp; {duration}\n            </div>\n          </div>\n        </div>\n      );\n    } else {\n      return null;\n    }\n  }\n}\n\nexport default VoiceRecorder;\n"]}