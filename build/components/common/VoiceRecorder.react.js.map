{"version":3,"sources":["../../../src/components/common/VoiceRecorder.react.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQA,IAAI,oBAAoB,GAAG,uBAAS,oBAAoB,EAAE,GAAG,IAAI,GAAG,KAAK,CAAC;AAC1E,OAAO,CAAC,KAAK,CAAC,sBAAsB,EAAE,oBAAoB,CAAC,CAAC;;IAEtD,aAAa;YAAb,aAAa;;AAKjB,WALI,aAAa,CAKL,KAAK,EAAE;0BALf,aAAa;;uEAAb,aAAa,aAMT,KAAK;;UAcb,iBAAiB,GAAG,YAAM;AACxB,YAAK,QAAQ,CAAC,UAAU,EAAE,CAAC;KAC5B;;UAED,gBAAgB,GAAG,YAAM;AACvB,YAAK,QAAQ,CAAC,IAAI,EAAE,CAAC;AACrB,YAAK,QAAQ,CAAC,EAAC,WAAW,EAAE,KAAK,EAAC,CAAC,CAAC;KACrC;;UAED,gBAAgB,GAAG,UAAC,KAAK,EAAK;UACpB,QAAQ,GAAK,MAAK,KAAK,CAAvB,QAAQ;UACR,QAAQ,GAAK,MAAK,KAAK,CAAvB,QAAQ;;AAEhB,cAAQ,IAAI,QAAQ,CAAC,QAAQ,GAAG,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC;AAAC,KACrD;;UAED,iBAAiB,GAAG,YAAM;AACxB,YAAK,QAAQ,CAAC,KAAK,EAAE,CAAC;AACtB,YAAK,QAAQ,CAAC,EAAC,WAAW,EAAE,IAAI,EAAC,CAAC,CAAC;KACpC;;UAED,oBAAoB,GAAG,UAAC,KAAK;aAAK,MAAK,QAAQ,CAAC,EAAC,QAAQ,EAAE,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,EAAC,CAAC;KAAA;;AAjClF,UAAK,KAAK,GAAG;AACX,iBAAW,EAAE,KAAK;KACnB,CAAC;;AAEF,QAAI,oBAAoB,EAAE;AACxB,YAAK,QAAQ,GAAG,4BAAc,CAAC;AAC/B,YAAK,QAAQ,CAAC,gBAAgB,CAAC,UAAU,EAAE,MAAK,oBAAoB,CAAC,CAAC;AACtE,YAAK,QAAQ,CAAC,gBAAgB,CAAC,aAAa,EAAE,MAAK,iBAAiB,CAAC,CAAC;AACtE,YAAK,QAAQ,CAAC,gBAAgB,CAAC,eAAe,EAAE,MAAK,gBAAgB,CAAC,CAAC;KACxE;;GACF;;eAlBG,aAAa;;6BA2CR;AACP,UAAI,oBAAoB,EAAE;qBACQ,IAAI,CAAC,KAAK;YAAnC,WAAW,UAAX,WAAW;YAAE,QAAQ,UAAR,QAAQ;;AAE5B,YAAM,sBAAsB,GAAG,0BAAW,gBAAgB,EAAE;AAC1D,qCAA2B,EAAE,WAAW;SACzC,CAAC,CAAC;;AAEH,eACE;;YAAK,SAAS,EAAE,sBAAsB,AAAC;UACrC;;cAAG,SAAS,EAAC,qBAAqB;AAC/B,yBAAW,EAAE,IAAI,CAAC,iBAAiB,AAAC;AACpC,uBAAS,EAAE,IAAI,CAAC,gBAAgB,AAAC;;WAAQ;UAC5C;;cAAK,SAAS,EAAC,UAAU;YACvB;;gBAAK,SAAS,EAAC,8BAA8B;;cACZ,QAAQ;aACnC;WACF;SACF,CACN;OACH,MAAM;AACL,eAAO,IAAI,CAAC;OACb;KACF;;;SAlEG,aAAa;;;AAAb,aAAa,CACV,SAAS,GAAG;AACjB,UAAQ,EAAE,iBAAU,IAAI,CAAC,UAAU;CACpC;kBAkEY,aAAa","file":"VoiceRecorder.react.js","sourcesContent":["/*\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport classnames from 'classnames';\nimport Recorder from 'opus-recorder';\n\nlet isRecordingSupported = Recorder.isRecordingSupported() ? true : false;\nconsole.debug('isRecordingSupported', isRecordingSupported);\n\nclass VoiceRecorder extends Component {\n  static propTypes = {\n    onFinish: PropTypes.func.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isRecording: false\n    };\n\n    if (isRecordingSupported) {\n      this.recorder = new Recorder();\n      this.recorder.addEventListener('duration', this.handleChangeDuration);\n      this.recorder.addEventListener('streamReady', this.handleStreamReady);\n      this.recorder.addEventListener('dataAvailable', this.handleSendRecord);\n    }\n  }\n\n  handleStartRecord = () => {\n    this.recorder.initStream();\n  };\n\n  handleStopRecord = () => {\n    this.recorder.stop();\n    this.setState({isRecording: false});\n  };\n\n  handleSendRecord = (event) => {\n    const { onFinish } = this.props;\n    const { duration } = this.state;\n\n    onFinish && onFinish(duration * 1000, event.detail); //Duration must be in ms\n  };\n\n  handleStreamReady = () => {\n    this.recorder.start();\n    this.setState({isRecording: true});\n  };\n\n  handleChangeDuration = (event) => this.setState({duration: event.detail.toFixed(2)});\n\n  render() {\n    if (isRecordingSupported) {\n      const {isRecording, duration} = this.state;\n\n      const voiceRecorderClassName = classnames('voice-recorder', {\n        'voice-recorder--recording': isRecording\n      });\n\n      return (\n        <div className={voiceRecorderClassName}>\n          <i className=\"material-icons icon\"\n             onMouseDown={this.handleStartRecord}\n             onMouseUp={this.handleStopRecord}>mic</i>\n          <div className=\"duration\">\n            <div className=\"fill row middle-xs center-xs\">\n              Voice message duration:&nbsp; {duration}\n            </div>\n          </div>\n        </div>\n      );\n    } else {\n      return null;\n    }\n  }\n}\n\nexport default VoiceRecorder;\n"]}