{"version":3,"sources":["../../../src/components/common/DropZone.react.js"],"names":[],"mappings":"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","file":"DropZone.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport EventListener from 'fbjs/lib/EventListener';\nimport classnames from 'classnames';\n\nclass DropZone extends Component {\n  static propTypes = {\n    children: PropTypes.node.isRequired,\n    onDropComplete: PropTypes.func.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.windowDragging = false;\n    this.zoneDragging = false;\n\n    this.state = {\n      isActive: false,\n      isHovered: false\n    };\n\n    this.onWindowDrop = this.onWindowDrop.bind(this);\n    this.onWindowDragEnter = this.onWindowDragEnter.bind(this);\n    this.onWindowDragOver = this.onWindowDragOver.bind(this);\n    this.onWindowDragLeave = this.onWindowDragLeave.bind(this);\n\n    this.onDrop = this.onDrop.bind(this);\n    this.onDragEnter = this.onDragEnter.bind(this);\n    this.onDragOver = this.onDragOver.bind(this);\n    this.onDragLeave = this.onDragLeave.bind(this);\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    return nextState.isActive !== this.state.isActive ||\n           nextState.isHovered !== this.state.isHovered;\n  }\n\n  componentDidMount() {\n    this.listeners = [\n      EventListener.listen(window, 'drop', this.onWindowDrop),\n      EventListener.listen(window, 'dragenter', this.onWindowDragEnter),\n      EventListener.listen(window, 'dragover', this.onWindowDragOver),\n      EventListener.listen(window, 'dragleave', this.onWindowDragLeave)\n    ];\n  }\n\n  componentWillUnmount() {\n    this.listeners.forEach((listener) => {\n      listener.remove();\n    });\n\n    this.listeners = null;\n  }\n\n  onWindowDrop(event) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.setState({ isActive: false, isHovered: false });\n  }\n\n  onWindowDragEnter() {\n    this.windowDragging = true;\n    clearTimeout(this.windowTimeout);\n\n    if (this.state.isActive) {\n      return;\n    }\n\n    this.setState({ isActive: true });\n  }\n\n  onWindowDragOver(event) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.windowDragging = true;\n    clearTimeout(this.windowTimeout);\n  }\n\n  onWindowDragLeave() {\n    this.windowDragging = false;\n    clearTimeout(this.windowTimeout);\n\n    this.windowTimeout = setTimeout(() => {\n      if (!this.windowDragging) {\n        this.setState({ isActive: false });\n      }\n    }, 60);\n  }\n\n  onDrop(event) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.onDragLeave();\n    this.onWindowDragLeave();\n    this.props.onDropComplete(event.dataTransfer.files);\n  }\n\n  onDragEnter() {\n    this.zoneDragging = true;\n    this.windowDragging = true;\n    clearTimeout(this.zoneTimeout);\n    clearTimeout(this.windowTimeout);\n\n    if (this.state.isHovered) {\n      return;\n    }\n\n    this.setState({ isHovered: true });\n  }\n\n  onDragOver(event) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.zoneDragging = true;\n    this.windowDragging = true;\n    clearTimeout(this.zoneTimeout);\n    clearTimeout(this.windowTimeout);\n\n    // Makes it possible to drag files from chrome's download bar\n    // http://stackoverflow.com/questions/19526430/drag-and-drop-file-uploads-from-chrome-downloads-bar\n    try {\n      const effect = event.dataTransfer.effectAllowed;\n      if (effect === 'move' || effect === 'linkMove') {\n        event.dataTransfer.dropEffect = 'move';\n      } else {\n        event.dataTransfer.dropEffect = 'copy';\n      }\n    } catch (e) {\n      // do nothing\n    }\n  }\n\n  onDragLeave() {\n    this.zoneDragging = false;\n    clearTimeout(this.zoneTimeout);\n\n    this.zoneTimeout = setTimeout(() => {\n      if (!this.zoneDragging) {\n        this.setState({ isHovered: false });\n      }\n    }, 60);\n  }\n\n  render() {\n    const { isActive, isHovered } = this.state;\n\n    if (!isActive) {\n      return null;\n    }\n\n    const className = classnames('dropzone', {\n      'dropzone--hover': isHovered\n    });\n\n    return (\n      <div\n        className={className}\n        onDrop={this.onDrop}\n        onDragOver={this.onDragOver}\n        onDragEnter={this.onDragEnter}\n        onDragLeave={this.onDragLeave}\n      >\n        {this.props.children}\n      </div>\n    );\n  }\n}\n\nexport default DropZone;\n"]}