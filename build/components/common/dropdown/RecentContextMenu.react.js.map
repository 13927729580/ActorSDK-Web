{"version":3,"sources":["../../../../src/components/common/dropdown/RecentContextMenu.react.js"],"names":[],"mappings":"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","file":"RecentContextMenu.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport ReactMixin from 'react-mixin';\nimport PureRenderMixin from 'react-addons-pure-render-mixin';\nimport isInside from '../../../utils/isInside';\nimport confirm from '../../../utils/confirm';\n\nimport DialogStore from '../../../stores/DialogStore';\n\nimport ArchiveActionCreators from '../../../actions/ArchiveActionCreators';\nimport FavoriteActionCreators from '../../../actions/FavoriteActionCreators';\nimport DropdownActionCreators from '../../../actions/DropdownActionCreators';\nimport DialogActionCreators from '../../../actions/DialogActionCreators';\n\nclass RecentContextMenu extends Component {\n  static propTypes = {\n    peer: PropTypes.object.isRequired,\n    contextPos: PropTypes.object.isRequired,\n    hideOnScroll: PropTypes.bool.isRequired\n  };\n\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n\n    document.addEventListener('click', this.handleDocumentClick, true);\n    document.addEventListener('contextmenu', this.handleClose, true);\n\n    if (props.hideOnScroll) {\n      document.addEventListener('scroll', this.handleClose, true);\n    }\n  }\n\n  componentWillUnmount() {\n    const { hideOnScroll } = this.props;\n    document.removeEventListener('click', this.handleDocumentClick, true);\n    document.removeEventListener('contextmenu', this.handleClose, true);\n\n    if (hideOnScroll) {\n      document.removeEventListener('scroll', this.handleClose, true);\n    }\n  }\n\n  handleDocumentClick = (event) => {\n    const menu = findDOMNode(this.refs.menu);\n    const menuRect = menu.getBoundingClientRect();\n    const coords = {\n      x: event.pageX || event.clientX,\n      y: event.pageY || event.clientY\n    };\n\n    if (!isInside(coords, menuRect)) {\n      // event.preventDefault();\n      this.handleClose();\n    }\n  };\n\n  handleClose = () => DropdownActionCreators.hideRecentContext();\n\n  handleAddToArchive = (event) => {\n    const { peer } = this.props;\n    ArchiveActionCreators.archiveChat(peer);\n    this.handleClose();\n  };\n\n  handleFavorite = (event) => {\n    const { peer } = this.props;\n    FavoriteActionCreators.favoriteChat(peer);\n    this.handleClose();\n  };\n\n  handleUnfavorite = (event) => {\n    const { peer } = this.props;\n    FavoriteActionCreators.unfavoriteChat(peer);\n    this.handleClose();\n  };\n\n  handleDelete = (event) => {\n    const { intl } = this.context;\n    const { peer } = this.props;\n    confirm(intl.messages['modal.confirm.delete']).then(\n      () => DialogActionCreators.deleteChat(peer),\n      () => {}\n    );\n  };\n\n  render() {\n    const { peer, contextPos } = this.props;\n    const isFavorite = DialogStore.isFavorite(peer.id);\n\n    const dropdownStyles = {\n      top: contextPos.y,\n      left: contextPos.x\n    };\n\n    const dropdownMenuStyles = {\n      minWidth: 140,\n      left: 2,\n      top: 2\n    };\n\n    return (\n      <div className=\"dropdown dropdown--opened dropdown--small\" style={dropdownStyles}>\n        <ul className=\"dropdown__menu dropdown__menu--left\" ref=\"menu\" style={dropdownMenuStyles}>\n          {\n            isFavorite\n              ? <li className=\"dropdown__menu__item\" onClick={this.handleUnfavorite}>\n                  <i className=\"icon material-icons\">star_border</i> Unfavorite\n                </li>\n              : <li className=\"dropdown__menu__item\" onClick={this.handleFavorite}>\n                  <i className=\"icon material-icons\">star</i> Favorite\n                </li>\n          }\n          <li className=\"dropdown__menu__item\" onClick={this.handleAddToArchive}>\n            <i className=\"icon material-icons\">archive</i> Send to archive\n          </li>\n          <li className=\"dropdown__menu__item\" onClick={this.handleDelete}>\n            <i className=\"icon material-icons\">delete</i> Delete\n          </li>\n        </ul>\n      </div>\n    );\n  }\n}\n\nReactMixin.onClass(RecentContextMenu, PureRenderMixin);\n\nexport default RecentContextMenu;\n"]}