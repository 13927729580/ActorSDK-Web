{"version":3,"sources":["../../../../src/components/common/dropdown/RecentContextMenu.react.js"],"names":[],"mappings":"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","file":"RecentContextMenu.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport ReactMixin from 'react-mixin';\nimport PureRenderMixin from 'react-addons-pure-render-mixin';\nimport { FormattedMessage } from 'react-intl';\nimport isInside from '../../../utils/isInside';\nimport confirm from '../../../utils/confirm';\n\nimport DialogStore from '../../../stores/DialogStore';\n\nimport ArchiveActionCreators from '../../../actions/ArchiveActionCreators';\nimport FavoriteActionCreators from '../../../actions/FavoriteActionCreators';\nimport DropdownActionCreators from '../../../actions/DropdownActionCreators';\nimport DialogActionCreators from '../../../actions/DialogActionCreators';\n\nclass RecentContextMenu extends Component {\n  static propTypes = {\n    peer: PropTypes.object.isRequired,\n    contextPos: PropTypes.object.isRequired,\n    hideOnScroll: PropTypes.bool.isRequired\n  };\n\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n\n    document.addEventListener('click', this.handleDocumentClick, true);\n    document.addEventListener('contextmenu', this.handleClose, true);\n\n    if (props.hideOnScroll) {\n      document.addEventListener('scroll', this.handleClose, true);\n    }\n  }\n\n  componentWillUnmount() {\n    const { hideOnScroll } = this.props;\n    document.removeEventListener('click', this.handleDocumentClick, true);\n    document.removeEventListener('contextmenu', this.handleClose, true);\n\n    if (hideOnScroll) {\n      document.removeEventListener('scroll', this.handleClose, true);\n    }\n  }\n\n  handleDocumentClick = (event) => {\n    const menu = findDOMNode(this.refs.menu);\n    const menuRect = menu.getBoundingClientRect();\n    const coords = {\n      x: event.pageX || event.clientX,\n      y: event.pageY || event.clientY\n    };\n\n    if (!isInside(coords, menuRect)) {\n      // event.preventDefault();\n      this.handleClose();\n    }\n  };\n\n  handleClose = () => DropdownActionCreators.hideRecentContext();\n\n  handleAddToArchive = () => {\n    const { peer } = this.props;\n    ArchiveActionCreators.archiveChat(peer);\n    this.handleClose();\n  };\n\n  handleFavorite = () => {\n    const { peer } = this.props;\n    FavoriteActionCreators.favoriteChat(peer);\n    this.handleClose();\n  };\n\n  handleUnfavorite = () => {\n    const { peer } = this.props;\n    FavoriteActionCreators.unfavoriteChat(peer);\n    this.handleClose();\n  };\n\n  handleDelete = () => {\n    const { intl } = this.context;\n    const { peer } = this.props;\n    confirm(intl.messages['modal.confirm.delete']).then(\n      () => DialogActionCreators.deleteChat(peer),\n      () => {}\n    );\n  };\n\n  render() {\n    const { peer, contextPos } = this.props;\n    const isFavorite = DialogStore.isFavorite(peer.id);\n\n    const dropdownStyles = {\n      top: contextPos.y,\n      left: contextPos.x\n    };\n\n    const dropdownMenuStyles = {\n      minWidth: 140,\n      left: 2,\n      top: 2\n    };\n\n    return (\n      <div className=\"dropdown dropdown--opened dropdown--small\" style={dropdownStyles}>\n        <ul className=\"dropdown__menu dropdown__menu--left\" ref=\"menu\" style={dropdownMenuStyles}>\n          {\n            isFavorite\n              ? <li className=\"dropdown__menu__item\" onClick={this.handleUnfavorite}>\n                  <i className=\"icon material-icons\">star_border</i> <FormattedMessage id=\"context.favorite.remove\"/>\n                </li>\n              : <li className=\"dropdown__menu__item\" onClick={this.handleFavorite}>\n                  <i className=\"icon material-icons\">star</i> <FormattedMessage id=\"context.favorite.add\"/>\n                </li>\n          }\n          <li className=\"dropdown__menu__item\" onClick={this.handleAddToArchive}>\n            <i className=\"icon material-icons\">archive</i> <FormattedMessage id=\"context.archive\"/>\n          </li>\n          <li className=\"dropdown__menu__item\" onClick={this.handleDelete}>\n            <i className=\"icon material-icons\">delete</i> <FormattedMessage id=\"context.delete\"/>\n          </li>\n        </ul>\n      </div>\n    );\n  }\n}\n\nReactMixin.onClass(RecentContextMenu, PureRenderMixin);\n\nexport default RecentContextMenu;\n"]}