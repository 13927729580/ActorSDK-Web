{"version":3,"sources":["../../../../src/components/common/dropdown/RecentContextMenu.react.js"],"names":[],"mappings":"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","file":"RecentContextMenu.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport EventListener from 'fbjs/lib/EventListener';\nimport { findDOMNode } from 'react-dom';\nimport { shouldComponentUpdate } from 'react-addons-pure-render-mixin';\nimport { FormattedMessage } from 'react-intl';\nimport isInside from '../../../utils/isInside';\nimport confirm from '../../../utils/confirm';\n\nimport DialogStore from '../../../stores/DialogStore';\n\nimport ArchiveActionCreators from '../../../actions/ArchiveActionCreators';\nimport FavoriteActionCreators from '../../../actions/FavoriteActionCreators';\nimport DropdownActionCreators from '../../../actions/DropdownActionCreators';\nimport DialogActionCreators from '../../../actions/DialogActionCreators';\n\nclass RecentContextMenu extends Component {\n  static propTypes = {\n    peer: PropTypes.object.isRequired,\n    contextPos: PropTypes.object.isRequired\n  };\n\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.shouldComponentUpdate = shouldComponentUpdate.bind(this);\n  }\n\n  componentDidMount() {\n    this.listeners = [\n      EventListener.capture(document, 'click', this.handleDocumentClick),\n      EventListener.capture(document, 'contextmenu', this.handleClose),\n      EventListener.capture(document, 'scroll', this.handleClose)\n    ];\n  }\n\n  componentWillUnmount() {\n    this.listeners.forEach((listener) => {\n      listener.remove();\n    });\n\n    this.listeners = null;\n  }\n\n  handleDocumentClick = (event) => {\n    const menu = findDOMNode(this.refs.menu);\n    const menuRect = menu.getBoundingClientRect();\n    const coords = {\n      x: event.pageX || event.clientX,\n      y: event.pageY || event.clientY\n    };\n\n    if (!isInside(coords, menuRect)) {\n      // event.preventDefault();\n      this.handleClose();\n    }\n  };\n\n  handleClose = () => DropdownActionCreators.hideRecentContext();\n\n  handleAddToArchive = () => {\n    const { peer } = this.props;\n    ArchiveActionCreators.archiveChat(peer);\n    this.handleClose();\n  };\n\n  handleFavorite = () => {\n    const { peer } = this.props;\n    FavoriteActionCreators.favoriteChat(peer);\n    this.handleClose();\n  };\n\n  handleUnfavorite = () => {\n    const { peer } = this.props;\n    FavoriteActionCreators.unfavoriteChat(peer);\n    this.handleClose();\n  };\n\n  handleDelete = () => {\n    const { peer } = this.props;\n    confirm(<FormattedMessage id=\"modal.confirm.delete\"/>).then(\n      () => DialogActionCreators.deleteChat(peer),\n      () => {}\n    );\n  };\n\n  render() {\n    const { peer, contextPos } = this.props;\n    const isFavorite = DialogStore.isFavorite(peer.id);\n\n    const dropdownStyles = {\n      top: contextPos.y,\n      left: contextPos.x\n    };\n\n    const dropdownMenuStyles = {\n      minWidth: 140,\n      left: 2,\n      top: 2\n    };\n\n    return (\n      <div className=\"dropdown dropdown--opened dropdown--small\" style={dropdownStyles}>\n        <ul className=\"dropdown__menu dropdown__menu--left\" ref=\"menu\" style={dropdownMenuStyles}>\n          {\n            isFavorite\n              ? <li className=\"dropdown__menu__item\" onClick={this.handleUnfavorite}>\n                  <i className=\"icon material-icons\">star_border</i> <FormattedMessage id=\"context.favorite.remove\"/>\n                </li>\n              : <li className=\"dropdown__menu__item\" onClick={this.handleFavorite}>\n                  <i className=\"icon material-icons\">star</i> <FormattedMessage id=\"context.favorite.add\"/>\n                </li>\n          }\n          <li className=\"dropdown__menu__item\" onClick={this.handleAddToArchive}>\n            <i className=\"icon material-icons\">archive</i> <FormattedMessage id=\"context.archive\"/>\n          </li>\n          <li className=\"dropdown__menu__item\" onClick={this.handleDelete}>\n            <i className=\"icon material-icons\">delete</i> <FormattedMessage id=\"context.delete\"/>\n          </li>\n        </ul>\n      </div>\n    );\n  }\n}\n\nexport default RecentContextMenu;\n"]}