{"version":3,"sources":["../../../../src/components/common/dropdown/MessageActions.react.js"],"names":[],"mappings":"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","file":"MessageActions.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport EventListener from 'fbjs/lib/EventListener';\nimport { findDOMNode } from 'react-dom';\nimport { shouldComponentUpdate } from 'react-addons-pure-render-mixin';\n\nimport isInside from '../../../utils/isInside';\nimport { quoteMessage } from '../../../utils/MessageUtils';\n\nimport { MessageContentTypes } from '../../../constants/ActorAppConstants';\n\nimport MessageActionCreators from '../../../actions/MessageActionCreators';\nimport ComposeActionCreators from '../../../actions/ComposeActionCreators';\nimport DropdownActionCreators from '../../../actions/DropdownActionCreators';\n\nimport UserStore from '../../../stores/UserStore';\n\nclass MessageActions extends Component {\n  static propTypes = {\n    peer: PropTypes.object.isRequired,\n    message: PropTypes.object.isRequired,\n    targetRect: PropTypes.object.isRequired\n  };\n\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.shouldComponentUpdate = shouldComponentUpdate.bind(this);\n  }\n\n  componentDidMount() {\n    this.listeners = [\n      EventListener.listen(document, 'click', this.handleDocumentClick),\n      EventListener.listen(document, 'scroll', this.handleDropdownClose)\n    ];\n  }\n\n  componentWillUnmount() {\n    this.listeners.forEach((listener) => {\n      listener.remove();\n    });\n\n    this.listeners = null;\n  }\n\n  handleDocumentClick = (event) => {\n    const dropdown = findDOMNode(this.refs.dropdown);\n    const dropdownRect = dropdown.getBoundingClientRect();\n    const coords = {\n      x: event.pageX || event.clientX,\n      y: event.pageY || event.clientY\n    };\n\n    if (!isInside(coords, dropdownRect)) {\n      event.preventDefault();\n      this.handleDropdownClose();\n    }\n  };\n\n\n  handleDropdownClose = () => DropdownActionCreators.hideMessageDropdown();\n\n  handleDelete = () => {\n    const { peer, message } = this.props;\n    MessageActionCreators.deleteMessage(peer, message.rid);\n    this.handleDropdownClose();\n  };\n\n  handleReply = () => {\n    const { message } = this.props;\n    const info = UserStore.getUser(message.sender.peer.id);\n    const replyText = info.nick ? `@${info.nick}: ` : `${info.name}: `;\n    ComposeActionCreators.pasteText(replyText);\n    this.handleDropdownClose();\n  };\n\n  handleQuote = () => {\n    const { message } = this.props;\n    ComposeActionCreators.pasteText(quoteMessage(message.content.text) + '\\n');\n    this.handleDropdownClose();\n  };\n\n  render() {\n    const { message, targetRect } = this.props;\n    const { intl } = this.context;\n\n    const isThisMyMessage = UserStore.getMyId() === message.sender.peer.id;\n\n    const dropdownStyles = {\n      top: targetRect.top,\n      left: targetRect.left\n    };\n\n    const dropdownMenuStyles = {\n      minWidth: 120,\n      right: 2,\n      top: -4\n    };\n\n    return (\n      <div className=\"dropdown dropdown--opened dropdown--small\" style={dropdownStyles}>\n        <ul className=\"dropdown__menu dropdown__menu--right\" ref=\"dropdown\" style={dropdownMenuStyles}>\n          <li className=\"dropdown__menu__item hide\">\n            <i className=\"icon material-icons\">star_rate</i> {intl.messages['message.pin']}\n          </li>\n          {\n            !isThisMyMessage\n              ? <li className=\"dropdown__menu__item\" onClick={this.handleReply}>\n                  <i className=\"icon material-icons\">reply</i> {intl.messages['message.reply']}\n                </li>\n              : null\n          }\n          {\n            message.content.content === MessageContentTypes.TEXT\n              ? <li className=\"dropdown__menu__item\" onClick={this.handleQuote}>\n                  <i className=\"icon material-icons\">format_quote</i> {intl.messages['message.quote']}\n                </li>\n              : null\n          }\n          <li className=\"dropdown__menu__item hide\">\n            <i className=\"icon material-icons\">forward</i> {intl.messages['message.forward']}\n          </li>\n          <li className=\"dropdown__menu__item\" onClick={this.handleDelete}>\n            <i className=\"icon material-icons\">delete</i> {intl.messages['message.delete']}\n          </li>\n        </ul>\n      </div>\n    );\n  }\n}\n\nexport default MessageActions;\n"]}