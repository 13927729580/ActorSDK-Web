{"version":3,"sources":["../../../../src/components/common/dropdown/MessageActions.react.js"],"names":[],"mappings":"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","file":"MessageActions.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport ReactMixin from 'react-mixin';\nimport PureRenderMixin from 'react-addons-pure-render-mixin';\nimport isInside from '../../../utils/isInside';\n\nimport { MessageContentTypes } from '../../../constants/ActorAppConstants';\n\nimport MessageActionCreators from '../../../actions/MessageActionCreators';\nimport ComposeActionCreators from '../../../actions/ComposeActionCreators';\nimport DropdownActionCreators from '../../../actions/DropdownActionCreators';\n\nimport UserStore from '../../../stores/UserStore';\n\nclass MessageActions extends Component {\n  static propTypes = {\n    peer: PropTypes.object.isRequired,\n    message: PropTypes.object.isRequired,\n    targetRect: PropTypes.object.isRequired,\n    hideOnScroll: PropTypes.bool.isRequired\n  };\n\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n    document.addEventListener('click', this.handleDocumentClick, true);\n\n    if (props.hideOnScroll) {\n      document.addEventListener('scroll', this.handleDropdownClose, true);\n    }\n  }\n\n  componentWillUnmount() {\n    const { hideOnScroll } = this.props;\n    document.removeEventListener('click', this.handleDocumentClick, true);\n\n    if (hideOnScroll) {\n      document.removeEventListener('scroll', this.handleDropdownClose, true);\n    }\n  }\n\n  handleDocumentClick = (event) => {\n    const dropdown = findDOMNode(this.refs.dropdown);\n    const dropdownRect = dropdown.getBoundingClientRect();\n    const coords = {\n      x: event.pageX || event.clientX,\n      y: event.pageY || event.clientY\n    };\n\n    if (!isInside(coords, dropdownRect)) {\n      event.preventDefault();\n      this.handleDropdownClose();\n    }\n  };\n\n\n  handleDropdownClose = () => DropdownActionCreators.hide();\n\n  handleDelete = () => {\n    const { peer, message } = this.props;\n    MessageActionCreators.deleteMessage(peer, message.rid);\n    this.handleDropdownClose();\n  };\n\n  handleReply = () => {\n    const { message } = this.props;\n    const info = UserStore.getUser(message.sender.peer.id);\n    const replyText = info.nick ? `@${info.nick}: ` : `${info.name}: `;\n    ComposeActionCreators.pasteText(replyText);\n    this.handleDropdownClose();\n  };\n\n  handleQuote = () => {\n    const { message } = this.props;\n    ComposeActionCreators.pasteText(`> ${message.content.text} \\n`);\n    this.handleDropdownClose();\n  };\n\n  render() {\n    const { message, targetRect } = this.props;\n    const { intl } = this.context;\n\n    const isThisMyMessage = UserStore.getMyId() === message.sender.peer.id;\n\n    const dropdownStyles = {\n      top: targetRect.top,\n      left: targetRect.left\n    };\n\n    const dropdownMenuStyles = {\n      minWidth: 120,\n      right: 2,\n      top: -4\n    };\n\n    return (\n      <div className=\"dropdown dropdown--opened dropdown--small\" style={dropdownStyles}>\n        <ul className=\"dropdown__menu dropdown__menu--right\" ref=\"dropdown\" style={dropdownMenuStyles}>\n          <li className=\"dropdown__menu__item hide\">\n            <i className=\"icon material-icons\">star_rate</i> {intl.messages['message.pin']}\n          </li>\n          {\n            !isThisMyMessage\n              ? <li className=\"dropdown__menu__item\" onClick={this.handleReply}>\n                  <i className=\"icon material-icons\">reply</i> {intl.messages['message.reply']}\n                </li>\n              : null\n          }\n          {\n            message.content.content === MessageContentTypes.TEXT\n              ? <li className=\"dropdown__menu__item\" onClick={this.handleQuote}>\n                  <i className=\"icon material-icons\">format_quote</i> {intl.messages['message.quote']}\n                </li>\n              : null\n          }\n          <li className=\"dropdown__menu__item hide\">\n            <i className=\"icon material-icons\">forward</i> {intl.messages['message.forward']}\n          </li>\n          <li className=\"dropdown__menu__item\" onClick={this.handleDelete}>\n            <i className=\"icon material-icons\">delete</i> {intl.messages['message.delete']}\n          </li>\n        </ul>\n      </div>\n\n    );\n  }\n}\n\nReactMixin.onClass(MessageActions, PureRenderMixin);\n\nexport default MessageActions;\n"]}