{"version":3,"sources":["../../../../src/components/common/dropdown/MessageActions.react.js"],"names":[],"mappings":"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","file":"MessageActions.react.js","sourcesContent":["/*\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport ReactMixin from 'react-mixin';\nimport { IntlMixin } from 'react-intl'\nimport addons from 'react/addons';\nimport isInside from '../../../utils/isInside';\n\nimport { MessageContentTypes } from '../../../constants/ActorAppConstants';\n\nimport MessageActionCreators from '../../../actions/MessageActionCreators';\nimport ComposeActionCreators from '../../../actions/ComposeActionCreators';\nimport DropdownActionCreators from '../../../actions/DropdownActionCreators';\n\nimport UserStore from '../../../stores/UserStore';\n\nconst {addons: { PureRenderMixin }} = addons;\n\nclass MessageActions extends Component {\n  static propTypes = {\n    peer: PropTypes.object.isRequired,\n    message: PropTypes.object.isRequired,\n    targetRect: PropTypes.object.isRequired,\n    hideOnScroll: PropTypes.bool.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n    document.addEventListener('click', this.handleDocumentClick, true);\n\n    if (props.hideOnScroll) {\n      document.addEventListener('scroll', this.handleDropdownClose, true);\n    }\n  }\n\n  componentWillUnmount() {\n    const { hideOnScroll } = this.props;\n    document.removeEventListener('click', this.handleDocumentClick, true);\n\n    if (hideOnScroll) {\n      document.removeEventListener('scroll', this.handleDropdownClose, true);\n    }\n  }\n\n  handleDocumentClick = (event) => {\n    const dropdown = React.findDOMNode(this.refs.dropdown);\n    const dropdownRect = dropdown.getBoundingClientRect();\n    const coords = {\n      x: event.pageX || event.clientX,\n      y: event.pageY || event.clientY\n    };\n\n    if (!isInside(coords, dropdownRect)) {\n      event.preventDefault();\n      this.handleDropdownClose();\n    }\n  };\n\n\n  handleDropdownClose = () => DropdownActionCreators.hide();\n\n  handleDelete = () => {\n    const { peer, message } = this.props;\n    MessageActionCreators.deleteMessage(peer, message.rid);\n    this.handleDropdownClose();\n  };\n\n  handleReply = () => {\n    const { message } = this.props;\n    const info = UserStore.getUser(message.sender.peer.id);\n    const replyText = info.nick ? `@${info.nick}: ` : `${info.name}: `;\n    ComposeActionCreators.pasteText(replyText);\n    this.handleDropdownClose();\n  };\n\n  handleQuote = () => {\n    const { message } = this.props;\n    ComposeActionCreators.pasteText(`> ${message.content.text} \\n`);\n    this.handleDropdownClose();\n  };\n\n  render() {\n    const { message, targetRect } = this.props;\n    const isThisMyMessage = UserStore.getMyId() === message.sender.peer.id;\n\n    const dropdownStyles = {\n      top: targetRect.top,\n      left: targetRect.left\n    };\n\n    return (\n      <div className=\"dropdown dropdown--opened dropdown--small\" style={dropdownStyles}>\n        <ul className=\"dropdown__menu dropdown__menu--right\" ref=\"dropdown\" style={{minWidth: 120, right: 2, top: -4}}>\n          <li className=\"dropdown__menu__item hide\">\n            <i className=\"icon material-icons\">star_rate</i> {this.getIntlMessage('message.pin')}\n          </li>\n          {\n            !isThisMyMessage\n              ? <li className=\"dropdown__menu__item\" onClick={this.handleReply}>\n                  <i className=\"icon material-icons\">reply</i> {this.getIntlMessage('message.reply')}\n                </li>\n              : null\n          }\n          {\n            message.content.content === MessageContentTypes.TEXT\n              ? <li className=\"dropdown__menu__item\" onClick={this.handleQuote}>\n                  <i className=\"icon material-icons\">format_quote</i> {this.getIntlMessage('message.quote')}\n                </li>\n              : null\n          }\n          <li className=\"dropdown__menu__item hide\">\n            <i className=\"icon material-icons\">forward</i> {this.getIntlMessage('message.forward')}\n          </li>\n          <li className=\"dropdown__menu__item\" onClick={this.handleDelete}>\n            <i className=\"icon material-icons\">delete</i> {this.getIntlMessage('message.delete')}\n          </li>\n        </ul>\n      </div>\n\n    );\n  }\n}\n\nReactMixin.onClass(MessageActions, IntlMixin);\nReactMixin.onClass(MessageActions, PureRenderMixin);\n\nexport default MessageActions;\n"]}