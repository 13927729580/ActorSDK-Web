{"version":3,"sources":["../../../src/components/common/EmojiDropdown.react.js"],"names":[],"mappings":"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","file":"EmojiDropdown.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport { forEach } from 'lodash';\nimport React, { Component, PropTypes } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport { Container } from 'flux/utils';\nimport classnames from 'classnames';\nimport { KeyCodes } from '../../constants/ActorAppConstants';\nimport { emoji, getEmojiCategories } from '../../utils/EmojiUtils';\nimport isInside from '../../utils/isInside';\nimport EmojiActionCreators from '../../actions/EmojiActionCreators'\n\nimport EmojiStore from '../../stores/EmojiStore'\n\nimport { Element, Link } from 'react-scroll';\nimport Sticker from '../emoji_stickers/Sticker.react';\n\nlet emojiTabs = [];\nlet emojis = [];\nlet closeTimer;\nconst CLOSE_TIMEOUT = 550;\n\nclass EmojiDropdown extends Component {\n  static propTypes = {\n    onSelect: PropTypes.func.isRequired,\n    onStickerSelect: PropTypes.func.isRequired\n  };\n\n  static getStores() {\n    return [EmojiStore];\n  }\n\n  static calculateState() {\n    return EmojiStore.getState();\n  }\n\n  constructor(props) {\n    super(props);\n\n    const emojiCategories = getEmojiCategories();\n\n    forEach(emojiCategories, (category, index) => {\n      let currentCategoryEmojis = [];\n\n      emoji.change_replace_mode('css');\n      const categoryIcon = emoji.replace_colons(category.icon);\n\n      emojiTabs.push(\n        <Link to={category.title}\n              spy\n              offset={30}\n              duration={300}\n              key={index}\n              onSetActive={() => this.changeDropdownTitle(category.title)}\n              containerId=\"emojiContainer\"\n              onMouseEnter={this.handleEmojiTabMouseEnter}\n              className=\"emojis__header__tabs__tab\"\n              activeClass=\"emojis__header__tabs__tab--active\">\n          <span dangerouslySetInnerHTML={{__html: categoryIcon}}/>\n        </Link>\n      );\n\n      forEach(category.data, (emojiChar, index) => {\n        emoji.change_replace_mode('css');\n        const convertedChar = emoji.replace_unified(emojiChar);\n        emoji.colons_mode = true;\n        const emojiColon = emoji.replace_unified(emojiChar);\n        emoji.colons_mode = false;\n\n        currentCategoryEmojis.push(\n          <a onClick={() => this.onSelect(emojiColon)} key={index} dangerouslySetInnerHTML={{__html: convertedChar}}/>\n        );\n      });\n\n      emojis.push(\n        <Element name={category.title} key={index}>\n          <p>{category.title}</p>\n          {currentCategoryEmojis}\n        </Element>\n      );\n    });\n\n    this.handleEmojisTabMouseEnter = this.handleEmojisTabMouseEnter.bind(this);\n    this.handleStickerTabMouseEnter = this.handleStickerTabMouseEnter.bind(this);\n  }\n\n  componentWillUpdate(nextProps, nextState) {\n    const { isOpen } = nextState;\n    const emojiDropdown = findDOMNode(this.refs.emojiDropdown);\n\n    if (isOpen) {\n      emojiDropdown.addEventListener('mouseenter', this.handleEmojiMouseEnter, false);\n      emojiDropdown.addEventListener('mouseleave', this.handleEmojiMouseLeave, false);\n      document.addEventListener('click', this.onDocumentClick, false);\n      document.addEventListener('keydown', this.onKeyDown, false);\n    } else {\n      emojiDropdown.removeEventListener('mouseenter', this.handleEmojiMouseEnter, false);\n      emojiDropdown.removeEventListener('mouseleave', this.handleEmojiMouseLeave, false);\n      document.removeEventListener('click', this.onDocumentClick, false);\n      document.removeEventListener('keydown', this.onKeyDown, false);\n    }\n  }\n\n  onKeyDown = () => {\n    if (event.keyCode === KeyCodes.ESC) {\n      event.preventDefault();\n      this.handleClose();\n    }\n  };\n\n  handleClose = () => EmojiActionCreators.close();\n\n  onSelect = (emoji) => this.props.onSelect(emoji);\n\n  onDocumentClick = (event) => {\n    event.stopPropagation();\n    event.preventDefault();\n    if (!event.target.className.includes('emojis__header__tabs__tab')) {\n      const emojiDropdown = findDOMNode(this.refs.emojiDropdown);\n      const emojiRect = emojiDropdown.getBoundingClientRect();\n      const coords = {\n        x: event.pageX || event.clientX,\n        y: event.pageY || event.clientY\n      };\n\n      if (!isInside(coords, emojiRect)) {\n        this.handleClose();\n      }\n    }\n  };\n\n  changeDropdownTitle = (title) => this.setState({dropdownTitle: title});\n\n  handleEmojiTabMouseEnter = (event) => {\n    event.stopPropagation();\n    event.preventDefault();\n    event.target.click();\n  };\n\n  handleEmojiOpenerMouseEnter = () => {\n    this.handleEmojiMouseEnter();\n    localStorage.setItem('isEmojiOpenedBefore', true);\n    EmojiActionCreators.open();\n  };\n\n  handleEmojiMouseLeave = () => {\n    closeTimer = setTimeout(this.handleClose, CLOSE_TIMEOUT)\n  };\n\n  handleEmojiMouseEnter = () => {\n    clearTimeout(closeTimer);\n  };\n\n  handleEmojisTabMouseEnter() {\n    this.setState({isStickersOpen: false});\n  }\n  handleStickerTabMouseEnter() {\n    this.setState({isStickersOpen: true});\n  }\n\n  renderStickers() {\n    const { stickers } = this.state;\n    const { onStickerSelect } = this.props;\n    if (stickers.length === 0) return null;\n\n    return stickers.map((sticker, index) => (\n      <Sticker\n        sticker={sticker}\n        onClick={onStickerSelect}\n        key={index}\n      />\n    ));\n  }\n\n  render() {\n    const { isOpen, dropdownTitle, isStickersOpen } = this.state;\n    const isEmojiOpenedBefore = (localStorage.getItem('isEmojiOpenedBefore') === 'true') || false;\n\n    const emojiDropdownClassName = classnames('emoji-dropdown', {\n      'emoji-dropdown--opened': isOpen\n    });\n    const emojiOpenerClassName = classnames('emoji-opener material-icons', {\n      'emoji-opener--active': isOpen,\n      'emoji-opener--with-dot': !isEmojiOpenedBefore\n    });\n\n    const emojiTabClassName = classnames('emoji-dropdown__footer__tab', {\n      'emoji-dropdown__footer__tab--active': !isStickersOpen\n    });\n    const stickerTabClassName = classnames('emoji-dropdown__footer__tab', {\n      'emoji-dropdown__footer__tab--active': isStickersOpen\n    });\n\n    const emojisClassName = classnames('emojis', {\n      'hide': isStickersOpen\n    });\n    const stickersClassName = classnames('stickers', {\n      'hide': !isStickersOpen\n    });\n\n    return (\n      <div className={emojiDropdownClassName}>\n\n        <i className={emojiOpenerClassName}\n           onMouseEnter={this.handleEmojiOpenerMouseEnter}\n           onMouseLeave={this.handleEmojiMouseLeave}>insert_emoticon</i>\n\n\n        <div className=\"emoji-dropdown__wrapper\" ref=\"emojiDropdown\">\n          <div className=\"emoji-dropdown__body\">\n\n            <div className={emojisClassName}>\n              <header className=\"emojis__header\">\n                <p className=\"emojis__header__title\">{dropdownTitle || 'Emoji'}</p>\n\n                <div className=\"emojis__header__tabs pull-right\">\n                  {emojiTabs}\n                </div>\n              </header>\n              <div className=\"emojis__body\" id=\"emojiContainer\">\n                {emojis}\n              </div>\n            </div>\n\n            <div className={stickersClassName}>\n              {this.renderStickers()}\n            </div>\n          </div>\n\n          <footer className=\"emoji-dropdown__footer\">\n            <div className={emojiTabClassName}\n                 onClick={this.handleEmojisTabMouseEnter}>\n              Emojis\n            </div>\n            <div className={stickerTabClassName}\n                 onClick={this.handleStickerTabMouseEnter}>\n              Stickers\n            </div>\n          </footer>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Container.create(EmojiDropdown);\n"]}