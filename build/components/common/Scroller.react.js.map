{"version":3,"sources":["../../../src/components/common/Scroller.react.js"],"names":[],"mappings":";;;;AAIA;;;;AACA;;AACA;;;;AACA;;;;;;;;;;;;;;AAEA,IAAM,MAAM,OAAO,qBAAnB;;IAEM,Q;;;AAeJ,oBAAY,KAAZ,EAAmB;AAAA;;AAAA,iDACjB,sBAAM,KAAN,CADiB;;AAGjB,UAAK,KAAL,GAAa;AACX,WAAK,CADM;AAEX,cAAQ,CAFG;AAGX,eAAS;AAHE,KAAb;;AAMA,UAAK,QAAL,GAAgB,MAAK,QAAL,CAAc,IAAd,OAAhB;AACA,UAAK,QAAL,GAAgB,MAAK,QAAL,CAAc,IAAd,OAAhB;AACA,UAAK,WAAL,GAAmB,MAAK,WAAL,CAAiB,IAAjB,OAAnB;AACA,UAAK,WAAL,GAAmB,MAAK,WAAL,CAAiB,IAAjB,OAAnB;AACA,UAAK,SAAL,GAAiB,MAAK,SAAL,CAAe,IAAf,OAAjB;AACA,UAAK,WAAL,GAAmB,MAAK,WAAL,CAAiB,IAAjB,OAAnB;AACA,UAAK,qBAAL,GAA6B,kDAAsB,IAAtB,OAA7B;AAfiB;AAgBlB;;qBAED,iB,gCAAoB;AAClB,SAAK,WAAL,CAAiB,IAAjB,EAAuB,KAAK,KAAL,CAAW,QAAlC;AACA,WAAO,gBAAP,CAAwB,QAAxB,EAAkC,KAAK,QAAvC,EAAiD,KAAjD;AACD,G;;qBAED,oB,mCAAuB;AACrB,WAAO,mBAAP,CAA2B,QAA3B,EAAqC,KAAK,QAA1C,EAAoD,KAApD;AACD,G;;qBAED,kB,iCAAqB;AACnB,QAAI,KAAK,YAAT,EAAuB;AACrB,WAAK,WAAL,CAAiB,IAAjB,EAAuB,KAAK,KAAL,CAAW,QAAlC;AACD;AACF,G;;qBAED,W,wBAAY,I,EAAM;AAChB,SAAK,SAAL,GAAiB,IAAjB;AACD,G;;qBAED,Q,uBAAW;AACT,SAAK,WAAL,CAAiB,KAAjB,EAAwB,KAAK,KAAL,CAAW,QAAnC;AACD,G;;qBAED,Q,uBAAW;AACT,SAAK,WAAL,CAAiB,KAAjB,EAAwB,KAAK,KAAL,CAAW,QAAnC;AACD,G;;qBAED,W,wBAAY,K,EAAO;AACjB,SAAK,QAAL,CAAc,EAAE,UAAU,IAAZ,EAAd;AACA,SAAK,SAAL,GAAiB,MAAM,KAAvB;;AAEA,aAAS,aAAT,GAAyB;AAAA,aAAM,KAAN;AAAA,KAAzB;AACA,aAAS,gBAAT,CAA0B,WAA1B,EAAuC,KAAK,WAA5C;AACA,aAAS,gBAAT,CAA0B,SAA1B,EAAqC,KAAK,SAA1C;;AAEA,WAAO,KAAP;AACD,G;;qBAED,W,wBAAY,K,EAAO;AAAA;;AACjB,QAAM,QAAQ,MAAM,KAAN,GAAc,KAAK,SAAjC;AACA,SAAK,SAAL,GAAiB,MAAM,KAAvB;;AAEA,QAAI;AAAA,aAAM,OAAK,SAAL,CAAe,SAAf,IAA4B,QAAQ,OAAK,WAA/C;AAAA,KAAJ;AACD,G;;qBAED,S,wBAAY;AACV,SAAK,QAAL,CAAc,EAAE,UAAU,KAAZ,EAAd;;AAEA,aAAS,aAAT,GAAyB,SAAzB;AACA,aAAS,mBAAT,CAA6B,WAA7B,EAA0C,KAAK,WAA/C;AACA,aAAS,mBAAT,CAA6B,SAA7B,EAAwC,KAAK,SAA7C;AACD,G;;qBAED,a,4BAAgB;AACd,WAAO;AACL,iBAAW,KAAK,SAAL,CAAe,SADrB;AAEL,oBAAc,KAAK,SAAL,CAAe,YAFxB;AAGL,oBAAc,KAAK,SAAL,CAAe;AAHxB,KAAP;AAKD,G;;qBAED,qB,oCAAwB;AACtB,WAAO,KAAK,SAAL,CAAe,qBAAf,EAAP;AACD,G;;qBAED,a,4BAAgB;AAAA,yBACoC,KAAK,aAAL,EADpC;;AAAA,QACN,SADM,kBACN,SADM;AAAA,QACK,YADL,kBACK,YADL;AAAA,QACmB,YADnB,kBACmB,YADnB;;;AAGd,QAAI,iBAAiB,CAAjB,IAAsB,gBAAgB,YAA1C,EAAwD;AACtD,aAAO,EAAE,KAAK,CAAP,EAAU,QAAQ,CAAlB,EAAP;AACD;;AAED,QAAM,SAAU,eAAe,YAAhB,GAAgC,YAA/C;AACA,QAAM,kBAAkB,eAAe,YAAvC;AACA,QAAM,gBAAgB,oBAAoB,CAApB,GAAwB,CAAxB,GAA6B,YAAY,eAA/D;AACA,QAAM,SAAS,CAAC,eAAe,MAAhB,IAA0B,aAAzC;;AAEA,WAAO;AACL,WAAK,MADA;AAEL,cAAQ;AAFH,KAAP;AAID,G;;qBAED,M,qBAAS;AAAA,iBAC2B,KAAK,KADhC;AAAA,QACC,GADD,UACC,GADD;AAAA,QACM,MADN,UACM,MADN;AAAA,QACc,QADd,UACc,QADd;;;AAGP,QAAM,YAAY,0BAAW,qBAAX,EAAkC,KAAK,KAAL,CAAW,SAA7C,CAAlB;AACA,QAAM,qBAAqB,0BAAW,qBAAX,EAAkC;AAC3D,qCAA+B;AAD4B,KAAlC,CAA3B;;AAIA,WACE;AAAA;MAAA,EAAK,WAAU,mBAAf;MACE;AAAA;QAAA,EAAK,WAAW,SAAhB,EAA2B,KAAK,KAAK,WAArC,EAAkD,UAAU,KAAK,QAAjE;QACG,KAAK,KAAL,CAAW;AADd,OADF;MAIE;AAAA;QAAA,EAAK,WAAW,kBAAhB;QACE;AACE,qBAAU,iBADZ;AAEE,iBAAO,EAAE,QAAF,EAAO,cAAP,EAFT;AAGE,uBAAa,KAAK;AAHpB;AADF;AAJF,KADF;AAcD,G;;qBAED,W,wBAAY,Y,EAAc,Q,EAAU;AAAA;;AAClC,SAAK,YAAL,GAAoB,YAApB;;AAEA,QAAI,YAAM;AAAA,uBAC+B,OAAK,SADpC;AAAA,UACA,YADA,cACA,YADA;AAAA,UACc,YADd,cACc,YADd;;AAER,aAAK,WAAL,GAAmB,eAAe,YAAlC;;AAEA,aAAK,QAAL,CAAc,OAAK,aAAL,EAAd,EAAoC,QAApC;AACD,KALD;AAMD,G;;qBAED,Q,qBAAS,M,EAAQ;AACf,SAAK,SAAL,CAAe,SAAf,GAA2B,MAA3B;AACD,G;;qBAED,c,6BAAiB;AACf,SAAK,QAAL,CAAc,KAAK,SAAL,CAAe,YAA7B;AACD,G;;;;;AA7JG,Q,CACG,S,GAAY;AACjB,aAAW,iBAAU,MADJ;AAEjB,YAAU,iBAAU,IAAV,CAAe,UAFR;AAGjB,YAAU,iBAAU,IAAV,CAAe,UAHR;AAIjB,YAAU,iBAAU,IAAV,CAAe,UAJR;AAKjB,YAAU,iBAAU,IAAV,CAAe;AALR,C;AADf,Q,CASG,Y,GAAe;AACpB,0BADoB;AAEpB,0BAFoB;AAGpB;AAHoB,C;kBAuJT,Q","file":"Scroller.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport { shouldComponentUpdate } from 'react-addons-pure-render-mixin';\nimport classNames from 'classnames';\nimport noop from 'lodash/noop';\n\nconst raf = window.requestAnimationFrame;\n\nclass Scroller extends Component {\n  static propTypes = {\n    className: PropTypes.string,\n    children: PropTypes.node.isRequired,\n    onUpdate: PropTypes.func.isRequired,\n    onScroll: PropTypes.func.isRequired,\n    onResize: PropTypes.func.isRequired\n  };\n\n  static defaultProps = {\n    onUpdate: noop,\n    onScroll: noop,\n    onResize: noop\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      top: 0,\n      height: 0,\n      draging: false\n    };\n\n    this.onScroll = this.onScroll.bind(this);\n    this.onResize = this.onResize.bind(this);\n    this.onMouseDown = this.onMouseDown.bind(this);\n    this.onMouseMove = this.onMouseMove.bind(this);\n    this.onMouseUp = this.onMouseUp.bind(this);\n    this.onReference = this.onReference.bind(this);\n    this.shouldComponentUpdate = shouldComponentUpdate.bind(this);\n  }\n\n  componentDidMount() {\n    this.updateState(true, this.props.onUpdate);\n    window.addEventListener('resize', this.onResize, false);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.onResize, false);\n  }\n\n  componentDidUpdate() {\n    if (this.shouldUpdate) {\n      this.updateState(true, this.props.onUpdate);\n    }\n  }\n\n  onReference(node) {\n    this.container = node;\n  }\n\n  onScroll() {\n    this.updateState(false, this.props.onScroll);\n  }\n\n  onResize() {\n    this.updateState(false, this.props.onResize);\n  }\n\n  onMouseDown(event) {\n    this.setState({ dragging: true });\n    this.lastPageY = event.pageY;\n\n    document.onselectstart = () => false;\n    document.addEventListener('mousemove', this.onMouseMove);\n    document.addEventListener('mouseup', this.onMouseUp);\n\n    return false;\n  }\n\n  onMouseMove(event) {\n    const delta = event.pageY - this.lastPageY;\n    this.lastPageY = event.pageY;\n\n    raf(() => this.container.scrollTop += delta / this.scrollRatio);\n  }\n\n  onMouseUp() {\n    this.setState({ dragging: false });\n\n    document.onselectstart = undefined;\n    document.removeEventListener('mousemove', this.onMouseMove);\n    document.removeEventListener('mouseup', this.onMouseUp);\n  }\n\n  getDimensions() {\n    return {\n      scrollTop: this.container.scrollTop,\n      scrollHeight: this.container.scrollHeight,\n      offsetHeight: this.container.offsetHeight\n    };\n  }\n\n  getBoundingClientRect() {\n    return this.container.getBoundingClientRect();\n  }\n\n  getThumbStyle() {\n    const { scrollTop, scrollHeight, offsetHeight } = this.getDimensions();\n\n    if (scrollHeight === 0 || scrollHeight <= offsetHeight) {\n      return { top: 0, height: 0 };\n    }\n\n    const height = (offsetHeight / scrollHeight) * offsetHeight;\n    const offsetAvailable = scrollHeight - offsetHeight;\n    const offsetPercent = offsetAvailable === 0 ? 0 : (scrollTop / offsetAvailable);\n    const offset = (offsetHeight - height) * offsetPercent;\n\n    return {\n      top: offset,\n      height: height\n    };\n  }\n\n  render() {\n    const { top, height, dragging } = this.state;\n\n    const className = classNames('scroller__container', this.props.className);\n    const scrollbarClassName = classNames('scroller__scrollbar', {\n      'scroller__scrollbar--active': dragging\n    });\n\n    return (\n      <div className=\"scroller__wrapper\">\n        <div className={className} ref={this.onReference} onScroll={this.onScroll}>\n          {this.props.children}\n        </div>\n        <div className={scrollbarClassName}>\n          <div\n            className=\"scroller__thumb\"\n            style={{ top, height }}\n            onMouseDown={this.onMouseDown}\n          />\n        </div>\n      </div>\n    );\n  }\n\n  updateState(shouldUpdate, callback) {\n    this.shouldUpdate = shouldUpdate;\n\n    raf(() => {\n      const { scrollHeight, clientHeight } = this.container;\n      this.scrollRatio = clientHeight / scrollHeight;\n\n      this.setState(this.getThumbStyle(), callback);\n    });\n  }\n\n  scrollTo(offset) {\n    this.container.scrollTop = offset;\n  }\n\n  scrollToBottom() {\n    this.scrollTo(this.container.scrollHeight);\n  }\n}\n\nexport default Scroller;\n"]}