{"version":3,"sources":["../../../src/components/activity/UserProfile.react.js"],"names":[],"mappings":"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","file":"UserProfile.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport { Container } from 'flux/utils';\nimport { FormattedMessage } from 'react-intl';\nimport classnames from 'classnames';\nimport { lightbox } from '../../utils/ImageUtils';\n\nimport ActorClient from '../../utils/ActorClient';\nimport confirm from '../../utils/confirm';\nimport { escapeWithEmoji } from '../../utils/EmojiUtils';\n\nimport ContactActionCreators from '../../actions/ContactActionCreators';\nimport DialogActionCreators from '../../actions/DialogActionCreators';\nimport NotificationsActionCreators from '../../actions/NotificationsActionCreators';\nimport CallActionCreators from '../../actions/CallActionCreators';\nimport BlockedUsersActionCreators from '../../actions/BlockedUsersActionCreators';\n\nimport UserStore from '../../stores/UserStore';\nimport NotificationsStore from '../../stores/NotificationsStore';\nimport OnlineStore from '../../stores/OnlineStore';\n\nimport AvatarItem from '../common/AvatarItem.react';\nimport ContactDetails from '../common/ContactDetails.react';\nimport ToggleNotifications from '../common/ToggleNotifications.react';\nimport Fold from '../common/Fold.react';\n\nclass UserProfile extends Component {\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  static propTypes = {\n    user: PropTypes.object.isRequired\n  };\n\n  static getStores() {\n    return [NotificationsStore, OnlineStore];\n  }\n\n  static calculateState(prevState, nextProps) {\n    const uid = nextProps.user.id;\n    const peer = uid ? UserStore.getUser(uid) : null;\n\n    return {\n      ...prevState,\n      peer,\n      isNotificationsEnabled: peer ? NotificationsStore.isNotificationsEnabled(peer) : true,\n      message: OnlineStore.getMessage()\n    };\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isMoreDropdownOpen: false\n    };\n\n    this.onClearChat = this.onClearChat.bind(this);\n    this.onDeleteChat = this.onDeleteChat.bind(this);\n    this.onBlockUser = this.onBlockUser.bind(this);\n    this.onRemoveFromContacts = this.onRemoveFromContacts.bind(this);\n  }\n\n  addToContacts = () => ContactActionCreators.addContact(this.props.user.id);\n\n  onNotificationChange = (event) => {\n    const { peer } = this.state;\n    NotificationsActionCreators.changeNotificationsEnabled(peer, event.target.checked);\n  };\n\n  toggleActionsDropdown = () => {\n    const { isActionsDropdownOpen } = this.state;\n\n    if (!isActionsDropdownOpen) {\n      this.setState({ isActionsDropdownOpen: true });\n      document.addEventListener('click', this.closeActionsDropdown, false);\n    } else {\n      this.closeActionsDropdown();\n    }\n  };\n\n  closeActionsDropdown = () => {\n    this.setState({ isActionsDropdownOpen: false });\n    document.removeEventListener('click', this.closeActionsDropdown, false);\n  };\n\n  onClearChat() {\n    const { user } = this.props;\n    confirm(\n      <FormattedMessage id=\"modal.confirm.user.clear\" values={{ name: user.name }} />\n    ).then(\n      () => {\n        const peer = ActorClient.getUserPeer(user.id);\n        DialogActionCreators.clearChat(peer);\n      },\n      () => {}\n    );\n  }\n\n  onRemoveFromContacts() {\n    const { user } = this.props;\n    confirm(\n      <FormattedMessage id=\"modal.confirm.user.removeContact\" values={{ name: user.name }}/>\n    ).then(\n      () => ContactActionCreators.removeContact(user.id),\n      () => {}\n    );\n  }\n\n  onDeleteChat() {\n    const { user } = this.props;\n\n    confirm(\n      <FormattedMessage id=\"modal.confirm.user.delete\" values={{ name: user.name }} />\n    ).then(\n      () => {\n        const peer = ActorClient.getUserPeer(user.id);\n        DialogActionCreators.deleteChat(peer);\n      },\n      () => {}\n    );\n  }\n\n  onBlockUser() {\n    const { user } = this.props;\n\n    confirm(\n      <FormattedMessage id=\"modal.confirm.user.block\" values={{ name: user.name }} />\n    ).then(\n      () => BlockedUsersActionCreators.blockUser(user.id),\n      () => {}\n    );\n  }\n\n  handleAvatarClick = () => lightbox.open(this.props.user.bigAvatar);\n\n  makeCall = () => {\n    const { user } = this.props;\n    CallActionCreators.makeCall(user.id);\n  };\n\n  render() {\n    const { user } = this.props;\n    const { intl } = this.context;\n    const { isNotificationsEnabled, isActionsDropdownOpen, message } = this.state;\n\n    const dropdownClassNames = classnames('dropdown', {\n      'dropdown--opened': isActionsDropdownOpen\n    });\n\n    return (\n      <div className=\"activity__body user_profile\">\n\n        <ul className=\"profile__list\">\n          <li className=\"profile__list__item user_profile__meta\">\n            <header>\n              <AvatarItem image={user.bigAvatar}\n                          placeholder={user.placeholder}\n                          size=\"large\"\n                          title={user.name}\n                          onClick={this.handleAvatarClick}/>\n\n              <h3 className=\"user_profile__meta__title\" dangerouslySetInnerHTML={{ __html: escapeWithEmoji(user.name) }}/>\n              <div className=\"user_profile__meta__message\">{message}</div>\n            </header>\n\n            {\n              user.about\n                ? <div className=\"user_profile__meta__about\"\n                       dangerouslySetInnerHTML={{ __html: escapeWithEmoji(user.about).replace(/\\n/g, '<br/>') }}/>\n                : null\n            }\n\n            <footer className=\"row\">\n              <div className=\"col-xs\">\n                <button className=\"button button--green button--wide\" onClick={this.makeCall}>\n                  <i className=\"material-icons\">phone</i>\n                  {intl.messages['button.call']}\n                </button>\n              </div>\n              <div style={{ width: 10 }}/>\n              <div className=\"col-xs\">\n                <div className={dropdownClassNames}>\n                  <button className=\"dropdown__button button button--flat button--wide\" onClick={this.toggleActionsDropdown}>\n                    <i className=\"material-icons\">more_horiz</i>\n                    {intl.messages['actions']}\n                  </button>\n                  <ul className=\"dropdown__menu dropdown__menu--right\">\n                    {\n                      user.isContact\n                        ? <li className=\"dropdown__menu__item\" onClick={this.onRemoveFromContacts}>\n                            {intl.messages['removeFromContacts']}\n                          </li>\n                        : <li className=\"dropdown__menu__item\" onClick={this.addToContacts}>\n                            {intl.messages['addToContacts']}\n                          </li>\n                    }\n                    <li className=\"dropdown__menu__item\" onClick={this.onBlockUser}>\n                      {intl.messages['blockUser']}\n                    </li>\n                    <li className=\"dropdown__menu__item\" onClick={this.onClearChat}>\n                      {intl.messages['clearConversation']}\n                    </li>\n                    <li className=\"dropdown__menu__item\" onClick={this.onDeleteChat}>\n                      {intl.messages['deleteConversation']}\n                    </li>\n                  </ul>\n                </div>\n              </div>\n            </footer>\n          </li>\n\n          <li className=\"profile__list__item user_profile__contact_info no-p\">\n            <ContactDetails peerInfo={user}/>\n          </li>\n\n          <li className=\"profile__list__item user_profile__media no-p hide\">\n            <Fold icon=\"attach_file\" iconClassName=\"icon--gray\" title={intl.messages['sharedMedia']}>\n              <ul>\n                <li><a>230 Shared Photos and Videos</a></li>\n                <li><a>49 Shared Links</a></li>\n                <li><a>49 Shared Files</a></li>\n              </ul>\n            </Fold>\n          </li>\n\n          <li className=\"profile__list__item user_profile__notifications no-p\">\n            <ToggleNotifications isNotificationsEnabled={isNotificationsEnabled} onNotificationChange={this.onNotificationChange}/>\n          </li>\n\n        </ul>\n      </div>\n    );\n  }\n}\n\nexport default Container.create(UserProfile, { pure:false, withProps: true });\n"]}