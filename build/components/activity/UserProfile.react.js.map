{"version":3,"sources":["../../../src/components/activity/UserProfile.react.js"],"names":[],"mappings":"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","file":"UserProfile.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport { assign } from 'lodash';\nimport React, { Component, PropTypes } from 'react';\nimport { Container } from 'flux/utils';\nimport { FormattedMessage } from 'react-intl';\nimport classnames from 'classnames';\nimport { lightbox } from '../../utils/ImageUtils';\n\nimport ActorClient from '../../utils/ActorClient';\nimport confirm from '../../utils/confirm';\nimport { escapeWithEmoji } from '../../utils/EmojiUtils';\n\nimport ContactActionCreators from '../../actions/ContactActionCreators';\nimport DialogActionCreators from '../../actions/DialogActionCreators';\nimport NotificationsActionCreators from '../../actions/NotificationsActionCreators';\nimport CallActionCreators from '../../actions/CallActionCreators';\n\nimport UserStore from '../../stores/UserStore';\nimport NotificationsStore from '../../stores/NotificationsStore';\nimport OnlineStore from '../../stores/OnlineStore';\n\nimport AvatarItem from '../common/AvatarItem.react';\nimport Fold from '../common/Fold.react';\n\nconst getStateFromStores = (uid) => {\n  const thisPeer = uid ? UserStore.getUser(uid) : null;\n  return {\n    thisPeer,\n    isNotificationsEnabled: thisPeer ? NotificationsStore.isNotificationsEnabled(thisPeer) : true,\n    message: OnlineStore.getMessage()\n  };\n};\n\nclass UserProfile extends Component {\n  static propTypes = {\n    user: PropTypes.object.isRequired\n  };\n\n  static getStores() {\n    return [NotificationsStore, OnlineStore];\n  }\n\n  static calculateState(prevState, nextProps) {\n    return getStateFromStores(nextProps.user.id);\n  }\n\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isMoreDropdownOpen: false,\n    }\n  }\n\n  addToContacts = () => ContactActionCreators.addContact(this.props.user.id);\n\n  removeFromContacts = () => {\n    const { user } = this.props;\n    confirm(<FormattedMessage id=\"modal.confirm.removeContact\" values={{name: user.name}}/>).then(\n      () => ContactActionCreators.removeContact(user.id),\n      () => {}\n    );\n  };\n\n  onNotificationChange = (event) => {\n    const { thisPeer } = this.state;\n    NotificationsActionCreators.changeNotificationsEnabled(thisPeer, event.target.checked);\n  };\n\n  toggleActionsDropdown = () => {\n    const { isActionsDropdownOpen } = this.state;\n\n    if (!isActionsDropdownOpen) {\n      this.setState({isActionsDropdownOpen: true});\n      document.addEventListener('click', this.closeActionsDropdown, false);\n    } else {\n      this.closeActionsDropdown();\n    }\n  };\n\n  closeActionsDropdown = () => {\n    this.setState({isActionsDropdownOpen: false});\n    document.removeEventListener('click', this.closeActionsDropdown, false);\n  };\n\n  clearChat = (uid) => {\n    const { intl } = this.context;\n    confirm(intl.messages['modal.confirm.clear']).then(\n      () => {\n        const peer = ActorClient.getUserPeer(uid);\n        DialogActionCreators.clearChat(peer);\n      },\n      () => {}\n    );\n  };\n\n  deleteChat = (uid) => {\n    const { intl } = this.context;\n    confirm(intl.messages['modal.confirm.delete']).then(\n      () => {\n        const peer = ActorClient.getUserPeer(uid);\n        DialogActionCreators.deleteChat(peer);\n      },\n      () => {}\n    );\n  };\n\n  handleAvatarClick = () => lightbox.open(this.props.user.bigAvatar);\n\n  makeCall = () => {\n    const { user } = this.props;\n    CallActionCreators.makeCall(user.id);\n  };\n\n  render() {\n    const { user } = this.props;\n    const { intl } = this.context;\n    const { isNotificationsEnabled, isActionsDropdownOpen, message } = this.state;\n\n    const dropdownClassNames = classnames('dropdown', {\n      'dropdown--opened': isActionsDropdownOpen\n    });\n\n    const nickname = user.nick ? (\n      <li>\n        <svg className=\"icon icon--pink\"\n             dangerouslySetInnerHTML={{__html: '<use xlink:href=\"assets/images/icons.svg#username\"/>'}}/>\n        <span className=\"title\">{user.nick}</span>\n        <span className=\"description\">{intl.messages['profile.nickname']}</span>\n      </li>\n    ) : null;\n\n    const email = user.emails[0] ? (\n      <li>\n        <svg className=\"icon icon--blue\"\n             dangerouslySetInnerHTML={{__html: '<use xlink:href=\"assets/images/icons.svg#envelope\"/>'}}/>\n        <span className=\"title\"><a href={'mailto:' + user.emails[0].email}>{user.emails[0].email}</a></span>\n        <span className=\"description\">{intl.messages['profile.email']}</span>\n      </li>\n    ) : null;\n\n    const phone = user.phones[0] ? (\n      <li>\n        <i className=\"material-icons icon icon--green\">call</i>\n        <span className=\"title\"><a href={'tel:+' + user.phones[0].number}>{'+' + user.phones[0].number}</a></span>\n        <span className=\"description\">{intl.messages['profile.phone']}</span>\n      </li>\n    ) : null;\n\n    return (\n      <div className=\"activity__body user_profile\">\n\n        <ul className=\"profile__list\">\n          <li className=\"profile__list__item user_profile__meta\">\n            <header>\n              <AvatarItem image={user.bigAvatar}\n                          placeholder={user.placeholder}\n                          size=\"large\"\n                          title={user.name}\n                          onClick={this.handleAvatarClick}/>\n\n              <h3 className=\"user_profile__meta__title\" dangerouslySetInnerHTML={{__html: escapeWithEmoji(user.name)}}/>\n              <div className=\"user_profile__meta__message\">{message}</div>\n            </header>\n\n            {\n              user.about\n                ? <div className=\"user_profile__meta__about\"\n                       dangerouslySetInnerHTML={{__html: escapeWithEmoji(user.about).replace(/\\n/g, '<br/>')}}/>\n                : null\n            }\n\n            <footer className=\"row\">\n              <div className=\"col-xs\">\n                <button className=\"button button--green button--wide\" onClick={this.makeCall}>\n                  <i className=\"material-icons\">phone</i>\n                  {intl.messages['button.call']}\n                </button>\n              </div>\n              <div style={{width: 10}}/>\n              <div className=\"col-xs\">\n                <div className={dropdownClassNames}>\n                  <button className=\"dropdown__button button button--flat button--wide\" onClick={this.toggleActionsDropdown}>\n                    <i className=\"material-icons\">more_horiz</i>\n                    {intl.messages['actions']}\n                  </button>\n                  <ul className=\"dropdown__menu dropdown__menu--right\">\n                    {\n                      user.isContact\n                        ? <li className=\"dropdown__menu__item\" onClick={this.removeFromContacts}>\n                            {intl.messages['removeFromContacts']}\n                          </li>\n                        : <li className=\"dropdown__menu__item\" onClick={this.addToContacts}>\n                            {intl.messages['addToContacts']}\n                          </li>\n                    }\n                    <li className=\"dropdown__menu__item\" onClick={() => this.clearChat(user.id)}>\n                      {intl.messages['clearConversation']}\n                    </li>\n                    <li className=\"dropdown__menu__item\" onClick={() => this.deleteChat(user.id)}>\n                      {intl.messages['deleteConversation']}\n                    </li>\n                  </ul>\n                </div>\n              </div>\n            </footer>\n          </li>\n\n          <li className=\"profile__list__item user_profile__contact_info no-p\">\n            <ul className=\"user_profile__contact_info__list\">\n              {phone}\n              {email}\n              {nickname}\n            </ul>\n          </li>\n\n          <li className=\"profile__list__item user_profile__media no-p hide\">\n            <Fold icon=\"attach_file\" iconClassName=\"icon--gray\" title={intl.messages['sharedMedia']}>\n              <ul>\n                <li><a>230 Shared Photos and Videos</a></li>\n                <li><a>49 Shared Links</a></li>\n                <li><a>49 Shared Files</a></li>\n              </ul>\n            </Fold>\n          </li>\n\n          <li className=\"profile__list__item user_profile__notifications no-p\">\n            <label htmlFor=\"notifications\">\n              <i className=\"material-icons icon icon--squash\">notifications_none</i>\n              {intl.messages['notifications']}\n              <div className=\"switch pull-right\">\n                <input checked={isNotificationsEnabled}\n                       id=\"notifications\"\n                       onChange={this.onNotificationChange}\n                       type=\"checkbox\"/>\n                <label htmlFor=\"notifications\"/>\n              </div>\n            </label>\n          </li>\n\n        </ul>\n      </div>\n    );\n  }\n}\n\nexport default Container.create(UserProfile, {pure:false, withProps: true});\n"]}