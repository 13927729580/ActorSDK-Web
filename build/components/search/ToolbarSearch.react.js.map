{"version":3,"sources":["../../../src/components/search/ToolbarSearch.react.js"],"names":[],"mappings":";;;;AAIA;;;;AACA;;AACA;;;;AACA;;AAEA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;;;;;;;IAEM,a;;;gBACG,S,wBAAY;AACjB,WAAO,uBAAP;AACD,G;;gBAEM,c,6BAAiB;AACtB,WAAO,sBAAY,QAAZ,EAAP;AACD,G;;AAED,yBAAY,KAAZ,EAAmB;AAAA;;AAAA,iDACjB,sBAAM,KAAN,CADiB;;AAGjB,UAAK,kBAAL,GAA0B,MAAK,kBAAL,CAAwB,IAAxB,OAA1B;AACA,UAAK,kBAAL,GAA0B,MAAK,kBAAL,CAAwB,IAAxB,OAA1B;AACA,UAAK,iBAAL,GAAyB,MAAK,iBAAL,CAAuB,IAAvB,OAAzB;AACA,UAAK,gBAAL,GAAwB,MAAK,gBAAL,CAAsB,IAAtB,OAAxB;AACA,UAAK,cAAL,GAAsB,MAAK,cAAL,CAAoB,IAApB,OAAtB;AAPiB;AAQlB;;0BAED,kB,iCAAqB;AACnB,mCAAqB,KAArB;AACD,G;;0BAED,iB,gCAAoB;AAClB,mCAAqB,KAArB;AACD,G;;0BAED,gB,6BAAiB,K,EAAO;AACtB,YAAQ,KAAR,CAAc,KAAd;;AAEA,eAAW;AAAA,aAAM,+BAAqB,IAArB,EAAN;AAAA,KAAX,EAA8C,EAA9C;AACD,G;;0BAED,kB,+BAAmB,K,EAAO;AACxB,mCAAqB,YAArB,CAAkC,KAAlC;AACD,G;;0BAED,c,2BAAe,K,EAAO;AAAA,yBACsB,KAAK,KAD3B,CACZ,OADY;AAAA,QACD,QADC,kBACD,QADC;AAAA,QACS,MADT,kBACS,MADT;;AAEpB,QAAI,UAAU,SAAS,MAAT,GAAkB,OAAO,MAAvC,EAA+C;AAC7C,qCAAqB,kBAArB,CAAwC,KAAK,KAAL,CAAW,KAAnD;AACD,KAFD,MAEO;AACL,UAAM,UAAU,UAAI,QAAJ,EAAiB,MAAjB,EAAyB,KAAzB,CAAhB;AACA,qCAAqB,WAArB,CAAiC,OAAjC;AACD;AACF,G;;0BAED,2B,0CAA8B;AAAA,iBACgC,KAAK,KADrC;AAAA,QACpB,SADoB,UACpB,SADoB;AAAA,QACT,KADS,UACT,KADS;AAAA,iCACF,OADE;AAAA,QACS,QADT,mBACS,QADT;AAAA,QACmB,MADnB,mBACmB,MADnB;;;AAG5B,QAAI,CAAC,SAAL,EAAgB;AACd,aAAO,IAAP;AACD;;AAED,QAAI,CAAC,MAAM,MAAX,EAAmB;AACjB,aACE;AAAA;QAAA,EAAK,WAAU,2BAAf;QACE;AAAA;UAAA,EAAK,WAAU,MAAf;UACE,iEAAsB,IAAG,aAAzB;AADF;AADF,OADF;AAOD;;AAED,QAAM,MAAM,SAAS,MAAT,GAAkB,OAAO,MAArC;;AAEA,WACE;AAAA;MAAA,EAAY,WAAU,2BAAtB,EAAkD,KAAK,GAAvD,EAA4D,UAAU,KAAK,cAA3E;MACE;AAAA;QAAA,EAAK,WAAU,0BAAf;QACE,6DAAmB,IAAG,UAAtB,EAAiC,QAAQ,CAAzC,EAA4C,OAAO,QAAnD,GADF;QAEE,6DAAmB,IAAG,QAAtB,EAA+B,QAAQ,SAAS,MAAhD,EAAwD,OAAO,MAA/D;AAFF,OADF;MAKE;AAAA;QAAA,EAAgB,OAAO,GAAvB;QACE;AAAA;UAAA,EAAQ,WAAU,yBAAlB;UACE,6DAAkB,IAAG,eAArB,GADF;UAAA;UACyC;AAAA;YAAA,EAAG,WAAU,gBAAb;YAAA;AAAA;AADzC;AADF;AALF,KADF;AAaD,G;;0BAED,M,qBAAS;AAAA,kBACsB,KAAK,KAD3B;AAAA,QACC,KADD,WACC,KADD;AAAA,QACQ,SADR,WACQ,SADR;;AAEP,QAAM,yBAAyB,0BAAW,qBAAX,EAAkC;AAC/D,kCAA4B;AADmC,KAAlC,CAA/B;;AAIA,WACE;AAAA;MAAA,EAAK,WAAW,sBAAhB,EAAwC,SAAS,KAAK,wBAAtD;MACE;AAAA;QAAA,EAAK,WAAU,KAAf;QACE;AAAA;UAAA,EAAG,WAAU,4BAAb;UAAA;AAAA,SADF;QAEE;AACE,iBAAO,KADT;AAEE,mBAAS,KAAK,iBAFhB;AAGE,kBAAQ,KAAK,gBAHf;AAIE,mBAAS,KAAK,kBAJhB;AAKE,oBAAU,KAAK;AALjB;AAFF,OADF;MAWG,KAAK,2BAAL;AAXH,KADF;AAeD,G;;;;;kBAGY,iBAAU,MAAV,CAAiB,aAAjB,C","file":"ToolbarSearch.react.js","sourcesContent":["/*\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component } from 'react';\nimport { Container } from 'flux/utils';\nimport classnames from 'classnames';\nimport { FormattedMessage, FormattedHTMLMessage } from 'react-intl';\n\nimport SearchStore from '../../stores/SearchStore';\nimport SearchActionCreators from '../../actions/SearchActionCreators';\n\nimport SearchInput from './SearchInput.react';\nimport SelectList from '../common/SelectList.react';\nimport SelectListItem from '../common/SelectListItem.react';\nimport SearchResultGroup from './SearchResultGroup.react';\n\nclass ToolbarSearch extends Component {\n  static getStores() {\n    return [SearchStore];\n  }\n\n  static calculateState() {\n    return SearchStore.getState();\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.handleSearchChange = this.handleSearchChange.bind(this);\n    this.handlerSearchClear = this.handlerSearchClear.bind(this);\n    this.handleSearchFocus = this.handleSearchFocus.bind(this);\n    this.handleSearchBlur = this.handleSearchBlur.bind(this);\n    this.onResultSelect = this.onResultSelect.bind(this);\n  }\n\n  handlerSearchClear() {\n    SearchActionCreators.clear();\n  }\n\n  handleSearchFocus() {\n    SearchActionCreators.focus();\n  }\n\n  handleSearchBlur(event) {\n    console.debug(event);\n    // tricky workaround for click on search result\n    setTimeout(() => SearchActionCreators.blur(), 50);\n  }\n\n  handleSearchChange(query) {\n    SearchActionCreators.handleSearch(query);\n  }\n\n  onResultSelect(index) {\n    const { results: { contacts, groups } } = this.state;\n    if (index === contacts.length + groups.length) {\n      SearchActionCreators.goToMessagesSearch(this.state.query);\n    } else {\n      const contact = [...contacts, ...groups][index];\n      SearchActionCreators.goToContact(contact);\n    }\n  }\n\n  renderSearchResultsDropdown() {\n    const { isFocused, query, results: { contacts, groups } } = this.state;\n\n    if (!isFocused) {\n      return null\n    }\n\n    if (!query.length) {\n      return (\n        <div className=\"toolbar__search__dropdown\">\n          <div className=\"hint\">\n            <FormattedHTMLMessage id=\"search.hint\"/>\n          </div>\n        </div>\n      );\n    }\n\n    const max = contacts.length + groups.length;\n\n    return (\n      <SelectList className=\"toolbar__search__dropdown\" max={max} onSelect={this.onResultSelect}>\n        <div className=\"toolbar__search__results\">\n          <SearchResultGroup id=\"contacts\" offset={0} items={contacts} />\n          <SearchResultGroup id=\"groups\" offset={contacts.length} items={groups} />\n        </div>\n        <SelectListItem index={max}>\n          <footer className=\"toolbar__search__footer\">\n            <FormattedMessage id=\"search.inChat\"/> <i className=\"material-icons\">arrow_forward</i>\n          </footer>\n        </SelectListItem>\n      </SelectList>\n    );\n  }\n\n  render() {\n    const { query, isFocused } = this.state;\n    const toolbarSearchClassName = classnames('toolbar__search row', {\n      'toolbar__search--focused': isFocused\n    });\n\n    return (\n      <div className={toolbarSearchClassName} onClick={this.handleToolbarSearchClick}>\n        <div className=\"row\">\n          <i className=\"search-icon material-icons\">search</i>\n          <SearchInput\n            value={query}\n            onFocus={this.handleSearchFocus}\n            onBlur={this.handleSearchBlur}\n            onClear={this.handlerSearchClear}\n            onChange={this.handleSearchChange}\n          />\n        </div>\n        {this.renderSearchResultsDropdown()}\n      </div>\n    );\n  }\n}\n\nexport default Container.create(ToolbarSearch);\n"]}