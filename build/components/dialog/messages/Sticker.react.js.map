{"version":3,"sources":["../../../../src/components/dialog/messages/Sticker.react.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAOA,IAAI,KAAK,GAAG,EAAE;;;;;AAAC;IAKT,OAAO;YAAP,OAAO;;AAQX,WARI,OAAO,CAQC,KAAK,EAAE;0BARf,OAAO;;uEAAP,OAAO,aASH,KAAK;;UAOb,MAAM,GAAG,YAAM;AACb,YAAK,SAAS,EAAE,CAAC;AACjB,UAAI,CAAC,MAAK,KAAK,CAAC,QAAQ,EAAE;AACxB,cAAK,QAAQ,CAAC,EAAC,QAAQ,EAAE,IAAI,EAAC,CAAC,CAAC;OACjC;KACF;;UAED,QAAQ,GAAG;aAAM,KAAK,CAAC,MAAK,KAAK,CAAC,OAAO,CAAC,KAAK,IAAI;KAAA;;UAEnD,SAAS,GAAG;aAAM,KAAK,CAAC,MAAK,KAAK,CAAC,OAAO,CAAC,GAAG,IAAI;KAAA;;AAdhD,UAAK,KAAK,GAAG;AACX,cAAQ,EAAE,MAAK,QAAQ,EAAE;KAC1B,CAAA;;GACF;;eAdG,OAAO;;6BA2BF;mBAC6B,IAAI,CAAC,KAAK;UAAtC,SAAS,UAAT,SAAS;UAAE,CAAC,UAAD,CAAC;UAAE,CAAC,UAAD,CAAC;UAAE,OAAO,UAAP,OAAO;UACxB,QAAQ,GAAK,IAAI,CAAC,KAAK,CAAvB,QAAQ;;AAChB,UAAM,SAAS,GAAG;;UAAK,SAAS,EAAC,WAAW;QAAC,0CAAM;QAAA,0CAAM;QAAA,0CAAM;QAAA,0CAAM;QAAA,0CAAM;OAAM,CAAC;AAClF,UAAM,gBAAgB,GAAG,0BAAW,SAAS,EAAE;AAC7C,yBAAiB,EAAE,QAAQ;OAC5B,CAAC,CAAC;;AAEH,UAAM,SAAS,GAAG,GAAG,CAAC;AACtB,UAAM,UAAU,GAAG,GAAG,CAAC;AACvB,UAAI,KAAK,GAAG,CAAC,CAAC;AACd,UAAI,MAAM,GAAG,CAAC,CAAC;;AAEf,UAAI,KAAK,GAAG,MAAM,EAAE;AAClB,YAAI,KAAK,GAAG,SAAS,EAAE;AACrB,gBAAM,IAAI,SAAS,GAAG,KAAK,CAAC;AAC5B,eAAK,GAAG,SAAS,CAAC;SACnB;OACF,MAAM;AACL,YAAI,MAAM,GAAG,UAAU,EAAE;AACvB,eAAK,IAAI,UAAU,GAAG,MAAM,CAAC;AAC7B,gBAAM,GAAG,UAAU,CAAC;SACrB;OACF;;AAED,aACE;;UAAK,SAAS,EAAE,SAAS,AAAC;QACxB;;YAAK,SAAS,EAAE,gBAAgB,AAAC,EAAC,KAAK,EAAE,EAAC,KAAK,EAAL,KAAK,EAAE,MAAM,EAAN,MAAM,EAAC,AAAC;UACtD,SAAS;UACV,uCAAK,GAAG,EAAE,OAAO,AAAC;AACb,iBAAK,EAAE,KAAK,AAAC;AACb,kBAAM,EAAE,MAAM,AAAC;AACf,kBAAM,EAAE,IAAI,CAAC,MAAM,AAAC,GAAE;SACvB;OACF,CACN;KACH;;;SA/DG,OAAO;;;AAAP,OAAO,CACJ,SAAS,GAAG;AACjB,WAAS,EAAE,iBAAU,MAAM;AAC3B,SAAO,EAAE,iBAAU,MAAM,CAAC,UAAU;AACpC,GAAC,EAAE,iBAAU,MAAM,CAAC,UAAU;AAC9B,GAAC,EAAE,iBAAU,MAAM,CAAC,UAAU;CAC/B;kBA4DY,OAAO","file":"Sticker.react.js","sourcesContent":["/*\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport classnames from 'classnames';\n\nlet cache = {};\n\n/**\n * Class that represents a component for display sticker message content\n */\nclass Sticker extends Component {\n  static propTypes = {\n    className: PropTypes.string,\n    fileUrl: PropTypes.string.isRequired,\n    h: PropTypes.number.isRequired,\n    w: PropTypes.number.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isLoaded: this.isCached()\n    }\n  }\n\n  onLoad = () => {\n    this.setCached();\n    if (!this.state.isLoaded) {\n      this.setState({isLoaded: true});\n    }\n  };\n\n  isCached = () => cache[this.props.fileUrl] === true;\n\n  setCached = () => cache[this.props.fileUrl] = true;\n\n  render() {\n    const { className, w, h, fileUrl} = this.props;\n    const { isLoaded } = this.state;\n    const preloader = <div className=\"preloader\"><div/><div/><div/><div/><div/></div>;\n    const stickerClassName = classnames('sticker', {\n      'sticker--loaded': isLoaded\n    });\n\n    const MAX_WIDTH = 200;\n    const MAX_HEIGHT = 200;\n    let width = w;\n    let height = h;\n\n    if (width > height) {\n      if (width > MAX_WIDTH) {\n        height *= MAX_WIDTH / width;\n        width = MAX_WIDTH;\n      }\n    } else {\n      if (height > MAX_HEIGHT) {\n        width *= MAX_HEIGHT / height;\n        height = MAX_HEIGHT;\n      }\n    }\n\n    return (\n      <div className={className}>\n        <div className={stickerClassName} style={{width, height}}>\n          {preloader}\n          <img src={fileUrl}\n               width={width}\n               height={height}\n               onLoad={this.onLoad}/>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Sticker;\n"]}