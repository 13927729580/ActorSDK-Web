{"version":3,"sources":["../../../src/components/sidebar/Recent.react.js"],"names":[],"mappings":"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","file":"Recent.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport { forEach, map, debounce } from 'lodash';\n\nimport React, { Component, PropTypes } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport { Link } from 'react-router';\nimport { FormattedMessage } from 'react-intl';\nimport  classnames from 'classnames';\n\nimport CreateGroupActionCreators from '../../actions/CreateGroupActionCreators';\nimport ContactActionCreators from '../../actions/ContactActionCreators';\nimport GroupListActionCreators from '../../actions/GroupListActionCreators';\nimport AddContactActionCreators from '../../actions/AddContactActionCreators';\n\nimport Scrollbar from '../common/Scrollbar.react';\nimport RecentItem from './RecentItem.react';\n\nclass Recent extends Component {\n  constructor(props) {\n    super(props);\n\n    this.checkInvisibleCounters = debounce(this.checkInvisibleCounters, 50, {\n      maxWait: 150,\n      leading: true\n    });\n\n    this.state = {\n      haveUnreadAbove: false,\n      haveUnreadBelow: false,\n      lastUnreadBelow: null,\n      firstUnreadAbove: null\n    }\n  }\n\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  static propTypes = {\n    dialogs: PropTypes.array.isRequired\n  };\n\n  componentDidUpdate(prevProps) {\n    if (prevProps !== this.props) {\n      this.checkInvisibleCounters();\n    }\n  }\n\n  handleCreateGroup = () => CreateGroupActionCreators.open();\n\n  handleCreatePrivate = () => AddContactActionCreators.open();\n\n  handleGroupListClick = () => GroupListActionCreators.open();\n\n  handlePrivateListClick = () => ContactActionCreators.open();\n\n  handleRecentScroll = () => this.checkInvisibleCounters();\n\n  checkInvisibleCounters = () => {\n    const unreadNodes = document.getElementsByClassName('sidebar__list__item--unread');\n    const scrollNode = findDOMNode(this.refs.container);\n    const scrollNodeRect = scrollNode.getBoundingClientRect();\n\n    let haveUnreadAbove = false,\n        haveUnreadBelow = false,\n        lastUnreadBelow = null,\n        firstUnreadAbove = null;\n\n    forEach(unreadNodes, (node) => {\n      const rect = node.getBoundingClientRect();\n      if ((scrollNodeRect.top + scrollNodeRect.height) < rect.top) {\n        haveUnreadBelow = true;\n        lastUnreadBelow = node;\n      }\n      if (scrollNodeRect.top > (rect.top + rect.height)) {\n        haveUnreadAbove = true;\n        if (!firstUnreadAbove) {\n          firstUnreadAbove = node;\n        }\n      }\n    });\n\n    this.setState({ haveUnreadAbove, haveUnreadBelow, firstUnreadAbove, lastUnreadBelow });\n  };\n\n  scrollToFirstHiddenAbove = () => {\n    const { firstUnreadAbove } = this.state;\n    const rect = firstUnreadAbove.getBoundingClientRect();\n    const scrollNode = findDOMNode(this.refs.container).getElementsByClassName('ss-scrollarea')[0];\n    const scrollNodeRect = scrollNode.getBoundingClientRect();\n\n    this.refs.container.scrollTo(scrollNode.scrollTop + rect.top - scrollNodeRect.top)\n  };\n\n  scrollToLastHiddenBelow = () => {\n    const { lastUnreadBelow } = this.state;\n    const rect = lastUnreadBelow.getBoundingClientRect();\n    const scrollNode = findDOMNode(this.refs.container).getElementsByClassName('ss-scrollarea')[0];\n    const scrollNodeRect = scrollNode.getBoundingClientRect();\n\n    this.refs.container.scrollTo(scrollNode.scrollTop + rect.top - (scrollNodeRect.top + scrollNodeRect.height - rect.height));\n  };\n\n  render() {\n    const { dialogs } = this.props;\n    const { haveUnreadAbove, haveUnreadBelow } = this.state;\n    const { intl } = this.context;\n\n    const recentGroups = map(dialogs, (dialogGroup, index) => {\n      const isEmpty = dialogGroup.shorts.length === 0;\n      let groupTitle;\n\n      switch (dialogGroup.key) {\n        case 'groups':\n          groupTitle = (\n            <li className=\"sidebar__list__title\">\n              <a onClick={this.handleGroupListClick}>{intl.messages[`sidebar.recents.${dialogGroup.key}`]}</a>\n              <i className=\"material-icons sidebar__list__title__icon pull-right\"\n                 onClick={this.handleCreateGroup}>add_circle_outline</i>\n            </li>\n          );\n          break;\n        case 'privates':\n          groupTitle = (\n            <li className=\"sidebar__list__title\">\n              <a onClick={this.handlePrivateListClick}>{intl.messages[`sidebar.recents.${dialogGroup.key}`]}</a>\n              <i className=\"material-icons sidebar__list__title__icon pull-right\"\n                 onClick={this.handleCreatePrivate}>add_circle_outline</i>\n            </li>\n          );\n          break;\n        default:\n          groupTitle = <li className=\"sidebar__list__title\">{intl.messages[`sidebar.recents.${dialogGroup.key}`]}</li>;\n      }\n\n      const groupList = map(dialogGroup.shorts, (dialog, index) => <RecentItem dialog={dialog}\n                                                                               key={index}\n                                                                               type={dialogGroup.key}/>);\n\n      const groupClassname = classnames(`sidebar__list sidebar__list--${dialogGroup.key}`, {\n       'sidebar__list--empty': isEmpty\n      });\n\n      const getEmptyMessage = () => {\n        switch (dialogGroup.key) {\n          case 'groups':\n            return (\n              <li className=\"sidebar__list__item sidebar__list__item--empty\">\n                <FormattedMessage id=\"sidebar.group.empty\"/>\n                <div className=\"stem\"/>\n              </li>\n            )\n          case 'privates':\n            return (\n              <li className=\"sidebar__list__item sidebar__list__item--empty\">\n                <FormattedMessage id=\"sidebar.private.empty\"/>\n                <button className=\"button button--outline button--wide hide\">\n                  <FormattedMessage id=\"button.invite\"/>\n                </button>\n              </li>\n            )\n          default:\n            return null;\n        }\n      }\n\n      return (\n        <ul className={groupClassname} key={index}>\n          {groupTitle}\n          {\n            isEmpty\n              ? getEmptyMessage()\n              : groupList\n          }\n        </ul>\n      )\n    });\n\n    return (\n      <section className=\"sidebar__recent\">\n        {\n          haveUnreadAbove\n            ? <div className=\"sidebar__recent__unread sidebar__recent__unread--above\" onClick={this.scrollToFirstHiddenAbove}>\n                <i className=\"material-icons\">keyboard_arrow_up</i>\n              </div>\n            : null\n        }\n        <Scrollbar ref=\"container\" onScroll={this.handleRecentScroll}>\n          <div>\n            {recentGroups}\n\n            <footer>\n              <Link to=\"/im/archive\" className=\"button button--rised button--wide\">\n                <FormattedMessage id=\"button.archive\"/>\n              </Link>\n            </footer>\n          </div>\n        </Scrollbar>\n        {\n          haveUnreadBelow\n            ? <div className=\"sidebar__recent__unread sidebar__recent__unread--below\" onClick={this.scrollToLastHiddenBelow}>\n                <i className=\"material-icons\">keyboard_arrow_down</i>\n              </div>\n            : null\n        }\n      </section>\n    );\n  }\n}\n\nexport default Recent;\n"]}