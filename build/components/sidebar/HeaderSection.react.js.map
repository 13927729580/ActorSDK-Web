{"version":3,"sources":["../../../src/components/sidebar/HeaderSection.react.js"],"names":[],"mappings":"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","file":"HeaderSection.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport { Container } from 'flux/utils';\nimport classnames from 'classnames';\nimport ActorClient from '../../utils/ActorClient';\nimport { escapeWithEmoji } from '../../utils/EmojiUtils'\nimport confirm from '../../utils/confirm'\nimport SharedContainer from '../../utils/SharedContainer';\nimport { FormattedMessage } from 'react-intl';\n\nimport MyProfileActions from '../../actions/MyProfileActionCreators';\nimport CreateGroupActionCreators from '../../actions/CreateGroupActionCreators';\nimport LoginActionCreators from '../../actions/LoginActionCreators';\nimport HelpActionCreators from '../../actions/HelpActionCreators';\nimport AddContactActionCreators from '../../actions/AddContactActionCreators';\nimport PreferencesActionCreators from '../../actions/PreferencesActionCreators';\nimport BlockedUsersActionCreators from '../../actions/BlockedUsersActionCreators';\n\nimport MyProfileStore from '../../stores/MyProfileStore';\nimport CreateGroupStore from '../../stores/CreateGroupStore';\nimport AddContactStore from '../../stores/AddContactStore';\nimport PreferencesStore from '../../stores/PreferencesStore';\n\nimport SvgIcon from '../common/SvgIcon.react';\nimport AvatarItem from '../common/AvatarItem.react';\nimport CreateGroupModal from '../modals/CreateGroup';\nimport MyProfileModal from '../modals/MyProfile.react';\nimport AddContactModal from '../modals/AddContact.react';\nimport PreferencesModal from '../modals/Preferences.react';\n\nclass HeaderSection extends Component {\n  constructor(props) {\n    super(props);\n\n    this.openHelp = this.openHelp.bind(this);\n    this.openTwitter = this.openTwitter.bind(this);\n    this.openFacebook = this.openFacebook.bind(this);\n    this.openHomePage = this.openHomePage.bind(this);\n  }\n\n  static getStores() {\n    return [MyProfileStore, CreateGroupStore, AddContactStore, PreferencesStore];\n  }\n\n  static calculateState() {\n    return {\n      profile: MyProfileStore.getProfile(),\n      isMyProfileOpen: MyProfileStore.isModalOpen(),\n      isAddContactsOpen: AddContactStore.isOpen(),\n      isCreateGroupOpen: CreateGroupStore.isModalOpen(),\n      isPreferencesOpen: PreferencesStore.isOpen()\n    }\n  }\n\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  componentWillMount() {\n    this.setState({ isOpened: false });\n  }\n\n  toggleHeaderMenu = () => {\n    const { isOpened } = this.state;\n\n    if (!isOpened) {\n      this.setState({ isOpened: true });\n      document.addEventListener('click', this.closeHeaderMenu, false);\n    } else {\n      this.closeHeaderMenu();\n    }\n  };\n\n  closeHeaderMenu = () => {\n    this.setState({ isOpened: false });\n    document.removeEventListener('click', this.closeHeaderMenu, false);\n  };\n\n  openMyProfile = () => MyProfileActions.show();\n  openCreateGroup = () => CreateGroupActionCreators.open();\n  openBlockedUsers = () => BlockedUsersActionCreators.open();\n  openAddContactModal = () => AddContactActionCreators.open();\n  onSettingsOpen = () => PreferencesActionCreators.show();\n\n  openHelp() {\n    HelpActionCreators.open()\n  }\n\n  openTwitter(event) {\n    const { twitter } = SharedContainer.get();\n\n    event.preventDefault();\n    if (ActorClient.isElectron()) {\n      ActorClient.handleLinkClick(event);\n    } else {\n      window.open(`https://twitter.com/${twitter}`, '_blank');\n    }\n  }\n\n  openFacebook(event) {\n    const { facebook } = SharedContainer.get();\n\n    event.preventDefault();\n    if (ActorClient.isElectron()) {\n      ActorClient.handleLinkClick(event);\n    } else {\n      window.open(`https://facebook.com/${facebook}`, '_blank');\n    }\n  }\n\n  openHomePage(event) {\n    const { homePage } = SharedContainer.get();\n\n    event.preventDefault();\n    if (ActorClient.isElectron()) {\n      ActorClient.handleLinkClick(event);\n    } else {\n      window.open(homePage, '_blank');\n    }\n  }\n\n  setLogout = () => {\n    const { intl } = this.context;\n    confirm(intl.messages['modal.confirm.logout']).then(\n      () => LoginActionCreators.setLoggedOut(),\n      () => {}\n    );\n  };\n\n  renderTwitterLink() {\n    const { twitter } = SharedContainer.get();\n    if (!twitter) return null;\n\n    return (\n      <li className=\"dropdown__menu__item\">\n        <a href={`https://twitter.com/${twitter}`} onClick={this.openTwitter}>\n          <SvgIcon className=\"icon icon--dropdown sidebar__header__twitter\" glyph=\"twitter\" />\n          <FormattedMessage id=\"menu.twitter\"/>\n        </a>\n      </li>\n    );\n  }\n\n  renderFacebookLink() {\n    const { facebook } = SharedContainer.get();\n    if (!facebook) return null;\n\n    return (\n      <li className=\"dropdown__menu__item\">\n        <a href={`https://facebook.com/${facebook}`} onClick={this.openFacebook}>\n          <SvgIcon className=\"icon icon--dropdown sidebar__header__facebook\" glyph=\"facebook\" />\n          <FormattedMessage id=\"menu.facebook\"/>\n        </a>\n      </li>\n    );\n  }\n\n  renderHomeLink() {\n    const { homePage } = SharedContainer.get();\n    if (!homePage) return null;\n\n    return (\n      <li className=\"dropdown__menu__item\">\n        <a href={homePage} onClick={this.openHomePage}>\n          <i className=\"material-icons\">public</i>\n          <FormattedMessage id=\"menu.homePage\"/>\n        </a>\n      </li>\n    );\n  }\n\n  renderHelpLink() {\n    const { helpPhone } = SharedContainer.get();\n    if (!helpPhone) return null;\n\n    if (/@/.test(helpPhone)) {\n      return (\n        <li className=\"dropdown__menu__item\">\n          <a href={`mailto:${helpPhone}`}>\n            <i className=\"material-icons\">help</i>\n            <FormattedMessage id=\"menu.helpAndFeedback\"/>\n          </a>\n        </li>\n      );\n    } else {\n      return (\n        <li className=\"dropdown__menu__item\" onClick={this.openHelp}>\n          <i className=\"material-icons\">help</i>\n          <FormattedMessage id=\"menu.helpAndFeedback\"/>\n        </li>\n      );\n    }\n  }\n\n  render() {\n    const { profile, isOpened, isMyProfileOpen, isCreateGroupOpen, isAddContactsOpen, isPreferencesOpen } = this.state;\n\n    if (!profile) return null;\n\n    const headerClass = classnames('sidebar__header', 'sidebar__header--clickable', {\n      'sidebar__header--opened': isOpened\n    });\n    const menuClass = classnames('dropdown', {\n      'dropdown--opened': isOpened\n    });\n\n    return (\n      <header className={headerClass}>\n        <div className=\"sidebar__header__user row\" onClick={this.toggleHeaderMenu}>\n          <AvatarItem image={profile.avatar}\n                      placeholder={profile.placeholder}\n                      size=\"tiny\"\n                      title={profile.name} />\n          <span className=\"sidebar__header__user__name col-xs\"\n                dangerouslySetInnerHTML={{ __html: escapeWithEmoji(profile.name) }}/>\n          <div className={menuClass}>\n            <span className=\"dropdown__button\">\n              <i className=\"material-icons\">arrow_drop_down</i>\n            </span>\n            <ul className=\"dropdown__menu dropdown__menu--right\">\n              <li className=\"dropdown__menu__item\" onClick={this.openMyProfile}>\n                <i className=\"material-icons\">edit</i>\n                <FormattedMessage id=\"menu.editProfile\"/>\n              </li>\n              <li className=\"dropdown__menu__item\" onClick={this.openAddContactModal}>\n                <i className=\"material-icons\">person_add</i>\n                <FormattedMessage id=\"menu.addToContacts\"/>\n              </li>\n              <li className=\"dropdown__menu__item\" onClick={this.openCreateGroup}>\n                <i className=\"material-icons\">group_add</i>\n                <FormattedMessage id=\"menu.createGroup\"/>\n              </li>\n              <li className=\"dropdown__menu__item\" onClick={this.openBlockedUsers}>\n                <i className=\"material-icons\">block</i>\n                <FormattedMessage id=\"menu.blockedUsers\"/>\n              </li>\n              <li className=\"dropdown__menu__separator\"/>\n              <li className=\"dropdown__menu__item\" onClick={this.onSettingsOpen}>\n                <i className=\"material-icons\">settings</i>\n                <FormattedMessage id=\"menu.preferences\"/>\n              </li>\n\n              {this.renderHelpLink()}\n              {this.renderTwitterLink()}\n              {this.renderFacebookLink()}\n              {this.renderHomeLink()}\n\n              <li className=\"dropdown__menu__separator\"/>\n              <li className=\"dropdown__menu__item\" onClick={this.setLogout}>\n                <FormattedMessage id=\"menu.signOut\"/>\n              </li>\n            </ul>\n          </div>\n        </div>\n\n\n        {/* Modals */}\n        {/* TODO: Move all modals to other place */}\n        {isMyProfileOpen ? <MyProfileModal/> : null}\n        {isCreateGroupOpen ? <CreateGroupModal/> : null}\n        {isAddContactsOpen ? <AddContactModal/> : null}\n        {isPreferencesOpen ? <PreferencesModal/> : null}\n\n      </header>\n    );\n\n  }\n}\n\nexport default Container.create(HeaderSection);\n"]}