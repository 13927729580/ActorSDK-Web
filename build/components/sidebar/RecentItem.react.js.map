{"version":3,"sources":["../../../src/components/sidebar/RecentItem.react.js"],"names":[],"mappings":"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","file":"RecentItem.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport classnames from 'classnames';\nimport { escapeWithEmoji } from '../../utils/EmojiUtils';\nimport history from '../../utils/history';\n\nimport { AsyncActionStates } from '../../constants/ActorAppConstants';\n\nimport DropdownActionCreators from '../../actions/DropdownActionCreators';\n\nimport AvatarItem from '../common/AvatarItem.react';\nimport Stateful from '../common/Stateful.react';\n\nclass RecentItem extends Component {\n  static propTypes = {\n    isActive: PropTypes.bool.isRequired,\n    dialog: PropTypes.object.isRequired,\n    archiveState: PropTypes.number.isRequired,\n    onUpdate: PropTypes.func.isRequired\n  };\n\n  static defaultProps = {\n    isActive: false,\n    archiveState: AsyncActionStates.PENDING\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.handleClick = this.handleClick.bind(this);\n    this.handleOpenContextMenu = this.handleOpenContextMenu.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.onUpdate();\n  }\n\n  componentDidUpdate() {\n    this.props.onUpdate();\n  }\n\n  shouldComponentUpdate(nextProps) {\n    return nextProps.dialog !== this.props.dialog ||\n           nextProps.isActive !== this.props.isActive ||\n           nextProps.archiveState !== this.props.archiveState;\n  }\n\n  handleOpenContextMenu(event) {\n    event.preventDefault();\n    const { peer } = this.props.dialog.peer;\n    const contextPos = {\n      x: event.pageX || event.clientX,\n      y: event.pageY || event.clientY\n    };\n    DropdownActionCreators.openRecentContextMenu(contextPos, peer);\n  }\n\n  handleClick() {\n    const { dialog } = this.props;\n    history.push(`/im/${dialog.peer.peer.key}`);\n  }\n\n  renderCounter() {\n    const { dialog } = this.props;\n    if (dialog.counter === 0) {\n      return null;\n    }\n\n    return (\n      <span className=\"recent__item__counter\">{dialog.counter}</span>\n    );\n  }\n\n  renderArchiveState() {\n    const { archiveState } = this.props;\n    if (archiveState === AsyncActionStates.PENDING) {\n      return null;\n    }\n\n    return (\n      <Stateful\n        currentState={archiveState}\n        processing={\n            <div className=\"archive archive--in-progress\">\n              <i className=\"icon material-icons spin\">autorenew</i>\n            </div>\n          }\n        success={\n            <div className=\"archive archive--in-progress\">\n              <i className=\"icon material-icons\">check</i>\n            </div>\n          }\n        failure={\n            <div className=\"archive archive--failure\">\n              <i className=\"icon material-icons\">warning</i>\n            </div>\n          }\n      />\n    );\n  }\n\n  render() {\n    const { dialog, isActive } = this.props;\n    const title = escapeWithEmoji(dialog.peer.title);\n\n    const recentItemClassName = classnames('recent__item', {\n      'recent__item--active': isActive,\n      'recent__item--unread': dialog.counter !== 0\n    });\n\n    return (\n      <div onContextMenu={this.handleOpenContextMenu} onClick={this.handleClick} className={recentItemClassName}>\n        <AvatarItem\n          className=\"recent__item__avatar\"\n          size=\"tiny\"\n          image={dialog.peer.avatar}\n          placeholder={dialog.peer.placeholder}\n          title={dialog.peer.title}\n        />\n        <div className=\"recent__item__title col-xs\" dangerouslySetInnerHTML={{ __html: title }}/>\n        {this.renderCounter()}\n        {this.renderArchiveState()}\n      </div>\n    );\n  }\n}\n\nexport default RecentItem;\n"]}